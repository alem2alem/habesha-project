var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[17],[,,,function(e,t,n){"use strict";var i,o,a,r,s,c,d={reserve:function(){return 0},reserveTag:function(e){return e}};function u(e,t){return{visit:function(){}}}!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(i||(i={})),function(e){e[e.GlobalAPI=0]="GlobalAPI",e[e.ReviewedAsNotNecessary=1]="ReviewedAsNotNecessary",e[e.Test=2]="Test",e[e.Todo=3]="Todo"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess"}(a||(a={})),function(e){e[e.None=0]="None",e[e.BasicEvent=1]="BasicEvent",e[e.FullEvent=2]="FullEvent",e[e.NecessaryServiceDataEvent=3]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=4]="AlwaysOnNecessaryServiceDataEvent"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"}(s||(s={})),function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"}(c||(c={}));var l=n(55),m=d.reserveTag(590899029),f=d.reserveTag(590899030),p=d.reserveTag(590899031),h=d.reserveTag(590899032),C=d.reserveTag(590899033),g=n(0),v=function(e){function t(t,n,i){var o=e.call(this,t)||this;return o.errorCode=n,o.errorTag=i,o}return Object(g.__extends)(t,e),t}(Error);var y,b,T=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(e){var t=this;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=e,this.isInitialized=!0,this.deferredInitializationCallbacks.map((function(e){return e(t)})),this.deferredInitializationCallbacks=[])},e.prototype.onInitialized=function(e){this.isInitialized?e(this):this.deferredInitializationCallbacks.push(e)},e.prototype.createActivityObject=function(e,t,n,i,o){return void 0===i&&(i=r.FullEvent),void 0===o&&(o=!1),this.checkIsInitialized(),Object(l.i)(e[0]>="A"&&e[0]<="Z","Activity name should start with a capital letter."),this.hostAPI.createActivityObject(e,t,n,i,o)},e.prototype.assertCondition=function(e,t){this.checkIsInitialized(),this.assertConditionTag(e,t,p)},e.prototype.assertConditionTag=function(e,t,n){this.checkIsInitialized(),e||(Object(l.f)("*ASSERT* 0x"+n.toString(16)+" : "+t),this.hostAPI.logErrorData(n,t))},e.prototype.getMetadata=function(){return this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized)throw new v("ClientTelemetryAPI is not initialized",-2130957548)},e.prototype.logFloodgateActivity=function(e){this.checkIsInitialized(),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(e)},e}(),I=void 0;function S(e){return!0===e.testOnly}function O(e){if(I){if(S(I))return void(S(e)&&(I=e));if(y)throw new v(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",y].join("\n"),-2130957506);throw new v("ClientTelemetryAPI cannot be re-initialized.\nFirst intialized from "+b,-2130957506)}b||(b=Object(l.c)()),I=e}function D(){if(y||(y=Object(l.c)()),!I){var e=new T;return O(e),e}return I}var w,j,P,x,E,A,k,_=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),R=new _;function M(e,t,n){R.fireEvent({level:e,category:t,message:n})}function V(e,t){return{name:e,dataType:E.Boolean,value:t,classification:k.SystemMetadata}}function F(e,t){return{name:e,dataType:E.Int64,value:t,classification:k.SystemMetadata}}function L(e,t){return{name:e,dataType:E.String,value:t,classification:k.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(w||(w={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(j||(j={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(P||(P={})),function(e){var t={},n={},i={};function o(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");i=function e(t,n){if("object"!=typeof n)return n;for(var i=0,o=Object.keys(n);i<o.length;i++){var a=o[i];a in t&&(t[a],1)?t[a]=e(t[a],n[a]):t[a]=n[a]}return t}(i,e)}function a(e){if(t[e])return t[e];var n=s(e,P.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function r(e){if(n[e])return n[e];var t=s(e,P.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),o=i,a=void 0;if(o){for(var r=0;r<n.length-1;r++)o[n[r]]&&(o=o[n[r]],t===P.Aria&&"string"==typeof o.ariaTenantToken?a=o.ariaTenantToken:t===P.Nexus&&"number"==typeof o.nexusTenantToken&&(a=o.nexusTenantToken));return a}}e.setTenantToken=function(e,t,n){var i=e.split(".");if(i.length<2||"Office"!==i[0])M(w.Error,j.Core,(function(){return"Invalid namespace: "+e}));else{var a=Object.create(Object.prototype);t&&(a.ariaTenantToken=t),n&&(a.nexusTenantToken=n);var r,s=a;for(r=i.length-1;r>=0;--r){var c=Object.create(Object.prototype);c[i[r]]=s,s=c}o(s)}},e.setTenantTokens=o,e.getTenantTokens=function(e){var t=a(e),n=r(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=a,e.getNexusTenantToken=r,e.clear=function(){t={},n={},i={}}}(x||(x={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(E||(E={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function i(e){return void 0!==e&&n.test(e)}function o(e){if(!((t=e.name)&&i(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===E.Int64&&a(e.value)}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),i=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(o=i,void 0!==o&&t.test(o));var o}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!i(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)o(e.dataFields[n])},e.validateInt=a}(A||(A={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(k||(k={}));var N,U=function(){return(U=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B=function(){function e(e,t,n){var i,o;this.onSendEvent=new _,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=U(U({},e.getConfig()),this.config)):this.persistentDataFields.push(L("OTelJS.Version","3.1.49")),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void M(w.Warning,j.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void function(e,t,n){M(w.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}(j.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=x.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||A.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){x.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){x.setTenantTokens(e)},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new i(t,++n)},e.getNextChild=function(e){return new i(e.getString(),++e.nextChild)};var i=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=i}(N||(N={}));var z=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))},H=function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},W=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(W=function(){return 1e3*Math.floor(window.performance.now())});var G,q,Y,K,J,Q,Z,X,$,ee=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?N.getNextChild(n._cv):N.getNext(),this._dataFields=[],this._success=void 0,this._startTime=W()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&M(w.Warning,j.Core,(function(){return"Activity does not have success or result set"}));var e=W()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}M(w.Error,j.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return z(this,void 0,void 0,(function(){var t=this;return H(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return z(this,void 0,void 0,(function(){return H(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function te(e,t,n){e.push(L("zC."+t,n))}(G||(G={})).getFields=function(e,t){var n=[];return n.push(F(e+".Code",t.code)),void 0!==t.type&&n.push(L(e+".Type",t.type)),void 0!==t.tag&&n.push(F(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(V(e+".IsExpected",t.isExpected)),te(n,e,"Office.System.Result"),n},(Y=q||(q={})).contractName="Office.System.Activity",Y.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(L("Activity.CV",e.cV)),t.push(F("Activity.Duration",e.duration)),t.push(F("Activity.Count",e.count)),t.push(F("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(V("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,G.getFields("Activity.Result",e.result)),te(t,"Activity",Y.contractName),t},(K||(K={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(L(e+".Id",t.id)),void 0!==t.version&&n.push(L(e+".Version",t.version)),void 0!==t.sessionId&&n.push(L(e+".SessionId",t.sessionId)),te(n,e,"Office.System.Host"),n},(J||(J={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(L(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(L(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(L(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(L(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(L(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(V(e+".IsAnonymous",t.isAnonymous)),te(n,e,"Office.System.User"),n},(Q||(Q={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(L(e+".Id",t.id)),void 0!==t.version&&n.push(L(e+".Version",t.version)),void 0!==t.instanceId&&n.push(L(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(L(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(L(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(L(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(L(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(L(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(L(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(L(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(L(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(L(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(L(e+".Type",t.type)),te(n,e,"Office.System.SDX"),n},(Z||(Z={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(L(e+".Name",t.name)),void 0!==t.state&&n.push(L(e+".State",t.state)),te(n,e,"Office.System.Funnel"),n},(X||(X={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(F(e+".Id",t.id)),void 0!==t.name&&n.push(L(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(L(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(L(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(L(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(F(e+".TimeOffsetMs",t.timeOffsetMs)),te(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(L(e+".ErrorGroup",t.errorGroup)),n.push(F(e+".Tag",t.tag)),void 0!==t.code&&n.push(F(e+".Code",t.code)),void 0!==t.id&&n.push(F(e+".Id",t.id)),void 0!==t.count&&n.push(F(e+".Count",t.count)),te(n,e,"Office.System.Error"),n}}($||($={}));var ne,ie=q,oe=G,ae=$,re=Z,se=K,ce=Q,de=X,ue=J;!function(e){!function(e){!function(e){e.Activity=ie,e.Result=oe,e.Error=ae,e.Funnel=re,e.Host=se,e.SDX=ce,e.User=ue,e.UserAction=de}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(ne||(ne={}));var le,me,fe=(le=function(e,t){return(le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}le(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),pe=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))},he=function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fe(t,e),t.prototype.executeActivityAsync=function(e,t){return pe(this,void 0,void 0,(function(){return he(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return ee.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:ne.Office.System.Activity.contractName,dataFields:ne.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=ne.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(B),ge=function(){function e(){this.EMPTY_IMPL=!0}return e.prototype.success=function(){},e.prototype.successTag=function(e){},e.prototype.fail=function(e){},e.prototype.failTag=function(e,t){},e.prototype.addDataField=function(e,t,n){},e.prototype.addDocumentMetadata=function(e){},e.prototype.attachContext=function(e){},e.prototype.isEnded=function(){return!1},e}(),ve=function(){function e(e){this._visitor=e,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Object(l.d)("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(e){this.failTag(0,e)},e.prototype.isEnded=function(){return this._ended},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam",e[e.ShiftFactor=1e3]="ShiftFactor"}(me||(me={}));var ye=function(e){function t(t,n,i,o,a){var r=e.call(this,o)||this;return r.activityNamespace=t,r.activityName=n,r.fullActivityName=r.activityNamespace+"."+r.activityName,r.activityScope=i.createNewActivity(r.fullActivityName),r.hostTelemetrySupport=a,r}return Object(g.__extends)(t,e),t.prototype.successTag=function(e){this.finalize()&&(this.activityScope.setSuccess(!0),this.activityScope.setResult(0,void 0,e),this.activityScope.endNow(),this.hostTelemetrySupport.recordActivity&&this.hostTelemetrySupport.recordActivity(this.activityName))},t.prototype.failTag=function(e,t){this.finalize()&&(this.activityScope.setSuccess(!1),this.activityScope.setResult(t,void 0,e),void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,me.Error,this.fullActivityName+" Failed"),this.activityScope.endNow())},t.prototype.addDataField=function(e,t,n,o){if(!this.isEnded()&&n===i.SystemMetadata){var a,r,s,c=n||k.SystemMetadata;switch(typeof t){case"boolean":(a=V(e,t)).classification=c;break;case"number":(a=function(e,t){return{name:e,dataType:E.Double,value:t,classification:k.SystemMetadata}}(e,t)).classification=c;break;case"string":(a=L(e,t)).classification=c;break;default:throw new Error("Unknown type")}this.activityScope.addDataField(a),o&&(r=a,(s=this.hostTelemetrySupport).recordActivity&&s.recordActivity(r.name))}},t.prototype.attachContext=function(e){},t.prototype.addDocumentMetadata=function(e){},t}(ve);var be={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"};var Te=function(){function e(e,t){void 0===t&&(t=be),this.sdxMetadata=e,this.hostTelemetrySupport=t}return e.prototype.getMetadata=function(){var e=this.hostTelemetrySupport;return{appName:e.appName,appVersion:e.appVersion,dataCenter:e.dataCenter,releaseAudience:e.releaseAudience,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,ring:e.ring,sessionId:e.sessionId}},e}(),Ie=function(){function e(e){this.hostTelemetrySupport=e}return e.prototype.sendTelemetryEvent=function(e,t){if(void 0!==this.hostTelemetrySupport.sendOtelEvent){this.hostTelemetrySupport.sendOtelEvent({otelEvent:e});try{if(this.hostTelemetrySupport.recordPerfData&&e.eventContract&&e.dataFields){if("Activity.Duration"!==e.eventContract.dataFields[1].name)return;var n=+e.eventContract.dataFields[1].value;if(isNaN(n))return;var i=n/1e3;if("Office.Docs.SharedComments.RenderPaneIntoView"===e.eventName)this.hostTelemetrySupport.recordPerfData("RenderPaneIntoView",i);else if("Office.Docs.SharedComments.E2EPerfTracker"===e.eventName&&"OperationType"===e.dataFields[0].name)switch(e.dataFields[0].value){case"REPLY":this.hostTelemetrySupport.recordPerfData("SharedCommentsCommentReply",i);break;case"CREATE":this.hostTelemetrySupport.recordPerfData("SharedCommentsCreateThread",i);break;case"EDIT":this.hostTelemetrySupport.recordPerfData("SharedCommentsEditComment",i)}}}catch(e){return void(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(f,201,me.Error,"Error recording performance data: "+e.message))}}else void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(f,201,me.Error,"sendOtelEvent API undefined")},e}();function Se(e,t,n){e.persistentDataFields=function(e,t){var n=[];return n.push(L("SDX.Name",e.name)),n.push(L("SDX.Version",e.version)),n}(t),e.addSink(new Ie(n))}var Oe=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.sdxMetadata=t,i.namespaceString="Office.Docs.SharedComments",i.ariaTenantToken="c274b3e05ac5448dae8fbb7466da6acb-fd6dc8de-18b7-409c-a696-4bd66f7a5322-7902",i.disableUpload=l.a,i.telemetryLogger=new Ce,i.isFloodgateServiceEnabled=!1,i.initialize(),i}return Object(g.__extends)(t,e),t.prototype.initialize=function(){var e=this;void 0!==this.hostTelemetrySupport.disableUpload&&(this.disableUpload=this.hostTelemetrySupport.disableUpload),this.disableUpload||(R.addListener((function(t){void 0===e.hostTelemetrySupport.sendULSTrace||t.level!==w.Error&&t.level!==w.Warning||e.hostTelemetrySupport.sendULSTrace(m,201,me.Error,"OTel Notification - Level: "+t.level+", Category: "+t.category+", Message: "+t.message())})),this.telemetryLogger.setTenantToken(this.namespaceString,this.ariaTenantToken,-1),Se(this.telemetryLogger,this.sdxMetadata,this.hostTelemetrySupport))},t.prototype.createActivityObject=function(e,t,n){return this.disableUpload?new ge:function(e,t,n,i,o){return new ye(e,t,n,o,i)}(this.namespaceString,e,this.telemetryLogger,this.hostTelemetrySupport,(o=this,void 0===(i=t)?o:{visit:function(e){i.visit(e),o.visit(e)}}));var i,o},t.prototype.logErrorData=function(e,t){this.disableUpload||(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,me.Error,t),this.createActivityObject("LogError",(o.ReviewedAsNotNecessary,{visit:function(){}}),a.None).failTag(e,-2130957533))},t.prototype.logFloodgateActivity=function(e){!this.disableUpload&&window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&this.ensureFloodgateServiceEnabled().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine();if(t){var n=t.getActivityListener();n&&n.logActivity(e)}return Promise.resolve()})).catch((function(){}))},t.prototype.ensureFloodgateServiceEnabled=function(){var e=this;return this.isFloodgateServiceEnabled?Promise.resolve():window.OfficeBrowserFeedback.floodgate.initialize().then((function(){return window.OfficeBrowserFeedback.floodgate.start().then((function(){return e.isFloodgateServiceEnabled=!0,Promise.resolve()})).catch((function(e){return D().assertConditionTag(!1,"floodgate.start() failed: "+e.message,h),Promise.reject()}))})).catch((function(e){return D().assertConditionTag(!1,"floodgate.initialize() failed: "+e.message,C),Promise.reject()}))},t.prototype.visit=function(e){},t}(Te);function De(e,t){D().init(new Oe(e,t))}var we;!function(){function e(){this.testOnly=!0,this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}}}e.prototype.init=function(e){},e.prototype.onInitialized=function(e){},e.prototype.createActivityObject=function(e,t,n,i,o){return new ge},e.prototype.assertCondition=function(e,t){},e.prototype.assertConditionTag=function(e,t,n){}}();!function(e){e[e.None=0]="None",e[e.Errors=1]="Errors",e[e.Info=2]="Info",e[e.All=3]="All"}(we||(we={}));var je=function(e){function t(t,n,i){var o=e.call(this,i)||this;return o.name=t,o.loggingMask=n,o.EMPTY_IMPL=!0,o.dataFields={},o}return Object(g.__extends)(t,e),t.prototype.successTag=function(e){this.finalize()&&this.loggingMask&we.Info&&Object(l.e)({activityName:this.name,endTag:e,dataFields:this.dataFields})},t.prototype.failTag=function(e,t){this.finalize()&&this.loggingMask&we.Errors&&Object(l.d)({activityName:this.name,endTag:e,errorCode:t,dataFields:this.dataFields})},t.prototype.addDataField=function(e,t,n){this.dataFields[e]=[t,i[n]]},t.prototype.addDocumentMetadata=function(e){},t.prototype.attachContext=function(e){},t}(ve);!function(){function e(e,t){this.assertWhitelist=e,this.showAlert=t,this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}}}e.prototype.createActivityObject=function(t,n,i,o){return new je(t,e.loggingMask,n)},e.prototype.logErrorData=function(t,n){var i,o;e.loggingMask&we.Errors&&(Object(l.d)({details:n,tagID:t}),this.showAlert&&!this.assertWhitelist.has(t)&&(i=t,o=n,window.alert("Assert Tag 0x"+i.toString(16)+"\n"+o+"\n"+(new Error).stack)))},e.loggingMask=we.Errors}();var Pe,xe=function(){function e(){this.addDataField=jest.fn(),this.addDocumentMetadata=jest.fn(),this.attachContext=jest.fn(),this.isEnded=jest.fn(),this.fail=jest.fn(),this.success=jest.fn()}return e.prototype.successTag=function(e){this.success()},e.prototype.failTag=function(e,t){this.fail(t)},e}();!function(){function e(){this.testOnly=!0,this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}},this.reset(),e.currentInstance=this}e.prototype.reset=function(){this.init=jest.fn(),this.onInitialized=jest.fn(),this.createActivityObject=jest.fn((function(){return new xe})),this.assertCondition=jest.fn()},e.prototype.assertConditionTag=function(){this.assertCondition()},e.prototype.getCreatedActivities=function(){return this.createActivityObject.mock.results.map((function(e){return e.value}))}}();!function(e){e[e.Stub=0]="Stub",e[e.Fake=1]="Fake"}(Pe||(Pe={})),n.d(t,"i",(function(){return D})),n.d(t,"k",(function(){return De})),n.d(t,"f",(function(){return 0})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return u})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c}))},,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.AddContentExtensionType="ADD_CONTENT_EXTENSION",e.AddToCurrentMentioneesType="ADD_TO_CURRENT_MENTIONEES",e.ApplyCommentChangesType="APPLY_COMMENT_CHANGES",e.BeginDraftingFailureType="BEGIN_DRAFTING_FAILURE",e.BeginDraftingSuccessType="BEGIN_DRAFTING_SUCCESS",e.BeginProcessingCommitType="BEGIN_PROCESSING_COMMIT",e.BeginProcessingDiscardType="BEGIN_PROCESSING_DISCARD",e.BeginViewInitialization="BEGIN_VIEW_INIT",e.CallDeleteCommentType="CALL_DELETE_COMMENT",e.CancelCommentCreateThreadType="CANCEL_COMMENT_CREATE_THREAD",e.CancelCommentPostEditType="CANCEL_COMMENT_POST_EDIT",e.CancelCommentReplyType="CANCEL_COMMENT_REPLY",e.CancelDiscardType="CANCEL_DISCARD",e.ClearCommentHighlightType="CLEAR_COMMENT_HIGHLIGHT",e.ClearCommentSelectionType="CLEAR_COMMENT_SELECTION",e.ClearCommentsType="CLEAR_COMMENTS",e.ClearPostErrorUIType="CLEAR_POST_ERROR_STATE",e.CommentContextChangedType="COMMENT_CONTEXT_CHANGED",e.CommitDraftType="COMMIT_DRAFT",e.CommitFailureType="COMMIT_FAILURE",e.ContextDetailsUpdatedType="CONTEXT_DETAILS_UPDATED",e.DeleteCommentsType="DELETE_COMMENTS",e.DispatchLoadThreadsType="DISPATCH_LOAD_THREADS",e.DisplayDraftWarningType="DISPLAY_DRAFT_WARNING",e.DraftEmptinessChangedType="DRAFT_EMPTINESS_CHANGED",e.EmptyActionType="",e.EndViewInitialization="END_VIEW_INIT",e.EndCommentSessionType="END_COMMENT_SESSION",e.EnterEditCommentModeOnClickType="ENTER_EDIT_COMMENT_MODE_ON_CLICK",e.HighlightCommentType="HIGHLIGHT_COMMENT",e.SessionRequestStartedAndLockFocusType="SESSION_REQUEST_STARTED",e.InsertCommentType="INSERT_COMMENT",e.LoadCommentType="LOAD_COMMENT",e.LoadPersonaIconPropertiesType="LOAD_PERSONA_ICON_PROPERTIES",e.MoveFocusToCanvasType="MOVE_FOCUS_TO_CANVAS",e.NextPopulatedContextDetailsUpdatedType="NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",e.OnInitialRenderType="ON_INITIAL_RENDER",e.UpdateMentioneesStillInDraftType="UPDATE_MENTIONEES_STILL_IN_DRAFT",e.QueueLoadThreadsType="QUEUE_LOAD_THREADS",e.ReadyToRenderType="READY_TO_RENDER",e.ReloadCommentsType="RELOAD_COMMENTS",e.RemoveContentExtensionType="REMOVE_CONTENT_EXTENSION",e.RequestClosePaneType="REQUEST_CLOSE_PANE",e.RequestDeletePostType="REQUEST_DELETE_POST",e.RequestDeleteThreadType="REQUEST_DELETE_THREAD",e.RequestDisplayConfigurationType="REQUEST_DISPLAY_CONFIG",e.RequestModalConfirmationType="REQUEST_MODAL_CONFIRMATION",e.RequestReopenThreadType="REQUEST_REOPEN_THREAD",e.RequestShowPaneType="REQUEST_SHOW_PANE",e.RequestThreadResolveType="REQUEST_THREAD_RESOLVE",e.ResolveAtMentionCapabilityType="RESOLVE_ATMENTION_CAPABILITY",e.SaveDraftType="SAVE_DRAFT",e.SelectCommentType="SELECT_COMMENT",e.SelectContentType="SELECT_CONTENT",e.SelectFirstThreadInNextCommentContextType="SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",e.SelectLastThreadInPreviousCommentContextType="SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",e.ShowLowFidelityWarningType="SHOW_LOW_FIDELITY_WARNING",e.ShowPostErrorUIType="SHOW_POST_ERROR_STATE",e.TopVisibleThreadChangedType="TOP_VISIBLE_THREAD_CHANGED",e.UpdateAtMentionAuthTokenType="UPDATE_ATMENTION_AUTH_TOKEN",e.UpdateCapabilitiesType="UPDATE_CAPABILITIES",e.UpdateModelCapabilitiesType="UPDATE_MODEL_STATE",e.UpdateCommentType="UPDATE_COMMENT",e.UpdateContextStateType="UPDATE_CONTEXT_DETAILS",e.UpdateDraftRenderContextType="UPDATE_DRAFT_RENDER_CONTEXT",e.UpdateDraftThreadType="UPDATE_DRAFT_THREAD",e.UpdateFocusTypeAfterContextChangeType="UPDATE_FOCUS_TYPE_AFTER_CONTEXT_CHANGE",e.UpdateCurrentMentioneesType="UPDATE_CURRENT_MENTIONEES",e.ViewContainerChangedType="VIEW_CONTAINER_CHANGED",e.ViewContainerFoldableLayoutStateChangedType="VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",e.ViewContainerVisibilityChangedType="VIEW_CONTAINER_VISIBILITY_CHANGED",e.ViewContainerVisibilityChangedType_deprecated="VIEW_CONTAINER_VISIBILITY_CHANGED_DEPRECATED",e.LoadVirtualizedCommentsType="VIRTUALIZE_COMMENTS",e.UpdateSelectedTaskAssigneeType="UPDATE_SELECTED_TASK_ASSIGNEE",e.UpdateExtensionPriorityType="UPDATE_EXTENSION_PRIORITY",e.UpdateSuggestionsDetailsType="UPDATE_SUGGESTIONS_DETAILS"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"C",(function(){return a})),n.d(t,"S",(function(){return r})),n.d(t,"J",(function(){return s})),n.d(t,"t",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"tb",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"P",(function(){return m})),n.d(t,"K",(function(){return f})),n.d(t,"p",(function(){return p})),n.d(t,"jb",(function(){return h})),n.d(t,"c",(function(){return C})),n.d(t,"M",(function(){return g})),n.d(t,"A",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"d",(function(){return b})),n.d(t,"xb",(function(){return T})),n.d(t,"g",(function(){return I})),n.d(t,"N",(function(){return S})),n.d(t,"v",(function(){return O})),n.d(t,"bb",(function(){return D})),n.d(t,"F",(function(){return w})),n.d(t,"y",(function(){return j})),n.d(t,"a",(function(){return P})),n.d(t,"ib",(function(){return x})),n.d(t,"x",(function(){return E})),n.d(t,"Y",(function(){return A})),n.d(t,"Q",(function(){return k})),n.d(t,"W",(function(){return _})),n.d(t,"I",(function(){return R})),n.d(t,"u",(function(){return M})),n.d(t,"z",(function(){return V})),n.d(t,"w",(function(){return F})),n.d(t,"fb",(function(){return L})),n.d(t,"q",(function(){return N})),n.d(t,"ab",(function(){return U})),n.d(t,"L",(function(){return B})),n.d(t,"m",(function(){return z})),n.d(t,"r",(function(){return H})),n.d(t,"cb",(function(){return W})),n.d(t,"V",(function(){return G})),n.d(t,"mb",(function(){return q})),n.d(t,"kb",(function(){return Y})),n.d(t,"H",(function(){return K})),n.d(t,"db",(function(){return J})),n.d(t,"qb",(function(){return Q})),n.d(t,"Z",(function(){return Z})),n.d(t,"X",(function(){return X})),n.d(t,"l",(function(){return $})),n.d(t,"e",(function(){return ee})),n.d(t,"B",(function(){return te})),n.d(t,"O",(function(){return ne})),n.d(t,"D",(function(){return ie})),n.d(t,"vb",(function(){return oe})),n.d(t,"s",(function(){return ae})),n.d(t,"nb",(function(){return re})),n.d(t,"wb",(function(){return se})),n.d(t,"U",(function(){return ce})),n.d(t,"G",(function(){return de})),n.d(t,"E",(function(){return ue})),n.d(t,"eb",(function(){return le})),n.d(t,"ub",(function(){return me})),n.d(t,"rb",(function(){return fe})),n.d(t,"lb",(function(){return pe})),n.d(t,"ob",(function(){return he})),n.d(t,"j",(function(){return Ce})),n.d(t,"hb",(function(){return ge})),n.d(t,"n",(function(){return ve})),n.d(t,"R",(function(){return ye})),n.d(t,"h",(function(){return be})),n.d(t,"sb",(function(){return Te})),n.d(t,"pb",(function(){return Ie})),n.d(t,"k",(function(){return Se})),n.d(t,"i",(function(){return Oe})),n.d(t,"gb",(function(){return De})),n.d(t,"T",(function(){return we}));var i=n(29),o=n(26);function a(){return Object(o.a)().isFeatureEnabled("LivePersonaPicker")}function r(){return Object(o.a)().isFeatureEnabled("PersonaFeature")}function s(){return Object(o.a)().isFeatureEnabled("NewCommentButton")}function c(){return f()&&Object(o.a)().isFeatureEnabled("DiscreteHostedComments")}function d(){return Object(o.a)().isFeatureEnabled("CommentsFluentUI")}function u(){return Object(o.a)().isFeatureEnabled("RenderDHCInPane")}function l(){return d()&&Object(o.a)().isFeatureEnabled("CommentTasks")}function m(){return Object(o.a)().isFeatureEnabled("NoDiscardOnFocusLoss")}function f(){return Object(o.a)().isFeatureEnabled("NewDraftingUI")}function p(){return d()&&Object(o.a)().isFeatureEnabled("CommentsFluentUIV2")}function h(){return Object(o.a)().isFeatureEnabled("TaskPaneWithNewInfrastructure")}function C(){return l()&&Object(o.a)().isFeatureEnabled("CommentTasksFromReply")}function g(){return Object(o.a)().isFeatureEnabled("NewModelState")}function v(){return Object(o.a)().isFeatureEnabled("HeadlessBoot")}function y(){return c()&&Object(o.a)().isFeatureEnabled("NativeDiscreteHostedComments")}function b(){return Object(o.a)().isFeatureEnabled("HyperlinksInComments")}function T(){return f()&&Object(o.a)().isFeatureEnabled("ContentNavigation")}function I(){return Object(o.a)().isFeatureEnabled("AtMentionFloodgateSurvey")}function S(){return l()&&Object(o.a)().isFeatureEnabled("NewTaskAssigneePayload")}function O(){return f()&&Object(o.a)().isFeatureEnabled("ExtendedDrafting")}function D(){return Object(o.a)().isFeatureEnabled("RichTextFormattingInWeb")}function w(){return Object(o.a)().isFeatureEnabled("LogDraftCommentIdPair")}function j(){return Object(o.a)().isChangeGateEnabled("FixOrderingOfOnTextChangedHandler",Object(i.c)(3912444))}function P(){return Object(o.a)().isChangeGateEnabled("CommentCardTaskA11yLabels",Object(i.c)(3875797))}function x(){return Object(o.a)().isChangeGateEnabled("TaskAssignerLabelFix",Object(i.c)(3969344))}function E(){return Object(o.a)().isChangeGateEnabled("FixDeleteThreadIssues",Object(i.c)(3997859))}function A(){return Object(o.a)().isChangeGateEnabled("RemoveDraftNonNullCheck",Object(i.c)(3998261))}function k(){return Object(o.a)().isChangeGateEnabled("NonMemoizedGetCreatedCommentLie",Object(i.c)(4070087))}function _(){return Object(o.a)().isChangeGateEnabled("PureComponentsRefactor2",Object(i.c)(4075287))}function R(){return Object(o.a)().isChangeGateEnabled("NativeDHCThemeFix",Object(i.c)(4067789))}function M(){return Object(o.a)().isChangeGateEnabled("DraftArrowingBehavior",Object(i.c)(4204218))}function V(){return Object(o.a)().isChangeGateEnabled("FixTabletDeleteThreadLowFiWarning",Object(i.c)(4083615))}function F(){return Object(o.a)().isChangeGateEnabled("FixDHCDraftStateHelperIsEmptyCheck",Object(i.c)(4086986))}function L(){return Object(o.a)().isChangeGateEnabled("TaskA11yFixes",Object(i.c)(4203892))}function N(){return Object(o.a)().isChangeGateEnabled("CommitBarRefactor",Object(i.c)(3761011))}function U(){return Object(o.a)().isChangeGateEnabled("ReturnToDraftAfterDiscardCancel",Object(i.c)(4169018))}function B(){return Object(o.a)().isChangeGateEnabled("NewInterruptableCommands",Object(i.c)(4099011))}function z(){return Object(o.a)().isChangeGateEnabled("CardOnSelectExpandCallbackConvergence",Object(i.c)(4098644))}function H(){return Object(o.a)().isChangeGateEnabled("ContainerStateHelpersConvergence2",Object(i.c)(4109906))}function W(){return Object(o.a)().isChangeGateEnabled("SaveDraftOnCommentEditorUnmount",Object(i.c)(4111736))}function G(){return Object(o.a)().isChangeGateEnabled("PureCardSelection",Object(i.c)(4140949))}function q(){return Object(o.a)().isChangeGateEnabled("UseSetContextMenuProps",Object(i.c)(4122481))}function Y(){return Object(o.a)().isChangeGateEnabled("TasksGlobalizationFixes",Object(i.c)(4129551))}function K(){return Object(o.a)().isChangeGateEnabled("NativeDHCFlickerOnCommitFix",Object(i.c)(4128140))}function J(){return Object(o.a)().isChangeGateEnabled("SuggestionsDetails2",Object(i.c)(4229235))}function Q(){return Object(o.a)().isChangeGateEnabled("EnsureContainerForReturnToDraft",Object(i.c)(4130796))}function Z(){return B()&&Object(o.a)().isChangeGateEnabled("RemoveUnnecessaryThunk",Object(i.c)(4158721))}function X(){return Object(o.a)().isChangeGateEnabled("ReAddPaneCloseValidation",Object(i.c)(4141175))}function $(){return Object(o.a)().isChangeGateEnabled("CardAnnotation",4163027)}function ee(){return Object(o.a)().isChangeGateEnabled("IsolatedContentStateEnabledForcePrimary",Object(i.c)(4140703))}function te(){return Object(o.a)().isChangeGateEnabled("HoverRegressionFix",Object(i.c)(4149124))}function ne(){return Object(o.a)().isChangeGateEnabled("NewViewContainerVisibilityState",Object(i.c)(4155488))}function ie(){return Object(o.a)().isChangeGateEnabled("ListItemsNeedKeyPropFix",Object(i.c)(4161492))}function oe(){return Object(o.a)().isChangeGateEnabled("DeleteDiscardIsolatedUpdates",Object(i.c)(4152858))}function ae(){return Object(o.a)().isChangeGateEnabled("DisableIsDraftEmptyForWeb",Object(i.c)(4159197))}function re(){return Object(o.a)().isChangeGateEnabled("VirtualizeCommentThreads",Object(i.c)(4168678))}function se(){return Object(o.a)().isChangeGateEnabled("UseDraftRenderContextOnEmptyCheck",Object(i.c)(4168785))}function ce(){return Object(o.a)().isChangeGateEnabled("PreserveCardAlternateIdOnCommentReply",Object(i.c)(4170847))}function de(){return Object(o.a)().isChangeGateEnabled("LogOnSilentDiscard",Object(i.c)(4187586))}function ue(){return Object(o.a)().isChangeGateEnabled("LogDraftCardMountOnFirstLayout",Object(i.c)(4245144))}function le(){return Object(o.a)().isChangeGateEnabled("SurfaceDuoRendering",Object(i.c)(4192760))}function me(){return Object(o.a)().isChangeGateEnabled("FixBackwardsEmptyCheck",Object(i.c)(4177775))&&Object(o.a)().isChangeGateEnabled("IsDraftEmptyInStore",Object(i.c)(4176750))}function fe(){return Object(o.a)().isChangeGateEnabled("FixSaveDraftAssertV2",Object(i.c)(4193126))}function pe(){return Object(o.a)().isChangeGateEnabled("UseAriaPlaceholder",Object(i.c)(4178140))}function he(){return me()&&Object(o.a)().isChangeGateEnabled("DiscardEmptyDraftOnMoreActions",Object(i.c)(4202781))}function Ce(){return Object(o.a)().isChangeGateEnabled("BringContentIntoView",Object(i.c)(4214916))}function ge(){return Object(o.a)().isChangeGateEnabled("TaskAssignerKeyboardFocusFix",Object(i.c)(4205552))}function ve(){return Object(o.a)().isChangeGateEnabled("RebrandingColorFix",Object(i.c)(4209017))}function ye(){return Object(o.a)().isChangeGateEnabled("PersonaFlickerOnKeyboardingNativeDHCFix",Object(i.c)(4232387))}function be(){return Object(o.a)().isChangeGateEnabled("BlueDotTelemetry",Object(i.c)(4219868))}function Te(){return Object(o.a)().isChangeGateEnabled("PreserveSelectionThunkFix",Object(i.c)(4244021))}function Ie(){return me()&&Object(o.a)().isChangeGateEnabled("DiscardOnEmptyForGhost",Object(i.c)(4249169))}function Se(){return Object(o.a)().isChangeGateEnabled("CancelDraftFocusFix",Object(i.c)(4249599))}function Oe(){return Object(o.a)().isChangeGateEnabled("BlurHandlerFix",Object(i.c)(4253990))}function De(){return Object(o.a)().isChangeGateEnabled("TaskAssignerAdjustmentFix",Object(i.c)(4234604))}function we(){return Object(o.a)().isChangeGateEnabled("PlaceHolderHCFix",Object(i.c)(4260210))}},,function(e,t,n){"use strict";n.d(t,"m",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"t",(function(){return l})),n.d(t,"p",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"q",(function(){return C})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"o",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return I})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return O})),n.d(t,"h",(function(){return D})),n.d(t,"r",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"v",(function(){return P})),n.d(t,"z",(function(){return A})),n.d(t,"y",(function(){return _})),n.d(t,"u",(function(){return R})),n.d(t,"n",(function(){return M})),n.d(t,"w",(function(){return V})),n.d(t,"s",(function(){return F}));var i=n(74),o=n(16),a=n(339),r=n(67),s=n(8),c=n(19),d=function(e){return e.commentState.contextState.isReadOnly},u=function(e){return e.commentState.atMentionState},l=function(e){return e.commentState.topVisibleThreadId},m=function(e){return e.commentState.personaIconPropertiesMap},f=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},h=function(e){return e.commentState.commentData},C=function(e){return e.commentState.postViewState},g=function(e){return e.commentState.draftState},v=function(e){return e.commentState.focusedComment},y=function(e){return e.commentState.pendingCommentLoad},b=function(e){return e.commentState.focusedThreadIdBeforeCommentSession},T=function(e){return e.commentState.capabilities},I=function(e){return e.commentState.authToken},S=function(e){return e.commentState.contextState},O=function(e){return e.commentState.createdCommentLie},D=function(e){var t=e.commentState.createdCommentLie,n=g(e);return!t||n.drafts[t.draftId]&&!n.drafts[t.draftId].isInCurrentContext?void 0:t},w=function(e){var t=v(e),n=g(e);if(void 0!==t){var i=t.selectedCardId,o=n.cardIdToDraftIdMap[i];return n.drafts[o]}},j=function(){return Object(i.a)([v,h],(function(e,t){return e?{focusedComment:e,index:Object(c.s)(t,e)}:void 0}))},P=function(){return Object(i.a)([O,g],(function(e,t){return!e||t.drafts[e.draftId]&&!t.drafts[e.draftId].isInCurrentContext?void 0:e}))},x={},E=function(e){return s.b()?e.taskState.tasks:x},A=function(){return Object(i.a)([h,E],r.l)},k=function(e,t){return t},_=function(e){return Object(i.a)([g,O,f,C,e,k],(function(e,t,n,i,s,c){return r.b(s,n,i,t,c.renderContextType!==o.a.HalfPane,Object(a.b)(e,c.renderContextType))}))},R=function(e){return e.commentState.virtualized},M=function(e){return e.commentState.modelCapabilities},V=function(){return Object(i.a)(g,(function(e){var t;return null===(t=Object(c.B)(e))||void 0===t?void 0:t.renderContextType}))},F=function(e){return e.commentState.suggestionsDetails}},,function(e,t,n){"use strict";var i;function o(e){return e===i.LowFidelityWarningOnDelete||e===i.LowFidelityWarningOnDeleteThread||e===i.LowFidelityWarningOnEdit}function a(e){return void 0!==e.expanded}function r(e){return void 0!==e.selectedPostId}function s(e){return e.editingSession===i.Active||e.editingSession===i.SessionRequestPending||e.editingSession===i.CommitPending||e.editingSession===i.DiscardPending}function c(e){return!(!e||e.focusDetails.editingSession!==i.CommitPending)}function d(e){return!(!e||e.focusDetails.editingSession!==i.CommitPending&&e.focusDetails.editingSession!==i.Active&&e.focusDetails.editingSession!==i.DiscardPending)}function u(e){return a(e.focusDetails)?e.selectedCardId:e.focusDetails.selectedPostId}function l(e,t){return!!t&&!a(t.focusDetails)&&t.focusDetails.selectedPostId===e.commentId&&o(t.focusDetails.editingSession)}function m(e,t){return!(!e||!t)&&(e.focusDetails.editingSession===i.DiscardPending&&t.focusDetails.editingSession===i.Active)}n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return m})),function(e){e[e.None=0]="None",e[e.SessionRequestPending=1]="SessionRequestPending",e[e.Active=2]="Active",e[e.LowFidelityWarningOnEdit=3]="LowFidelityWarningOnEdit",e[e.LowFidelityWarningOnDelete=4]="LowFidelityWarningOnDelete",e[e.LowFidelityWarningOnDeleteThread=5]="LowFidelityWarningOnDeleteThread",e[e.CommitPending=6]="CommitPending",e[e.DiscardPending=7]="DiscardPending"}(i||(i={}))},,function(e,t,n){"use strict";var i=n(15),o=n(7);n(472);function a(e,t){return Object(i.b)(o.a.AddToCurrentMentioneesType,{mentionee:t},e)}function r(e,t){return Object(i.b)(o.a.ApplyCommentChangesType,{changes:t},e)}var s=n(320);n(407),n(473),n(474),n(475);function c(e,t){return Object(i.b)(o.a.CancelCommentCreateThreadType,{closeOnDiscard:t},e)}function d(e,t,n){return Object(i.b)(o.a.CancelCommentPostEditType,{commentId:t,closeOnDiscard:n},e)}function u(e,t,n){return Object(i.b)(o.a.CancelCommentReplyType,{commentId:t,closeOnDiscard:n},e)}n(476);var l=n(477);function m(e){return Object(i.b)(o.a.ClearCommentsType,{},e)}var f=n(478);function p(e,t){return Object(i.b)(o.a.ClearPostErrorUIType,{commentId:t},e)}function h(e,t){return Object(i.b)(o.a.CommentContextChangedType,t,e)}var C=n(479);n(260);function g(e,t){return Object(i.b)(o.a.DispatchLoadThreadsType,t,e)}var v=n(256);function y(e,t,n){return Object(i.b)(o.a.DraftEmptinessChangedType,{isEmpty:t,draftId:n},e)}var b=n(270),T=(n(408),n(480));n(481),n(409),n(482);function I(e,t){return Object(i.b)(o.a.MoveFocusToCanvasType,{resource:t},e)}function S(e,t){return Object(i.b)(o.a.NextPopulatedContextDetailsUpdatedType,{nextPopulatedContextDetails:t},e)}function O(e,t){return Object(i.b)(o.a.OnInitialRenderType,t,e)}function D(e,t){return Object(i.b)(o.a.UpdateMentioneesStillInDraftType,{emailsStillInDraft:t},e)}function w(e,t){return Object(i.b)(o.a.QueueLoadThreadsType,t,e)}function j(e){return Object(i.b)(o.a.ReadyToRenderType,{},e)}var P=n(483);function x(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(i.b)(o.a.RemoveContentExtensionType,{renderModes:t},e)}function E(e){return Object(i.b)(o.a.RequestClosePaneType,{},e)}function A(e,t){return Object(i.b)(o.a.RequestDeletePostType,{commentId:t},e)}function k(e,t,n){return Object(i.b)(o.a.RequestDeleteThreadType,{commentId:t,isTask:n},e)}n(484);function _(e,t,n,a){return Object(i.b)(o.a.RequestModalConfirmationType,{onConfirm:t,onCancel:n,displayStrings:a},e)}function R(e,t,n){return Object(i.b)(o.a.RequestReopenThreadType,{commentId:t,isTask:n},e)}function M(e){return Object(i.b)(o.a.RequestShowPaneType,{},e)}function V(e,t,n){return Object(i.b)(o.a.RequestThreadResolveType,{commentId:t,isTask:n},e)}n(325);function F(e,t){return Object(i.b)(o.a.SaveDraftType,t,e)}var L=n(97);function N(e,t,n,a){return Object(i.b)(o.a.SelectContentType,{selectDirection:t,from:n,source:a},e)}function U(e){return Object(i.b)(o.a.SelectFirstThreadInNextCommentContextType,{},e)}function B(e){return Object(i.b)(o.a.SelectLastThreadInPreviousCommentContextType,{},e)}n(485);var z=n(486);function H(e,t){return Object(i.b)(o.a.ShowPostErrorUIType,{commentId:t},e)}n(487),n(488);function W(e,t){return Object(i.b)(o.a.UpdateCapabilitiesType,{capabilities:t},e)}n(489);function G(e,t){return Object(i.b)(o.a.UpdateCurrentMentioneesType,{users:t},e)}function q(e,t,n){return Object(i.b)(o.a.UpdateDraftRenderContextType,{isClaimingLock:t,draftId:n},e)}function Y(e,t){return Object(i.b)(o.a.UpdateDraftThreadType,t,e)}function K(e,t){return Object(i.b)(o.a.UpdateExtensionPriorityType,{updates:t},e)}function J(e,t){return Object(i.b)(o.a.UpdateFocusTypeAfterContextChangeType,{focusTypeAfterContextChange:t},e)}function Q(e,t){return Object(i.b)(o.a.UpdateModelCapabilitiesType,{modelCapabilityFlags:t},e)}function Z(e,t){return Object(i.b)(o.a.UpdateSelectedTaskAssigneeType,{selectedAssignee:t},e)}var X=n(490);function $(e,t){return Object(i.b)(o.a.ViewContainerChangedType,{viewContainer:t},e)}function ee(e,t){return Object(i.b)(o.a.ViewContainerFoldableLayoutStateChangedType,{foldableLayoutState:t},e)}function te(e,t){return Object(i.b)(o.a.ViewContainerVisibilityChangedType,{visibilityState:t},e)}function ne(e,t){return Object(i.b)(o.a.ViewContainerVisibilityChangedType_deprecated,{visible:t},e)}n.d(t,"j",(function(){return i.a})),n.d(t,"a",(function(){return o.a})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return s.a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"k",(function(){return l.a})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return f.a})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return C.a})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return v.a})),n.d(t,"s",(function(){return y})),n.d(t,"b",(function(){return b.a})),n.d(t,"t",(function(){return T.a})),n.d(t,"u",(function(){return I})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return O})),n.d(t,"V",(function(){return D})),n.d(t,"x",(function(){return w})),n.d(t,"y",(function(){return j})),n.d(t,"z",(function(){return P.a})),n.d(t,"A",(function(){return x})),n.d(t,"B",(function(){return E})),n.d(t,"C",(function(){return A})),n.d(t,"D",(function(){return k})),n.d(t,"E",(function(){return _})),n.d(t,"F",(function(){return R})),n.d(t,"G",(function(){return M})),n.d(t,"H",(function(){return V})),n.d(t,"I",(function(){return F})),n.d(t,"c",(function(){return L.a})),n.d(t,"J",(function(){return L.b})),n.d(t,"K",(function(){return N})),n.d(t,"L",(function(){return U})),n.d(t,"M",(function(){return B})),n.d(t,"N",(function(){return z.a})),n.d(t,"O",(function(){return H})),n.d(t,"P",(function(){return W})),n.d(t,"Q",(function(){return G})),n.d(t,"R",(function(){return q})),n.d(t,"S",(function(){return Y})),n.d(t,"T",(function(){return K})),n.d(t,"U",(function(){return J})),n.d(t,"W",(function(){return Q})),n.d(t,"X",(function(){return Z})),n.d(t,"Y",(function(){return X.a})),n.d(t,"Z",(function(){return $})),n.d(t,"ab",(function(){return ee})),n.d(t,"bb",(function(){return te})),n.d(t,"cb",(function(){return ne}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n(0);function o(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{trackback:t})}function a(e,t,n){return{type:e,payload:t,actionDetail:n}}},function(e,t,n){"use strict";var i;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.ModalDraft=3]="ModalDraft",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(i||(i={})),t.a=i},,,function(e,t,n){"use strict";n.d(t,"G",(function(){return E})),n.d(t,"F",(function(){return A})),n.d(t,"z",(function(){return k})),n.d(t,"y",(function(){return _})),n.d(t,"g",(function(){return R})),n.d(t,"J",(function(){return M})),n.d(t,"f",(function(){return V})),n.d(t,"C",(function(){return F})),n.d(t,"u",(function(){return L})),n.d(t,"w",(function(){return N})),n.d(t,"v",(function(){return U})),n.d(t,"I",(function(){return B})),n.d(t,"k",(function(){return z})),n.d(t,"m",(function(){return H})),n.d(t,"q",(function(){return W})),n.d(t,"l",(function(){return G})),n.d(t,"n",(function(){return q})),n.d(t,"r",(function(){return Y})),n.d(t,"O",(function(){return K})),n.d(t,"t",(function(){return J})),n.d(t,"P",(function(){return Q})),n.d(t,"h",(function(){return Z})),n.d(t,"i",(function(){return X})),n.d(t,"E",(function(){return $})),n.d(t,"o",(function(){return ee})),n.d(t,"a",(function(){return te})),n.d(t,"p",(function(){return ne})),n.d(t,"L",(function(){return ae})),n.d(t,"S",(function(){return re})),n.d(t,"Q",(function(){return se})),n.d(t,"R",(function(){return ce})),n.d(t,"A",(function(){return de})),n.d(t,"B",(function(){return ue})),n.d(t,"s",(function(){return le})),n.d(t,"x",(function(){return me})),n.d(t,"N",(function(){return fe})),n.d(t,"K",(function(){return pe})),n.d(t,"M",(function(){return he})),n.d(t,"e",(function(){return Ce})),n.d(t,"D",(function(){return ge})),n.d(t,"c",(function(){return ye})),n.d(t,"H",(function(){return be})),n.d(t,"d",(function(){return Te})),n.d(t,"b",(function(){return Ie})),n.d(t,"j",(function(){return Se}));var i=n(0),o=n(55),a=n(3),r=n(84),s=n(188),c=n(372),d=n(344),u=n(104),l=n(75),m=n(96),f=n(122),p=n(16),h=n(442),C=n(65),g=n(145),v=n(20),y=n(78),b=n(8),T=n(7),I=n(97),S=n(127),O=n(293),D=n(12),w=n(99),j=n(179),P=n(304),x=n(345);function E(e){return""===e||null===e?void 0:e}function A(e){return e.state===w.a.Placeholder||e.state===w.a.Loading}function k(e){for(var t={},n=0;n<e.length;++n)t[e[n].commentId]=_(e[n].displayDate,!1);return t}function _(e,t,n){return void 0===n&&(n=j.a.None),{displayDate:e,displayingErrorUI:t,pending:n}}function R(e,t,n){return t||(!e||isNaN(e.getDate())?"":h.a(e,n))}function M(e,t){var n=Object(i.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function V(e,t,n){for(var i={},o=0;o<e.length;++o)if(""===e[o].parentId){var a=t===w.a.Loading||t===w.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:w.a.Loaded};i[e[o].commentId]=L({loadState:a,alternateId:n})}return i}function F(e){var t,n,o={};try{for(var a=Object(i.__values)(e),r=a.next();!r.done;r=a.next()){var s=r.value;o[s.threadId]=L({loadState:{state:w.a.Placeholder,initialItemCount:s.itemCount}})}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}function L(e){var t;return void 0===e&&(e={}),{loadState:(t=e.loadState,null!=t?t:{state:w.a.Loaded}),pending:S.a.None,alternateId:e.alternateId}}function N(e){var t={};return t[e]={pending:j.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function U(e){var t={};return t[e]={pending:S.a.Card,loadState:{state:w.a.Loaded}},t}function B(e,t){var n=Object(i.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function z(e,t,n,i){if(e){var o=Object(D.c)(e.focusDetails)?e.selectedCardId:e.focusDetails.selectedPostId,a=t.findIndex((function(e){return e.commentId===o})),r=t.findIndex((function(t){return t.commentId===e.selectedCardId}));if(r>=n&&r<i)return;if(a>=n&&a<i){var s={expanded:!0,editingSession:D.a.None};return{selectedCardId:e.selectedCardId,focusDetails:s}}}return e}function H(e,t){if(!e.focusedComment||!Object(D.c)(e.focusedComment.focusDetails))throw Object(o.e)("Focus bug - focus is not on Card "+t.parentId+" after typing in the reply box"),new v.a(y.c,-2130957564);var n={expanded:e.focusedComment.focusDetails.expanded,editingSession:D.a.None};return{selectedCardId:t.parentId,focusDetails:n}}function W(e){var t={editingSession:D.a.None,expanded:!e.parentId};return{selectedCardId:Object(l.b)(e),focusDetails:t}}function G(e,t){var n=e.commentData.find((function(e){return e.commentId===t}));if(n){var i={editingSession:D.a.None,expanded:!0};return{selectedCardId:Object(l.b)(n),focusDetails:i}}throw new v.a(y.d,-2130957563)}function q(e,t){return{selectedCardId:t,focusDetails:{expanded:$(t,e),editingSession:D.a.None}}}function Y(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return{selectedCardId:t.sessionConfiguration.draftId,focusDetails:{expanded:!0,editingSession:D.a.Active}};case"EDIT":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n){var i={selectedPostId:t,editingSession:D.a.Active};return{selectedCardId:Object(l.b)(n),focusDetails:i}}throw new v.a(y.g,-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n&&""===n.parentId){var i={expanded:!1,editingSession:D.a.Active};return{selectedCardId:n.commentId,focusDetails:i}}throw new v.a(y.g,-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new v.a(y.f,-2130957532)}}function K(e,t){var n=!1,i=!1;switch(e&&e.selectedCardId===t.payload.selectedCard&&Object(D.i)(e.focusDetails)&&(Object(D.c)(e.focusDetails)?n=!0:e.focusDetails.selectedPostId===t.payload.selectedPost&&(i=!0)),t.payload.focusType){case I.a.ExpandCard:var o={expanded:!0,editingSession:n&&e?e.focusDetails.editingSession:D.a.None};return{selectedCardId:t.payload.selectedCard,focusDetails:o};case I.a.CollapseCard:o={expanded:!1,editingSession:n&&e?e.focusDetails.editingSession:D.a.None};return{selectedCardId:t.payload.selectedCard,focusDetails:o};case I.a.SelectPost:var a={selectedPostId:t.payload.selectedPost,editingSession:i&&e?e.focusDetails.editingSession:D.a.None};return{selectedCardId:t.payload.selectedCard,focusDetails:a};default:return e}}function J(e,t,n){var i,o=t.payload.params,a=n;return Object(u.f)(o)?i={editingSession:D.a.SessionRequestPending,expanded:$(o.threadId,e)}:Object(u.e)(o)?i={editingSession:D.a.SessionRequestPending,selectedPostId:o.commentId}:b.J()?(a=e?e.selectedCardId:n,i={editingSession:D.a.SessionRequestPending,expanded:$(a,e)}):i={editingSession:D.a.SessionRequestPending,selectedPostId:Object(C.w)()},{selectedCardId:a,focusDetails:i}}function Q(e,t){if(e&&t.type===T.a.ClearCommentSelectionType&&Object(D.i)(e.focusDetails))return!1;if(e&&Object(D.i)(e.focusDetails)&&t.type!==T.a.ClearCommentSelectionType){var n=t.payload.focusType===I.a.CollapseCard||t.payload.focusType===I.a.ExpandCard;return t.payload.selectedCard===e.selectedCardId&&Object(D.c)(e.focusDetails)&&n}return!0}function Z(e){var t={};return e.commentId&&(t[e.commentId]={pending:S.a.None,loadState:{state:w.a.Loaded}}),t}function X(e){var t={};return e.commentId&&(t[e.commentId]={pending:j.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function $(e,t){return!(!t||t.selectedCardId!==e)&&(!Object(D.c)(t.focusDetails)||t.focusDetails.expanded)}function ee(e,t){return e&&e.selectedCardId===t.payload.commentId?{selectedCardId:t.payload.commentId,focusDetails:{editingSession:D.a.None,expanded:ve(e)}}:e}function te(e,t,n,o){if(e&&n[e.newComment.commentId]&&(n[e.newComment.commentId].pending===S.a.None||!o)){var a=Object(i.__assign)({},e),r=t.length;if(a.index>=r)a.index=r;else if(a.index>=0&&t[a.index].parentId){var s=new d.a(t,a.index);s.next().done?a.index=r:a.index=s.currentIndex()}return a}}function ne(e){return Object(i.__assign)(Object(i.__assign)({},e),{focusDetails:{expanded:!1,editingSession:D.a.None}})}function ie(e,t){var n=Object(i.__assign)({},e);return n[t]&&delete n[t],n}function oe(e,t){if(void 0===t)return Object(a.i)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;Object(a.i)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(a.i)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518);var n=Object(i.__assign)({},e);return delete n[t.sessionConfiguration.draftId],n}function ae(e,t){return Object(P.a)(e,t)===f.a.CanAutoDiscard?Object(O.d)():e}function re(e,t){if(!b.t())return e;var n=Object(i.__assign)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var a=t(e);a!==n[e].renderContextType&&(n[e]=Object(i.__assign)(Object(i.__assign)({},n[e]),{renderContextType:a}),o=!0)})),o?Object(i.__assign)(Object(i.__assign)({},e),{drafts:n}):e}function se(e,t){if(t===m.a.Closed){if(Object(g.b)(e))return p.a.None}else if(e===p.a.DiscreteIntegrated)return p.a.FullPane;return e}function ce(e,t){if(t){if(e===p.a.DiscreteIntegrated)return p.a.FullPane}else if(Object(g.b)(e))return p.a.None;return e}function de(e){var t=ue(e);return t?t.commentDraft:void 0}function ue(e){var t=e.drafts,n=Object.keys(t);if(n.length>1)throw Object(a.i)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new v.a("Only a single draft is supported at this time.",-2130957551);if(0!==n.length)return t[n[0]]}function le(e,t){if(!t)return-1;var n=Object(D.c)(t.focusDetails)?t.selectedCardId:t.focusDetails.selectedPostId;return e.findIndex((function(e){return e.commentId===n}))}function me(e,t,n,i){var o=e&&Object(D.i)(e.focusDetails),a=e&&o?void 0:t.selectedCardId,r=Object(D.c)(t.focusDetails)||n&&o?void 0:t.focusDetails.selectedPostId;if(a&&i.cardIdToDraftIdMap[a])return pe(i,a);if(r&&i.postIdToDraftIdMap[r])return he(i,r);return i}function fe(e){return{drafts:oe(e.drafts,de(e)),cardIdToDraftIdMap:{},postIdToDraftIdMap:{}}}function pe(e,t){var n,i=e.cardIdToDraftIdMap[t];return i?{drafts:oe(e.drafts,b.Y()?null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft:e.drafts[i].commentDraft),cardIdToDraftIdMap:ie(e.cardIdToDraftIdMap,t),postIdToDraftIdMap:e.postIdToDraftIdMap}:e}function he(e,t){var n,i=e.postIdToDraftIdMap[t];return i?{drafts:oe(e.drafts,b.Y()?null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft:e.drafts[i].commentDraft),cardIdToDraftIdMap:e.cardIdToDraftIdMap,postIdToDraftIdMap:ie(e.postIdToDraftIdMap,t)}:e}function Ce(e,t){return b.M()?e.atMention:t.capability}function ge(e,t){return b.M()?e.virtualized:t}function ve(e){return!!e&&(!Object(D.c)(e.focusDetails)||e.focusDetails.expanded)}function ye(e,t){return!(!t||!t.draftWarningState||e&&e.draftWarningState&&t.draftWarningState.warningCounter===e.draftWarningState.warningCounter)}function be(e,t,n){var i=e.pendingCommentLoad,a=void 0;if(e.pendingCommentLoad){var r=e.pendingCommentLoad.selectedThreadIndex;if(void 0!==r&&Object(x.a)({commentData:t,pendingCommentLoad:i,virtualized:n})){var s=t.filter(l.a);if(!(r>=0&&r<s.length))throw Object(o.e)("selectedThreadIndex out of bounds"),new v.a(y.m,-2130957565);a=function(e){return{selectedCardId:e,focusDetails:{expanded:!0,editingSession:D.a.None}}}(s[r].commentId)}t.length===e.pendingCommentLoad.numberOfComments&&(i=void 0)}else Object(o.e)("LoadCommentAction dispatched without pending comment load");return e.focusedComment&&Object(D.i)(e.focusedComment.focusDetails)&&(a=e.focusedComment),{pendingCommentLoad:i,focusedComment:a}}function Te(e,t){var n,i,o,a,r=e.find((function(e){return e.commentId===t}));return(null===(n=r)||void 0===n?void 0:n.author.DisplayName)&&(null===(i=r)||void 0===i?void 0:i.date)?{valid:!0,matchesCurrentUser:!!(null===(o=r)||void 0===o?void 0:o.author.IsCurrentUser),timeElapsed:(null===(a=r)||void 0===a?void 0:a.date)?Date.now()-r.date.getTime():0}:{valid:!1}}function Ie(e,t){return t?e.filter((function(e){return""===e.parentId&&!(e.commentFlags&s.a.Resolved)})).length>0:e.length>0}function Se(){return{atMention:r.b.Unknown,newThread:!1,resolve:!1,virtualized:!1,tasks:c.a.Unknown}}},,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.NumberOfCandidatesRequested="NumberOfCandidatesRequested",e.SearchGraph="SearchGraph",e.NumberOfCandidatesReceived="NumberOfCandidatesReceived",e.ServiceId="ServiceId",e.AtMentionsEnabled="AtMentionsEnabled",e.PaneCloseResult="PaneCloseResult",e.UserCanWrite="UserCanWrite",e.SwipeDirection="SwipeDirection",e.SwipeAcrossContext="SwipeAcrossContext",e.ModalDialogMode="ModalDialogMode",e.Trackback="Trackback",e.SessionType="SessionType",e.ActiveSessionType="ActiveSessionType",e.NumberOfMentionsAdded="NumberOfMentionsAdded",e.AllUsersGrantedAccess="AllUsersGrantedAccess",e.ShareDialogCanceled="ShareDialogCanceled",e.DiscardDialogShown="DiscardDialogShown",e.CancelledByUser="CancelledByUser",e.DiscardUnnecessary="DiscardUnnecessary",e.SessionAlreadyRequested="SessionAlreadyRequested",e.OperationType="OperationType",e.ExceptionType="ExceptionType",e.EventType="EventType",e.HalfPaneDisplayModeType="DisplayMode",e.PaneCorrelationId="PaneCorrelationId",e.SharedCommentsVersion="SharedCommentsVersion",e.CommentId="CommentId",e.NumberOfComments="NumberOfComments",e.NumberOfThreads="NumberOfThreads",e.RenderContextType="RenderContextType",e.MentionTokenState="MentionTokenState",e.CommitPendingAttemptedCancel="CommitPendingAttemptedCancel",e.FeatureGateState="FeatureGateState",e.DisabledChangeGates="DisabledChangeGates",e.IsNewFeatureGateAPI="IsNewFeatureGateAPI",e.SelectType="SelectType",e.ActionSource="ActionSource",e.IsCurrentCard="IsCurrentCard",e.DidDraftLockUpdate="DidDraftLockUpdate",e.IsClaimingDraftLock="IsClaimingDraftLock",e.IsUpdatingAllDraftLocks="IsUpdatingAllDraftLocks",e.MapStateToPropsDuration="MapStateToPropsDuration",e.InstanceCorrelationId="InstanceCorrelationId",e.MissingInstanceTelemetry="MissingInstanceTelemetry",e.ContainerName="ContainerName",e.DelayLoadRetryCount="DelayLoadRetryCount",e.AffectingTaskMetadata="AffectingTaskMetadata",e.AssociatedCommentId="AssociatedCommentId",e.IsPaneVisible="IsPaneVisible",e.DraftWarningType="DraftWarningType",e.CreateThreadWithMentions="CreateThreadWithMentions",e.CreateReplyWithMentions="CreateReplyWithMentions",e.CreateThreadWithTaskAssigned="CreateThreadWithTaskAssigned",e.CreateReplyWithTaskAssigned="CreateReplyWithTaskAssigned",e.ResolveThreadWithTask="ResolveThreadWithTask",e.ReopenThreadWithTask="ReopenThreadWithTask",e.DeleteThreadWithTask="DeleteThreadWithTask",e.DraftWarningReason="DraftWarningReason",e.DiscardDraftIfEmptyResult="DiscardDraftIfEmptyResult",e.MatchesCommentAuthor="MatchesCommentAuthor",e.CommentCreationTimeDeltaMs="ThreadCreationDeltaMs",e.CardDisplayMode="CardDisplayMode",e.ScrollOffset="ScrollOffset",e.IsHorizontal="IsHorizontal",e.ContentHeight="ContentHeight",e.Duration="Duration",e.NumRescrolls="NumberOfRescrolls",e.EndReason="EndReason",e.IsPreExistingTask="IsPreExistingTask",e.TaskCreationTimeDeltaMs="TaskCreationTimeDeltaMs",e.DraftDiscardBehavior="DraftDiscardBehavior",e.NumberOfHyperlinks="NumberOfHyperlinks",e.IsCardExpanded="IsCardExpanded",e.ExpandedCardHeight="ExpandedCardHeight",e.IsDraftInCurrentContext="IsDraftInCurrentContext",e.CommentIsNew="CommentIsNew",e.DraftId="DraftId"}(i||(i={}))},,function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"isContentStateForExtensionPriorityEnabled",(function(){return O})),n.d(i,"isAlwaysCacheExtensionsEnabled",(function(){return D})),n.d(i,"isRemoveInvalidIdsFromCacheEnabled",(function(){return w})),n.d(i,"isCacheExtensionWithActiveListenerEnabled",(function(){return j})),n.d(i,"isComponentDimensionsInStateEnabled",(function(){return P}));var o,a=n(55),r=n(175);!function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"}(o||(o={}));var s,c,d,u,l=n(0),m=n(841);function f(e){return e.scope.renderMode===u.Isolated}function p(e){return e===s.Enabled_Default||e===s.Enabled_ForcePrimary}!function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"}(s||(s={})),function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread"}(c||(c={})),function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"}(d||(d={})),function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated"}(u||(u={}));var h,C=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(e){var t;return this.store.forEach((function(n,i){if(n.has(e)){if(t)throw new Error("Double registration across instances for an extension key.");t=i}})),t},e.prototype.insertExtension=function(e,t){var n=t.instanceId;this.store.has(n)||this.store.set(n,new Map);var i=this.store.get(n);if(i.has(e.extensionKey))throw new Error("Duplicate Registration in same instance.");this.store.forEach((function(t,i){if(i!==n&&t.has(e.extensionKey))throw new Error("Duplicate Registration in different instance.")})),i.set(e.extensionKey,t)},e.prototype.updateExtension=function(e,t){var n=this.getInstanceIdForExtensionKey(e);if(n){var i=this.store.get(n);if(i){var o=i.get(e);if(o)return o=Object(l.__assign)(Object(l.__assign)({},o),t),i.set(e,o),o}}},e.prototype.removeExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n){var i=n.get(e);return n.delete(e),i}}},e.prototype.getExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n)return n.get(e)}},e.prototype.getExtensionsByInstance=function(e){return this.store.get(e)},e}(),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.initialize=function(){},t}(function(){function e(){var e=this;this.onExtensionUpdated=new r.EventImpl((function(){})),this.extensionStore=new C,this.getExtensionsInternal=function(t,n){var i=e.extensionStore.getExtensionsByInstance(n);if(!i)return[];var o=[];return i.forEach((function(e,n){e.contentType===t&&o.push({state:e,id:n})})),o}}return e.prototype.triggerExtensionUpdated=function(e,t){this.onExtensionUpdated.trigger({extension:e,updateType:t})},e.prototype.registerExtension=function(e,t,n){var i=m.v4(),a=void 0!==n.priority?n.priority:d.Primary,r={extensionKey:i,instanceId:n.instanceId},s=n.renderMode===u.Isolated?{componentKey:t,contentType:e,priority:a,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:t,contentType:e,priority:a,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(r,s);var c={id:i,state:s};return this.triggerExtensionUpdated(c,o.Add),c},e.prototype.unregisterExtension=function(e){var t=this.extensionStore.removeExtension(e);t&&this.triggerExtensionUpdated({id:e,state:t},o.Remove)},e.prototype.updateExtension=function(e,t){var n=this,i=function(t,i){t&&n.triggerExtensionUpdated({id:e,state:t},i)};t?i(this.extensionStore.updateExtension(e,t),o.Modify):i(this.extensionStore.getExtension(e),o.ReQuery)},e.prototype.getExtensions=function(e,t){return this.getExtensionsInternal(e,t)},e.prototype.getExtension=function(e){var t=this.extensionStore.getExtension(e);if(void 0!==t)return{id:e,state:t}},e}());function v(){if(void 0===h){var e=new g;e.initialize(),h=e}return h}var y,b=["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}],T=(r.RekaServiceRegistry.getNativeService(b),function(){function e(){}e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(e){},e.ServiceInfo=b}(),n(3)),I=n(29);function S(){return y||(y=Object(I.a)())}function O(){return S().isChangeGateEnabled("ContentStateForExtensionPriority",Object(I.c)(4140703))}function D(){return S().isChangeGateEnabled("AlwaysCacheExtensions",Object(I.c)(4153093))}function w(){return S().isChangeGateEnabled("RemoveInvalidIdsFromCache",Object(I.c)(4160707))}function j(){return S().isChangeGateEnabled("CacheExtensionWithActiveListener",Object(I.c)(4231335))}function P(){return S().isChangeGateEnabled("ComponentDimensionsInState",Object(I.c)(4240063))}var x=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e,t=v().getExtension(this.extensionKey);if(!t||t.state.renderMode!==u.Integrated)throw Object(T.i)().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592316051),Object(T.i)().assertConditionTag((null===(e=t)||void 0===e?void 0:e.state.renderMode)===u.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:t.state.contentType,renderMode:t.state.renderMode,instanceId:t.state.instanceId,componentKey:t.state.componentKey,priority:t.state.priority,componentDimensions:t.state.componentDimensions,type:"Integrated"}},e}();function E(e,t){var n=e.isContentAvailable(t),i=function(e,t){switch(e){case d.Primary:case d.Secondary:switch(t){case s.Invalid:case s.Disabled:return d.Disabled;case s.Enabled_Default:return e;case s.Enabled_ForcePrimary:return d.Primary}case d.Disabled:return e}}(e.priority,n),o=n!==s.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:i,contentId:t,isContentIdValid:o,type:"Isolated"}}var A=function(){function e(e,t){var n=this;this.extensionKey=e,this.scope=t,this.cachedExtensions={},this.onExtensionUpdate=function(e){e.updateType!==o.Remove?e.extension.id===n.extensionKey&&n.updateCachedExtensions():n.teardown()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=v().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(e){var t,n=this,i=this.cachedExtensions[e];if(i)return i.extension;var o=v().getExtension(this.extensionKey);if(!o||o.state.renderMode!==u.Isolated)throw Object(T.i)().assertConditionTag(!!o,"No extension data in provider. Querying a removed extension.",592316053),Object(T.i)().assertConditionTag((null===(t=o)||void 0===t?void 0:t.state.renderMode)===u.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var a=E(o.state,e),s=Object(l.__assign)(Object(l.__assign)({},a),{onUpdated:new r.EventImpl((function(t){var i=n.cachedExtensions[e];i&&(t?i.hasListener=!0:delete n.cachedExtensions[e])}))});return(D()||s.isContentIdValid)&&(this.cachedExtensions[e]={extension:s,hasListener:!1}),s},e.prototype.updateCachedExtensions=function(){var e,t=this,n=v().getExtension(this.extensionKey);if(!n||n.state.renderMode!==u.Isolated)return Object(T.i)().assertConditionTag(!!n,"No extension data in provider. Querying a removed extension.",592314635),void Object(T.i)().assertConditionTag((null===(e=n)||void 0===e?void 0:e.state.renderMode)===u.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);var o=n.state;Object.keys(this.cachedExtensions).forEach((function(e){var n,a=t.cachedExtensions[e],r=null===(n=a)||void 0===n?void 0:n.extension;if(r&&a){var s=E(o,e);(r.priority!==s.priority||r.isContentIdValid!==s.isContentIdValid)&&(r.priority=s.priority,r.isContentIdValid=s.isContentIdValid,r.onUpdated.trigger({})),i.isCacheExtensionWithActiveListenerEnabled()&&a.hasListener||s.isContentIdValid||delete t.cachedExtensions[e]}else Object(T.i)().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983)}))},e}(),k=function(){function e(e){this._detached=!1,this._id=e.id;var t={contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId};this._extensionProvider=e.state.renderMode===u.Isolated?new A(this._id,t):new x(this._id,t)}return e.prototype.triggerUpdate=function(){v().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,v().unregisterExtension(this._id)},e.prototype.updatePriority_deprecated=function(e){var t=v().getExtension(this._id);if(void 0===t)throw Object(T.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620258),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");t.state.priority!==e?v().updateExtension(this._id,{priority:e}):this.triggerUpdate()},e.prototype.updateState=function(e){var t=v().getExtension(this._id);if(void 0===t)throw Object(T.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");1===Object.keys(e).length&&void 0!==e.priority&&t.state.priority===e.priority?this.triggerUpdate():v().updateExtension(this._id,e)},Object.defineProperty(e.prototype,"priority",{get:function(){var e=v().getExtension(this._id);if(void 0===e)throw Object(T.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");return e.state.priority},set:function(e){this._detached||(P()?this.updateState({priority:e}):this.updatePriority_deprecated(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var e=v().getExtension(this._id);if(void 0===e)throw Object(T.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");return e.state.componentDimensions},set:function(e){this._detached||this.updateState({componentDimensions:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!0,configurable:!0}),e}(),_=function(){function e(e,t){var n=this;this.contentTypes=e,this.host=t,this.onUpdated=new r.EventImpl((function(){})),v().onExtensionUpdated.subscribe((function(t){e.find((function(e){return e===t.extension.state.contentType}))&&t.updateType!==o.ReQuery&&n.onUpdated.trigger({})}))}return Object.defineProperty(e.prototype,"providers",{get:function(){var e=[],t=function(t){var i=n.host.extensions[t];i.priority!==d.Disabled&&n.contentTypes.find((function(e){return e===i.provider.scope.contentType}))&&e.push(i.provider)},n=this;for(var i in this.host.extensions)t(i);return e},enumerable:!0,configurable:!0}),e}(),R=function(){function e(){var e=this;this.contentTypeRegistrationInfo={},this.extensions={},this.onExtensionFirstRequested=new r.EventImpl((function(){})),v().onExtensionUpdated.subscribe((function(t){switch(t.updateType){case o.ReQuery:break;case o.Remove:delete e.extensions[t.extension.id];break;case o.Add:case o.Modify:e.ensureExtensionCached(t.extension.id,t.extension.state);break;default:Object(a.h)(t.updateType)}}))}return e.prototype.registerExtension=function(e,t,n){var i=v().registerExtension(e,t,n);return this.ensureExtensionCached(i.id,i.state),Promise.resolve(this.extensions[i.id])},e.prototype.getExtensions=function(e){var t=this,n=new _(e,this);return e.forEach((function(e){v().getExtensions(e,"Default_7210d794-9f0f-4d0a-805c-964303b2676b").forEach((function(e){t.ensureExtensionCached(e.id,e.state)})),t.contentTypeRegistrationInfo[e]||(t.contentTypeRegistrationInfo[e]=!0,t.onExtensionFirstRequested.trigger({contentType:e}))})),n},e.prototype.ensureExtensionCached=function(e,t){void 0===this.extensions[e]&&(this.extensions[e]=new k({id:e,state:t}))},e}(),M=void 0;function V(){if(!M)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===M.ContentExtensionHostAdapter&&(M.ContentExtensionHostAdapter=new R),M.ContentExtensionHostAdapter}"undefined"!=typeof window&&(M=window),n.d(t,"e",(function(){return V})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return p}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i,o=n(29),a=n(20);function r(){if(!i)try{i=Object(o.a)()}catch(e){throw new a.a("FeatureGateAPI not initialized",-2130957531)}return i}},,,function(e,t,n){"use strict";var i=n(0),o=n(55),a="$officeonline_globalapi_cache",r=void 0;"undefined"!=typeof window&&(r=window),r[a]||(r[a]={});var s=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new Error("'"+this.apiName+"' singleton is already initialized");return this.ctorStack=Object(o.c)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(i.__spread)([void 0],t)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new Error("'"+this.apiName+"' singleton has not been initialized");return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new Error("API has already been initialized.\nFirst initialization: "+this.ctorStack);this.DefaultCtor=e},e}();var c,d,u,l=function(){function e(e){if(!e)throw new Error("Missing required arguments in FeatureGateAPIImpl!");this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new Error("FeatureGate API not initialized!");var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new Error("FeatureGate API not initialized!");var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!0,configurable:!0}),e}(),m=(c="FeatureGate",d=l,(u=r[a])[c]||(u[c]=new s(c,d)),u[c]);function f(e){return e}function p(e){return m.getAndInitialize(e)}function h(){return m.getInstanceOrThrow()}n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}))},function(e,t,n){"use strict";var i;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(i||(i={})),t.a=i},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={WHITE:"#FFFFFF",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",BLACK:"#000000",GRAY_20:"#F3F2F1",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_150:"#3B3A39",GRAY_160:"#323130",FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#7E7969",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",CHECKBOX_GREEN:"#31752F",CHECKBOX_HOVERED_GREEN:"#255924"}},,function(e,t,n){"use strict";var i;function o(e){return e===i.ClosePaneButton||e===i.NextCommentButton||e===i.PreviousCommentButton||e===i.GhostCard||e===i.NewCommentButton||e===i.PaneRoot}function a(e){return(t=e.componentType)===i.CardEditor||t===i.PostEditor||t===i.Card||t===i.Post||t===i.DraftCard||t===i.DiscreteHostedCommentRoot;var t}function r(e,t){return a(e)&&a(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot"}(i||(i={}))},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var i=n(96),o=n(8),a=function(e){return o.O()?e.paneState.visibilityState===i.a.Visible:e.paneState.visible_deprecated},r=function(e){return e.paneState.visibilityState!==i.a.Closed},s=function(e){return e.paneState.componentTree},c=function(e){return e.paneState.viewContainer}},,,,,,,,,,,function(e,t,n){"use strict";var i,o,a=function(){},r=function(){},s=function(){};!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(i||(i={}));function c(e,t){var n;if(o){var i=null===(n=window)||void 0===n?void 0:n.performance;if(i&&"function"==typeof i.measure&&"function"==typeof i.mark)return new o(e,t,i)}}function d(e){throw new Error("Unreachable throw hit! Passed in value is "+e+".")}function u(e,t){if(!e)throw new Error(t)}function l(){try{throw new Error}catch(e){return e.stack?e.stack.split("\n").slice(2,3).join("\n"):"<unable to get stack>"}}n.d(t,"i",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return!1})),n.d(t,"b",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d}))},,,,function(e,t,n){"use strict";var i;!function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(i||(i={}));var o,a=n(299),r=n(667);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.F6=117]="F6"}(o||(o={})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return o}))},,,,,,function(e,t,n){"use strict";n(3);var i=n(8);n(16);function o(e){return"_"+e.renderContextType+"_"+e.id}function a(e){return"cardEditor"+o(e)}function r(e){return"cardEditor_"+e}function s(e){return"postEditor"+o(e)}function c(e){return"editorRoot_"+e}function d(e){return"postEditor_"+e}function u(e){return"postRoot"+o(e)}function l(e,t){return t?"draftCardRoot"+o(e):"cardRoot"+o(e)}function m(e){return e||"GhostCard"}function f(e){return"replyBoxDescription"+o(e)}function p(e){return"editorBoxDescription"+o(e)}function h(e){return"sendReplyButton"+o(e)}function C(e){return"cancelReplyButton"+o(e)}function g(e){return i.o()?"cardContextMenu"+o(e):function(e){return"lastCardElementRef"+o(e)}(e)}function v(e){return"postContextMenu"+o(e)}function y(e){return"renderableItemList"+o(e)}function b(e,t){return"actionBarButton_"+t+o(e)}function T(e){return"editorFocusContainer_"+e}function I(e){return"draftCancelButton"+o(e)}function S(e){return"innerReplyBoxContainer"+o(e)}function O(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function D(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function w(){return"lastPaneElement027D6A54-A6AB-4E26-B513-B6C202372EB7"}function j(){return"postFocusBar"}function P(e){return"viewMoreReply"+o(e)}function x(e){return"postTimeStamp"+o(e)}function E(e,t){return""+t.replace(/\s/g,"")+o(e)}function A(e){return"suggestionsList"+e}function k(e,t){return""+t.replace(/\s/g,"")+o(e)}function _(e){return"anchorHintText"+o(e)}function R(e){return"lowFidelityWarning"+o(e)}function M(){return"CommentsListScrollView"}function V(e){return"cardSideBar"+o(e)}function F(){return"EmptyCreatedCommentLie"}function L(){return"NewCommentButton"}function N(e){return"taskAssignerCheckbox"+o(e)}function U(e){return"cardTaskFooterPickerButton"+o(e)}function B(e){return"cardTaskHeaderCheckbox"+o(e)}function z(e){return"cardTaskHeaderDiv"+o(e)}function H(e){return"taskAssignerDiv"+o(e)}function W(e){return"postWarning"+o(e)}function G(e){return"draftWarning"+o(e)}function q(e){return"truncationOverlay"+e}function Y(){return"next-thread-button"}function K(){return"previous-thread-button"}function J(e){return"loadingPlaceholder"+o(e)}function Q(e){return"DiscreteHostedCommentRoot"+o(e)}n.d(t,"e",(function(){return a})),n.d(t,"n",(function(){return r})),n.d(t,"E",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"H",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"y",(function(){return m})),n.d(t,"N",(function(){return f})),n.d(t,"t",(function(){return p})),n.d(t,"O",(function(){return h})),n.d(t,"M",(function(){return C})),n.d(t,"d",(function(){return g})),n.d(t,"G",(function(){return v})),n.d(t,"L",(function(){return y})),n.d(t,"a",(function(){return b})),n.d(t,"u",(function(){return T})),n.d(t,"r",(function(){return I})),n.d(t,"g",(function(){return S})),n.d(t,"x",(function(){return O})),n.d(t,"l",(function(){return D})),n.d(t,"z",(function(){return w})),n.d(t,"F",(function(){return j})),n.d(t,"T",(function(){return P})),n.d(t,"I",(function(){return x})),n.d(t,"p",(function(){return E})),n.d(t,"B",(function(){return A})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return _})),n.d(t,"A",(function(){return R})),n.d(t,"m",(function(){return M})),n.d(t,"i",(function(){return V})),n.d(t,"w",(function(){return F})),n.d(t,"C",(function(){return L})),n.d(t,"P",(function(){return N})),n.d(t,"R",(function(){return U})),n.d(t,"j",(function(){return B})),n.d(t,"k",(function(){return z})),n.d(t,"Q",(function(){return H})),n.d(t,"J",(function(){return W})),n.d(t,"s",(function(){return G})),n.d(t,"S",(function(){return q})),n.d(t,"D",(function(){return Y})),n.d(t,"K",(function(){return K})),n.d(t,"f",(function(){return J})),n.d(t,"q",(function(){return Q}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return i}));var i,o=n(298);function a(e){return e===o.a.CheckEnabled}function r(e){return e===o.a.CheckToggled}function s(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return T})),n.d(t,"h",(function(){return I})),n.d(t,"g",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"i",(function(){return D})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"j",(function(){return P})),n.d(t,"b",(function(){return x}));var i=n(0),o=n(3),a=n(191),r=n(75),s=n(213),c=n(106),d=n(20),u=n(78),l=n(8),m=n(127),f=n(179),p=n(148),h=n(339);function C(e,t,n){for(var i=t;i<e.length;++i)if(e[i].commentId===n.commentId)return i;return-1}function g(e,t,n,i,a,r){for(var s=[],c=t,d=a;c<=n&&d<=r;){var u=e[c].date;Object(o.i)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=i.history[d].records[0].time?(Object(o.i)().assertConditionTag(e[c].parentId===i.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(o.i)().assertConditionTag(!i.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:i.history[d],parentThreadId:i.commentId}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=r;++d)Object(o.i)().assertConditionTag(!i.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:i.history[d],parentThreadId:i.commentId});return s}function v(e,t){if(!l.b()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(l.c()||t.commentId===t.history[0].commentId||(Object(o.i)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(o.i)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var a=[];l.c()||a.push({commentModel:e[0],historyItem:t.history[0]});for(var r=l.c()?0:1,s=l.c()?0:1,c=l.c()?0:1;r<e.length&&c<t.history.length;){var d=C(e,r,t.history[c]);d>=0&&(a.push.apply(a,Object(i.__spread)(g(e,r,d-1,t,s,c-1))),Object(o.i)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),a.push({commentModel:e[d],historyItem:t.history[c]}),r=d+1,s=c+1),++c}return a.push.apply(a,Object(i.__spread)(g(e,r,e.length-1,t,s,t.history.length-1))),a}function y(e,t){for(var n=[],o=0,a=1;a<=e.length;a++)(a===e.length||Object(r.a)(e[a]))&&(n.push.apply(n,Object(i.__spread)(v(e.slice(o,a),t[e[o].commentId]))),o=a);return n}function b(e){return e.filter(p.a).map((function(e){return e.commentModel}))}function T(e,t){var n=e.find((function(e){return Object(p.a)(e)&&e.commentModel.commentId===t}));if(Object(p.a)(n))return n.commentModel}function I(e){var t=e[0];if(Object(p.a)(t))return t.commentModel;throw new d.a(u.a,2130957505)}function S(e){return Object(p.a)(e)?e.commentModel.parentId:e.parentThreadId}function O(e){return Object(p.a)(e)?e.commentModel.commentId:e.historyItem.records[0].recordId}function D(e){return Object(p.a)(e)?Object(r.b)(e.commentModel):e.parentThreadId}function w(e,t){var n=e.records[0];switch(n.type){case s.a.Create:if(!(a=e.records[1])||a.type!==s.a.Assign)return Object(o.i)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:"Unexpected HistoryRecordType"};var i=Object(c.g)(a.assignee);return{icon:13,description:t.formatString(114,i)};case s.a.UnassignAll:case s.a.Unassign:var a;if(!(a=e.records[1])||a.type!==s.a.Assign)return Object(o.i)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:0,description:"Unexpected HistoryRecordType"};i=Object(c.g)(a.assignee);return{icon:14,description:t.formatString(115,i)};case s.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:16,description:t.getString(117)};case s.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(o.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function j(e,t){return e.findIndex((function(e){return e.length>0&&D(e[0])===t}))}function P(e,t){return e.some((function(e){return Object(p.a)(e)&&!!(e.commentModel.commentFlags&a.e.LowFidelity)&&(void 0===t||t===e.commentModel.parentId||t===e.commentModel.commentId)}))}function x(e,t,n,i,a,r){for(var s=[],c=!r&&void 0!==i&&(void 0===i.newComment.parentId||""===i.newComment.parentId)&&i.index>=0,d=b(e).length,u=i&&i.index===d?d:-1,l=-1,C=0;C<e.length;C+=1){var g=e[C],v=Object(p.a)(g)?g:void 0;if(v&&void 0!==t[v.commentModel.commentId])if(t[v.commentModel.commentId].pending===m.a.Delete&&a)for(;!(C+1>=e.length||""===S(e[C+1]));)++C;else{++l,s.push([v]),c&&-1===u&&i&&l===i.index&&(u=s.length-1);for(var y=C+1;y<e.length;y+=1){var T=e[y];if(Object(p.a)(T)){var I=S(T);if(I!==v.commentModel.commentId){Object(o.i)().assertConditionTag(!I,"Orphaned reply with id "+O(T)+", expected parent "+v.commentModel.commentId+" but was "+I,593085889);break}n&&n[O(T)].pending===f.a.Delete||s[s.length-1].push(T),++l}else s[s.length-1].push(T);++C}}else{var D=v?v.commentModel.commentId:"",w=v?v.commentModel.parentId:"";for(Object(o.i)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: "+e.length+" | cardViewStateLength: "+Object.keys(t).length+" | postViewStateLength:  "+(n?Object.keys(n).length:-1)+" | isLieThread: "+c+" | CommentId: "+D+" | ParentId: "+w,593085888);!(C+1>=e.length||""===S(e[C+1]));)++C}}if(-1!==u&&c&&i){var j=Object(h.a)(i);s.splice(u,0,[{commentModel:j}])}return s}},,,,,,,,function(e,t,n){"use strict";function i(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";function i(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function a(e){return void 0!==e.threads&&void 0===e.comments}var r;function s(e){return(void 0!==e.comments||void 0!==e.commentIds)&&void 0!==e.numberOfThreads}function c(e){return void 0!==e.commentIds&&void 0!==e.numberOfThreads}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function m(e){return void 0!==e.contextDetails}function f(e){return void 0!==e.capabilities}function p(e){return void 0!==e.modelCapabilityFlags}function h(e){return void 0!==e.errorType}function C(e){return void 0!==e.draftId}function g(e){return void 0!==e.draftId}n.d(t,"b",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"o",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return g})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"m",(function(){return a})),n.d(t,"i",(function(){return r})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"n",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return C})),n.d(t,"p",(function(){return g})),n.d(t,"a",(function(){return v}));var i="Focus bug - focus is not on card after typing in the reply box",o="Focused comment not found",a="Selected thread index out of bounds",r="Invalid number of posts for display more replies string",s="Unrecognized post display mode",c="Method not implemented",d="CommentId not found in model",u="StringId is invalid",l="LocalizationModule NativeModule not valid",m="Store state unexpected",f="Editor reference is invalid",p="Invalid arguments",h="Comment ID value is invalid in the current operation",C="Attempting to perform an operation on an inactive draft",g="Feature not running with the correct feature gates which expect view manager construction",v="CommentModel not found in a thread of RenderableItems"},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(i||(i={})),t.b=i},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled"}(i||(i={}))},function(e,t,n){"use strict";n(323),n(209);var i=n(505);n.d(t,"h",(function(){return i.a})),n.d(t,"i",(function(){return i.b})),n.d(t,"j",(function(){return i.c})),n.d(t,"k",(function(){return i.d}));var o=n(191);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"c",(function(){return o.c})),n.d(t,"d",(function(){return o.e})),n.d(t,"e",(function(){return o.f})),n.d(t,"f",(function(){return o.g})),n.d(t,"g",(function(){return o.i}))},,,,,,,,,function(e,t,n){"use strict";var i;function o(e){return e.actionType===i.CreateThread&&void 0!==e.content}function a(e){return e.actionType===i.CancelCreateThread}function r(e){return e.actionType===i.StartReplySession&&void 0!==e.threadId}function s(e){return e.actionType===i.CancelReplySession&&void 0!==e.threadId}function c(e){return e.actionType===i.PostReply&&void 0!==e.threadId&&void 0!==e.content}function d(e){return e.actionType===i.DeleteComment&&void 0!==e.commentId}function u(e){return e.actionType===i.DeleteThread&&void 0!==e.threadId}function l(e){return e.actionType===i.ResolveThread&&void 0!==e.threadId}function m(e){return e.actionType===i.ReopenThread&&void 0!==e.threadId}function f(e){return e.actionType===i.StartEditSession&&void 0!==e.commentId}function p(e){return e.actionType===i.CancelEditSession&&void 0!==e.commentId}function h(e){return e.actionType===i.PostEdit&&void 0!==e.commentId&&void 0!==e.content}function C(e){return e.actionType===i.SelectComment&&void 0!==e.commentId}function g(e){return e.actionType===i.ClosePane}function v(e){return e.actionType===i.ClickGhostCard}n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"p",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"n",(function(){return C})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return v})),function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(i||(i={}))},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i,o=n(15),a=n(7);function r(e,t,n,i,r){return Object(o.b)(a.a.SelectCommentType,{selectedCard:t,selectedPost:n,focusType:i,source:r},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.CollapseCard=1]="CollapseCard",e[e.SelectPost=2]="SelectPost"}(i||(i={}))},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.Reloading=3]="Reloading",e[e.NeedsReload=4]="NeedsReload"}(i||(i={}))},,,function(e,t,n){"use strict";var i,o;!function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(o||(o={}));var a=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e,t){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),r=n(156),s=n(3),c=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e,t){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),d=void 0;function u(e,t){if(!d)throw new Error("Running in an invalid environment, window expected to exist.");Object(s.i)().assertConditionTag(void 0===d.ContentNavigationAPI,"Overriding already set ContentNavigationAPI.",591726551),d.ContentNavigationAPI=e}function l(e){if(Object(s.i)().assertConditionTag(e===r.a,"Unexpected API context received.",591726552),!d)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===d.ContentNavigationAPI&&(Object(s.i)().assertConditionTag(!1,"GetContentNavigationAPI called prior to API being set, overriding with stub.",591726553),d.ContentNavigationAPI=new c),d.ContentNavigationAPI}function m(e){return Object(s.i)().assertConditionTag(e===r.a,"Unexpected API context received.",591726554),void 0!==d.ContentNavigationAPI}function f(e){Object(s.i)().assertConditionTag(e===r.a,"Unexpected API context received.",591726555),d.ContentNavigationAPI=void 0}"undefined"!=typeof window&&(d=window),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return c}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return r}));var i="CREATE",o="EDIT",a="REPLY",r="METADATA"},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var i=n(135),o=n(80),a=n(103);function r(e){return e.sessionType===a.a}function s(e){return e.sessionType===a.d&&void 0!==e.threadId}function c(e){return e.sessionType===a.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function l(e){return r(e)?i.a.InitCreateCommentSession:s(e)?i.a.InitReplyCommentSession:c(e)?i.a.InitEditCommentSession:i.a.Unknown}},,function(e,t,n){"use strict";var i,o=n(3),a=n(140),r=n(8);!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(i||(i={}));var s=n(132);n(16),n(145),i.None;var c=function(e){return e===s.a.iOS||e===s.a.Android};var d=n(20);function u(e){return!!e&&void 0!==e.EmailAddresses}function l(e){return!!e&&void 0!==e.UserId}function m(e){return!!e&&void 0!==e.Id&&void 0!==e.Email}function f(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function p(e,t){return l(e)&&l(t)?f(e,t):m(e)&&m(t)?function(e,t){return e.Id===t.Id&&e.Email===t.Email}(e,t):!(!u(e)||!u(t))&&function(e,t){return C(e)===C(t)&&e.Name===t.Name}(e,t)}function h(e){return e?u(e)?e.Name:e.DisplayName:""}function C(e){if(!e)return"";if(!u(e))return Object(o.i)().assertConditionTag(!r.C()||c(Object(a.a)()),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(o.i)().assertConditionTag(!1,"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new d.a("UserPrincipalName and EmailAddresses, both not available",-2130957499)}function g(e){return void 0!==e.DisplayName?e.DisplayName:(Object(o.i)().assertConditionTag(!1,"user.DisplayName is not undefined",595133131),e.Email?e.Email:"")}function v(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function y(e){return 0===Object.keys(e).length&&Object(o.i)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function b(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!f(e[n],t[n]))return!1;return!0}function T(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function I(e,t){return e.filter((function(e){return!t.find((function(t){return f(e,t)}))}))}function S(e,t){return t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]})),e}function O(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return b})),n.d(t,"m",(function(){return T})),n.d(t,"l",(function(){return I})),n.d(t,"k",(function(){return S})),n.d(t,"b",(function(){return O}))},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested"}(i||(i={}))},,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(i||(i={}))},,,function(e,t,n){"use strict";var i,o=n(1),a=o.createContext(void 0);function r(e){return e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&((t=e)&&t.focus&&t.blur);var t}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(i||(i={}));var s=n(59),c=n(668),d=n(0);s.c.Tab,s.a.AtTarget,s.c.Tab,s.a.AtTarget;var u=n(299);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(729),function(){function e(e,t,n,i,a){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=i,this.focusState=a,this.registrationRef=o.createRef(),this.innerComponentRef=o.createRef()}e.prototype.onEffect=function(e,t,n,i){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=i,l(o)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();!function(){function e(t){this.def=t,this.childNodes=[],this.focus=jest.fn(),this.blur=jest.fn(),this.childNodes=t.childNodes.map((function(t){return new e(t)}))}e.prototype.getId=function(){return this.def.id},e.prototype.getData=function(){},e.prototype.getFocusState=function(){return this.def.isFocused?s.b.FocusOn:this.childNodes.some((function(e){return e.getFocusState()!==s.b.Unfocused}))?s.b.FocusWithin:s.b.Unfocused},e.prototype.getNextTabTarget=function(e,t){return function(e,t,n){var o=e.getFocusState();if(o!==s.b.FocusOn||n||t!==i.Reverse){if((o===s.b.Unfocused||n)&&t===i.Forward&&e.isTabbable())return e;var a=e.getChildNodes();t===i.Reverse&&a.reverse();for(var r=n?0:a.findIndex((function(e){return e.getFocusState()!==s.b.Unfocused})),c=r>=0?r:0;c<a.length;++c){var d=a[c].getNextTabTarget(t,n);if(d)return d}return t===i.Reverse&&e.isTabbable()?e:void 0}}(this,e,t)},e.prototype.isTabbable=function(){return this.def.isTabbable},e.prototype.getChildNodes=function(){return this.childNodes.slice()},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(e){var t,n;try{for(var i=Object(d.__values)(this.childNodes),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.getId()===e)return a;for(var r=a.getIterator(),s=void 0;!(s=r.next()).done;)if(s.value.getId()===e)return s.value}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.getIterator=function(){return e=this,function(){var t,n,i,o,a,r,s,c;return Object(d.__generator)(this,(function(u){switch(u.label){case 0:return[4,e];case 1:u.sent(),u.label=2;case 2:u.trys.push([2,8,9,10]),t=Object(d.__values)(e.getChildNodes()),n=t.next(),u.label=3;case 3:if(n.done)return[3,7];i=n.value,o=i.getIterator(),a=void 0,u.label=4;case 4:return(a=o.next()).done?[3,6]:[4,a.value];case 5:return u.sent(),[3,4];case 6:return n=t.next(),[3,3];case 7:return[3,10];case 8:return r=u.sent(),s={error:r},[3,10];case 9:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}();var e}}();var m=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}},f=(function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new m,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,i;try{for(var o=Object(d.__values)(this.viewTreeMap.values()),a=o.next();!a.done;a=o.next()){var r=null===(i=a.value.getRoot())||void 0===i?void 0:i.getDescendantById(e);if(r)return r}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}(),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&this.registrationToken.unregister(),this.registrationToken=void 0},t.prototype.render=function(){return o.Children.only(this.props.children)},t}(o.PureComponent));!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=o.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.__extends)(t,e),t.prototype.render=function(){var e=this;return o.createElement(a.Consumer,null,(function(t){return o.createElement(f,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(o.PureComponent);n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return s.c})),n.d(t,"a",(function(){return s.a})),n.d(t,"c",(function(){return s.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"f",(function(){return c.b}))},,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(i||(i={}))},function(e,t,n){"use strict";var i=n(84);n.d(t,"ActionBehavior",(function(){return i.a})),n.d(t,"AtMentionCapabilityState",(function(){return i.b})),n.d(t,"CommentUIAction",(function(){return i.e})),n.d(t,"InterruptableCommandResult",(function(){return i.f})),n.d(t,"REPLY_COMMENT_SESSION_TYPE",(function(){return i.g})),n.d(t,"getThreadId",(function(){return i.h})),n.d(t,"isEditDraftSessionConfiguration",(function(){return i.j})),n.d(t,"isReplyDraftSessionConfiguration",(function(){return i.k}));var o=n(757);n.o(o,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return o.initializeRuntime})),n.o(o,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return o.instantiateSharedComments})),n.o(o,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return o.renderCommentPaneWithAppInfo}));n(760);var a=n(761);n.o(a,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return a.initializeRuntime})),n.o(a,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return a.instantiateSharedComments})),n.o(a,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return a.renderCommentPaneWithAppInfo}));n(413)},function(e,t,n){"use strict";var i;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(i||(i={})),t.a=i},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(i||(i={}))},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(i||(i={}))},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.iOS="ios",e.Android="android",e.Windows="windows",e.Mac="macos",e.Web="web"}(i||(i={}))},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.SelectCard=7]="SelectCard",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(i||(i={}))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(132);function o(){return i.a.Web}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(20),o=n(358);function a(e,t){return Object(i.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n(16);function o(e){return e===i.a.FullPane||e===i.a.HalfPane}function a(e){return e===i.a.DiscreteIntegrated||e===i.a.DiscreteIsolated}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(i||(i={}))},function(e,t,n){"use strict";function i(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},,function(e,t,n){"use strict";var i=n(454),o=new i.a;n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i.c})),n.d(t,"b",(function(){return i.b}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(3),o=n(20);function a(e,t){Object(o.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,t):Object(i.i)().assertConditionTag(!1,"Unknown error in dispatch of discardDraftIfEmpty",t)}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.VisibilityChanged_deprecated=1]="VisibilityChanged_deprecated",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return"Default_7210d794-9f0f-4d0a-805c-964303b2676b"}))},,,function(e,t,n){"use strict";var i=n(3),o=n(150),a=n(123),r=n(188),s=n(83),c=(n(75),n(106)),d=n(211),u=n(23),l=n(20),m=n(154),f=n(8),p=n(30),h=n(169),C=n(19),g=n(135),v=n(134),y=n(12),b=n(147),T=n(772),I=n(122),S=n(124),O=n(16),D=n(168),w=n(166),j=n(302),P=n(65);var x=n(145),E=n(67);function A(e){var t=e.comment,n=e.threads,i=e.focusedComment,o=e.warningType,a=!t.parentId,s=!!(t.commentFlags&r.a.LowFidelity);if(!i)return!(!f.x()||!a||o!==y.a.LowFidelityWarningOnDeleteThread||!s&&!E.j(n,t.commentId))||f.o()&&s&&a;var c=s||a&&(o===y.a.LowFidelityWarningOnDelete||o===y.a.LowFidelityWarningOnDeleteThread)&&E.j(n,t.commentId),d=Object(y.c)(i.focusDetails)?i.selectedCardId:i.focusDetails.selectedPostId;return!(!c||d===t.commentId&&i.focusDetails.editingSession===o)}function k(e){var t=e.result,n=e.localizationAPI;f.p()&&t===h.a.Success&&Object(o.b)(n.getString(67))}function _(e){var t=e.componentTree,n=e.focusHandlerRegistry,i=e.isNewCommentButtonFocusable,o=e.threadIndex,a=e.discardCallback;return function(e,r){if(a){return a((function(){return n.onUserAction(t,D.a.CancelNewThreadDraft,{threadIndex:o,isNewCommentButtonFocusable:i}),e?e():s.a.Unhandled}),r)}return e?(n.onUserAction(t,D.a.CancelNewThreadDraft,{threadIndex:o,isNewCommentButtonFocusable:i}),Promise.resolve(e())):Promise.resolve(s.a.Unhandled)}}function R(e){var t=e.trackback,n=e.id,a=e.data,r=e.focusedComment,s=e.renderContextType,c=e.actionDispatchers,d=e.telemetryVisitor,u=e.localizationAPI,l=E.a(a,n);l?A({comment:l,threads:a,focusedComment:r,warningType:y.a.LowFidelityWarningOnDelete})?c.showLowFidelityWarning({renderContextType:s,telemetryVisitor:d,trackback:i.h.reserveTag(593826118)},n,y.a.LowFidelityWarningOnDelete):(Object(o.b)(u.getString(65)),c.requestDeleteComment({renderContextType:s,telemetryVisitor:d,trackback:t},n)):Object(i.i)().assertConditionTag(!1,"Comment not found",593826117)}function M(e){var t=e.trackback,n=e.id,o=e.data,a=e.renderContextType,r=e.actionDispatchers,s=e.telemetryVisitor,c=E.a(o,n);c?r.showPostErrorUI({renderContextType:a,telemetryVisitor:s,trackback:t},c.commentId):Object(i.i)().assertConditionTag(!1,"Comment not found",593875075)}function V(e){var t=e.trackback,n=e.id,o=e.data,a=e.renderContextType,r=e.actionDispatchers,s=e.telemetryVisitor,c=E.a(o,n);c?r.clearPostErrorUI({renderContextType:a,telemetryVisitor:s,trackback:t},c.commentId):Object(i.i)().assertConditionTag(!1,"Comment not found",593875076)}function F(e){var t=e.trackback,n=e.id,o=e.data,a=e.focusedComment,r=e.renderContextType,s=e.actionDispatchers,c=e.telemetryVisitor,d=e.componentTree_deprecated,u=E.a(o,n);u?A({comment:u,threads:o,focusedComment:a,warningType:y.a.LowFidelityWarningOnEdit})?s.showLowFidelityWarning({renderContextType:r,telemetryVisitor:c,trackback:i.h.reserveTag(593826120)},n,y.a.LowFidelityWarningOnEdit):s.requestEditCommentSession({renderContextType:r,telemetryVisitor:c,trackback:t},n,f.ub()?void 0:d):Object(i.i)().assertConditionTag(!1,"Comment not found",593826119)}function L(e){var t=e.trackback,n=e.id,a=e.data,r=e.focusedComment,s=e.contentPromise,c=e.atMentionsEnabled,d=e.componentTree,u=e.actionDispatchers,m=e.telemetryVisitor,p=e.localizationAPI;if(Object(y.d)(r))return Promise.resolve();var h=E.a(a,n);return h?(f.p()||Object(o.b)(p.getString(67)),u.commitCommentAndFocus({renderContextType:d.renderContextType,telemetryVisitor:m,trackback:t},(function(){return s}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},c,d).then((function(e){k({result:e,localizationAPI:p})})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,593826122):Object(i.i)().assertConditionTag(!1,"Unknown error in postOnCommit "+e,593826123)}))):(Object(i.i)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject())}function N(e){var t,n,o=e.trackback,a=e.renderableItem,r=e.focusedComment,s=e.renderContextType,c=e.dispatchProps,d=e.telemetryVisitor,u=e.componentTree_deprecated;f.P()&&c.discardDraftIfEmpty({renderContextType:f.ub()?s:(n=null===(t=u)||void 0===t?void 0:t.renderContextType,null!=n?n:O.a.None),telemetryVisitor:d,trackback:i.h.reserveTag(593237586)},p.a.SharedComments,void 0,f.ub()?void 0:u).catch((function(e){return Object(m.a)(e,i.h.reserveTag(593032901))}));var l=E.i(a);!r||r.selectedCardId!==l||Object(y.c)(r.focusDetails)&&!r.focusDetails.expanded?c.selectCommentCardExpand({renderContextType:s,telemetryVisitor:d,trackback:o},l,p.a.SharedComments):c.selectCommentPost({renderContextType:s,telemetryVisitor:d,trackback:o},l,E.e(a),p.a.SharedComments)}function U(e){var t=e.trackback,n=e.commentId,a=e.setContents,r=e.data,c=e.focusedComment,d=e.shouldClosePaneAfterDiscardDraft,u=e.onWillDiscardCallback,m=e.renderContextType,h=e.dispatchProps,C=e.telemetryVisitor,g=e.localizationAPI;f.r();var v=E.a(r,n);c&&v?(Object(o.b)(g.getString(66)),h.discardDraftAsync({renderContextType:m,telemetryVisitor:C,trackback:t},p.a.SharedComments,d,u).then((function(e){e===s.a.Handled&&v&&a&&a(v.commentBody)})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,593826127):Object(i.i)().assertConditionTag(!1,"Unknown error in postOnCancel when calling discardDraftAsync "+e,593826128)}))):Object(i.i)().assertConditionTag(!1,"Cannot find comment post to cancel '"+n+"'",593826126)}function B(e){var t=e.cardProps,n=e.componentTree,i=e.focusManager;setTimeout((function(){return i.commentCardMounted(n,t)}))}function z(e){var t=e.cardId,n=e.componentTree,i=e.focusManager;setTimeout((function(){return i.commentCardEditorMounted(n,t)}))}function H(e){var t=e.postId,n=e.componentTree,i=e.focusManager;setTimeout((function(){return i.commentPostEditorMounted(n,t)}))}function W(e){var t,n,o=e.trackback,a=e.threadId,r=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.componentTree_deprecated;!f.L()&&f.P()&&s.discardDraftIfEmpty({renderContextType:f.ub()?r:(n=null===(t=d)||void 0===t?void 0:t.renderContextType,null!=n?n:O.a.None),telemetryVisitor:c,trackback:i.h.reserveTag(593237587)},p.a.SharedComments,void 0,f.ub()?void 0:d).catch((function(e){return Object(m.a)(e,i.h.reserveTag(593032902))})),s.requestReplyCommentSession({renderContextType:r,telemetryVisitor:c,trackback:o},a,f.ub()?void 0:d)}function G(e){var t,n,o=e.trackback,a=e.commentCardRef,r=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.selectRootPost,u=e.relativeDraftingState,l=e.componentTree_deprecated,h=a.getId(),C=!!u;f.m()&&s.discardDraftIfEmpty({renderContextType:f.ub()?r:(n=null===(t=l)||void 0===t?void 0:t.renderContextType,null!=n?n:O.a.None),telemetryVisitor:c,trackback:i.h.reserveTag(593052049)},p.a.SharedComments,f.ob()&&u===b.a.InOtherCard?g.a.SelectCard:void 0,f.ub()?void 0:l).then((function(e){var t,n,o;f.ob()||(null===(t=e)||void 0===t?void 0:t.draftDiscardBehavior)===I.a.CannotAutoDiscard&&u===b.a.InOtherCard&&s.displayDraftWarning({renderContextType:f.ub()?r:(o=null===(n=l)||void 0===n?void 0:n.renderContextType,null!=o?o:O.a.None),telemetryVisitor:c,trackback:i.h.reserveTag(593052050)},v.a.ReturnToDraft,g.a.SelectCard)})).catch((function(e){return Object(m.a)(e,i.h.reserveTag(593032903))})),!d||C?s.selectCommentCardExpand({renderContextType:r,telemetryVisitor:c,trackback:o},h,p.a.SharedComments):s.selectCommentPost({renderContextType:r,telemetryVisitor:c,trackback:o},h,h,p.a.SharedComments)}function q(e){var t=e.trackback,n=e.commentCardRef,i=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.selectCommentCardCollapse({renderContextType:i,telemetryVisitor:a,trackback:t},n.getId(),p.a.SharedComments)}function Y(e){var t=e.trackback,n=e.commentCardRef,i=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;void 0!==n?o.highlightComment({renderContextType:i,telemetryVisitor:a,trackback:t},n.getId()):o.clearCommentHighlight({renderContextType:i,telemetryVisitor:a,trackback:t})}function K(e){var t=e.trackback,n=e.cardId,o=e.isCardLie,a=e.newHeight,r=e.renderContextType,s=e.focusedComment,c=e.dispatchProps,u=e.telemetryVisitor;if(r===O.a.HalfPane){if(void 0===a)return Object(i.i)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);s&&s.selectedCardId===n&&o&&Object(y.h)(s)&&c.requestDisplayConfiguration({renderContextType:r,telemetryVisitor:u,trackback:t},{displayMode:d.a.Variable,desiredHeight:a}).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,593826130):Object(i.i)().assertConditionTag(!1,"Unknown error in cardOnDraftingInputSizeChange when calling requestDisplayConfiguration "+e,593826131)}))}}function J(e){var t=e.trackback,n=e.commentCardRef,i=e.isCardLie,o=e.renderContextType,a=e.dispatchProps,r=e.telemetryVisitor;f.P()||n.draftHasContent_deprecated()||i||a.discardDraftAsync({renderContextType:o,telemetryVisitor:r,trackback:t},p.a.SharedComments,!1)}function Q(e){var t=e.trackback,n=e.id,i=e.draftState,o=e.renderContextType,r=e.dispatchProps,s=e.telemetryVisitor;if(!f.P()){var c=i.drafts[i.cardIdToDraftIdMap[n]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===a.REPLY_COMMENT_SESSION_TYPE&&r.discardDraftAsync({renderContextType:o,telemetryVisitor:s,trackback:t},p.a.SharedComments,!1)}}function Z(e){var t,n=e.trackback,r=e.focusedComment,c=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,m=e.dispatchProps,f=e.closeOnDiscard,h=e.draftId,C=e.draftState,g=e.telemetryVisitor,v=e.localizationAPI,y=e.focusHandlerRegistry,b=e.isNewCommentButtonFocusable,T=e.lieIndex,I=e.createdCommentLie,S=void 0;c&&(S=Object(j.a)(C,u,d,r,I));var O=_({componentTree:u,focusHandlerRegistry:y,isNewCommentButtonFocusable:b,threadIndex:T,discardCallback:S}),w=!!r&&!!h&&(null===(t=C.drafts[h])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===a.REPLY_COMMENT_SESSION_TYPE;Object(o.b)(v.getString(w?64:103)),m.discardDraftAsync({renderContextType:u.renderContextType,telemetryVisitor:g,trackback:n},p.a.SharedComments,f,O).then((function(e){e!==s.a.Handled||w||y.onUserAction(u,D.a.CancelNewThreadDraft,{isNewCommentButtonFocusable:b,threadIndex:T})}),(function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,592840735):Object(i.i)().assertConditionTag(!1,"Unknown error thrown from cardOnDraftingCancel: "+e,592840736)}))}function X(e,t,n,r,c,d,u,m,f,h,C,g,v,y,b,T){var I;t&&c&&n&&(I=c(n,r)),I=_({componentTree:d,focusHandlerRegistry:y,isNewCommentButtonFocusable:b,threadIndex:T,discardCallback:I});var S=!1;S=n?!!f&&!!h.drafts[f]&&h.drafts[f].commentDraft.sessionConfiguration.sessionType===a.REPLY_COMMENT_SESSION_TYPE:!!n&&!v,Object(o.b)(g.getString(S?64:103)),u.discardDraftAsync({renderContextType:d.renderContextType,telemetryVisitor:C,trackback:e},p.a.SharedComments,m,I).then((function(e){e!==s.a.Handled||S||y.onUserAction(d,D.a.CancelNewThreadDraft,{isNewCommentButtonFocusable:b,threadIndex:T})}),(function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,593826132):Object(i.i)().assertConditionTag(!1,"Unknown error thrown from cardOnDraftingCancel: "+e,593826133)}))}function $(e){var t=e.trackback,n=e.commentCardRef,a=e.focusedComment,r=e.areMentionsEnabled,s=e.session,c=e.componentTree,d=e.dispatchProps,u=e.telemetryVisitor,m=e.localizationAPI,p=e.selectedTaskAssignee;if(Object(y.d)(a))return Promise.resolve();var h=void 0;return f.b()&&p&&(h={Task:{type:"Task",assignee:p}}),f.p()||Object(o.b)(m.getString(67)),d.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:c.renderContextType},n.getContentsAsync,s,r,c,h).then((function(e){k({result:e,localizationAPI:m})})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,593826134):Object(i.i)().assertConditionTag(!1,"Unknown error in cardOnCommit "+e,593826135)}))}function ee(e){var t=e.trackback,n=e.id,i=e.renderContextType,a=e.dispatchProps,r=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(o.b)(s.getString(125)),a.requestReopenThread({renderContextType:i,telemetryVisitor:r,trackback:t},n,c)}function te(e){var t=e.trackback,n=e.id,i=e.renderContextType,a=e.dispatchProps,r=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(o.b)(s.getString(124)),a.requestResolveThread({renderContextType:i,telemetryVisitor:r,trackback:t},n,c)}function ne(e){var t=e.trackback,n=e.id,a=e.data,r=e.focusedComment,c=e.componentTree,d=e.invokeModalDialog,u=e.dispatchProps,m=e.telemetryVisitor,p=e.localizationAPI,h=e.focusHandlerRegistry,C=e.isTask,g=e.isNewCommentButtonFocusable,v=e.threadIndex,b=e.shouldCheckForLowFidelity;if(f.x()&&b){var T=E.a(a,n);if(!T)return void Object(i.i)().assertConditionTag(!1,"Comment not found",593605342);if(A({comment:T,threads:a,focusedComment:r,warningType:y.a.LowFidelityWarningOnDeleteThread}))return void u.selectCommentCardAndShowLowFidelityWarning({renderContextType:c.renderContextType,telemetryVisitor:m,trackback:i.h.reserveTag(593605343)},T.commentId,y.a.LowFidelityWarningOnDeleteThread)}if(c.renderContextType===O.a.HalfPane&&d){d(S.a.DeleteThread,(function(){return h.onUserAction(c,D.a.DeleteThread,{isNewCommentButtonFocusable:g,threadIndex:v}),function(e){var t=e.dispatchProps,n=e.componentTree,o=e.focusedComment,a=e.telemetryVisitor;if(o)return t.requestDeleteThread({renderContextType:n.renderContextType,telemetryVisitor:a,trackback:i.h.reserveTag(592840775)},o.selectedCardId),s.a.Handled;return Object(i.i)().assertConditionTag(!1,"Focused Comment should not be undefined for DeleteThread",592840776),s.a.Unhandled}({dispatchProps:u,componentTree:c,focusedComment:r,telemetryVisitor:m})}),(function(){return s.a.Canceled})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,595632546):Object(i.i)().assertConditionTag(!1,"Unknown error in cardOnDelete when calling invokeModalDialog "+e,595632547)}))}else Object(o.b)(p.getString(63)),h.onUserAction(c,D.a.DeleteThread,{isNewCommentButtonFocusable:g,threadIndex:v}),Object(x.a)(c.renderContextType)?setTimeout((function(){u.requestDeleteThread({renderContextType:c.renderContextType,telemetryVisitor:m,trackback:t},n,C)}),100):u.requestDeleteThread({renderContextType:c.renderContextType,telemetryVisitor:m,trackback:t},n,C)}function ie(e,t,n,a,r,c,d,u,m,p,h,C,g,v,b){if(f.x()&&b){var T=E.a(n,t);if(!T)return void Object(i.i)().assertConditionTag(!1,"Comment not found",592840737);if(A({comment:T,threads:n,focusedComment:a,warningType:y.a.LowFidelityWarningOnDeleteThread}))return void u.selectCommentCardAndShowLowFidelityWarning({renderContextType:r.renderContextType,telemetryVisitor:m,trackback:i.h.reserveTag(592840738)},T.commentId,y.a.LowFidelityWarningOnDeleteThread)}if(r.renderContextType===O.a.HalfPane&&c&&d){c(S.a.DeleteThread,(function(){return h.onUserAction(r,D.a.DeleteThread,{isNewCommentButtonFocusable:g,threadIndex:v}),d()}),(function(){return s.a.Canceled})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,592840739):Object(i.i)().assertConditionTag(!1,"Unknown error in cardOnDelete when calling invokeModalDialog "+e,592840768)}))}else Object(o.b)(p.getString(63)),h.onUserAction(r,D.a.DeleteThread,{isNewCommentButtonFocusable:g,threadIndex:v}),Object(x.a)(r.renderContextType)?setTimeout((function(){u.requestDeleteThread({renderContextType:r.renderContextType,telemetryVisitor:m,trackback:e},t,C)}),100):u.requestDeleteThread({renderContextType:r.renderContextType,telemetryVisitor:m,trackback:e},t,C)}function oe(e){var t=e.trackback,n=e.id,i=e.taskState,o=e.renderContextType,a=e.dispatchProps,r=e.telemetryVisitor,s=e.localizationAPI;100!==i.completion?te({trackback:t,id:n,renderContextType:o,dispatchProps:a,telemetryVisitor:r,localizationAPI:s,isTask:!0}):ee({trackback:t,id:n,renderContextType:o,dispatchProps:a,telemetryVisitor:r,localizationAPI:s,isTask:!0})}function ae(e){var t=e.failTag,n=e.successTag,o=e.person,a=e.dispatchProps,r=e.telemetryVisitor,s=e.renderContextType,d=e.trackback,l=Object(i.i)().createActivityObject("CheckUserAccess",r,i.a.None),m={UserId:Object(c.f)(o),Provider:w.b,DisplayName:Object(c.e)(o),Email:Object(c.f)(o)};a.checkUserAccess(m).then((function(e){l.addDataField(u.a.UserCanWrite,e.UserCanWrite,i.c.SystemMetadata),l.successTag(n)}),(function(e){l.failTag(t,-2130957562)})),f.N()&&a.addToCurrentMentionees({telemetryVisitor:r,trackback:d,renderContextType:s},o)}function re(e){var t=e.filter,n=e.limit,i=e.searchGraph;return e.dispatchProps.getUserContacts(t,n,i)}function se(e){var t=e.trackback,n=e.contentId,i=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,r=e.actionDispatchers,s=e.telemetryVisitor;if(f.ub()){var c=a[n];c&&r.draftEmptinessChanged({renderContextType:o,telemetryVisitor:s,trackback:t},c,i)}}function ce(e){var t=e.trackback,n=e.id,o=e.editor,a=e.renderContextType,r=e.draftIdMap,s=e.actionDispatchers,c=e.telemetryVisitor;Object(i.i)().assertConditionTag(f.cb(),"New onSaveDraft function called with corresponding FG off?",592720400);var d=r[n];d&&s.saveDraft({renderContextType:a,telemetryVisitor:c,trackback:t},d,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}function de(e,t,n,o,a,r,s){Object(i.i)().assertConditionTag(!f.cb(),"Calling deprecated onSaveDraft function in new code path?",592720401);var c=a[t.getId()];c&&r.saveDraft({renderContextType:o,telemetryVisitor:s,trackback:e},c,{editorContent:n||t.getContentsAsync(),editorCursorPosition:t.getCursorPositionAsync()})}function ue(e,t,n,i,o){i.updateCurrentMentionees_deprecated({renderContextType:n,telemetryVisitor:o,trackback:e},t)}function le(e){var t=e.trackback,n=e.emailsStillInDraft,i=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:i,telemetryVisitor:a,trackback:t},n)}function me(e){var t=e.trackback,n=e.renderContextType,i=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;i.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},a)}function fe(e){var t=e.focusState,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;if(t&&Object(y.e)(t.focusDetails.editingSession)){var r=t.selectedCardId;Object(C.E)(r,t)?o.selectCommentCardExpand({renderContextType:n,telemetryVisitor:a,trackback:i.h.reserveTag(593846659)},r,p.a.SharedComments):o.selectCommentCardCollapse({renderContextType:n,telemetryVisitor:a,trackback:i.h.reserveTag(593846660)},r,p.a.SharedComments)}else Object(i.i)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function pe(e){var t=e.focusState,n=e.onCardDelete,o=e.onPostDelete,a=e.onPostEdit;if(t)if(Object(y.c)(t.focusDetails)||f.x()&&t.focusDetails.editingSession===y.a.LowFidelityWarningOnDeleteThread){if(t.focusDetails.editingSession===y.a.LowFidelityWarningOnDeleteThread||t.focusDetails.editingSession===y.a.LowFidelityWarningOnDelete)return void n(r=t.selectedCardId);if(t.focusDetails.editingSession===y.a.LowFidelityWarningOnEdit)return void Object(i.i)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var r=t.focusDetails.selectedPostId;if(t.focusDetails.editingSession===y.a.LowFidelityWarningOnDelete)return void o(r);if(t.focusDetails.editingSession===y.a.LowFidelityWarningOnEdit)return void a(r)}else Object(i.i)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function he(e){var t,n=e.ownProps,o=e.dispatchProps,a=e.componentTree,r=e.draftState,c=e.focusedComment,d=e.createdCommentLie,m=e.invokeModalDialog;if(a.renderContextType===O.a.HalfPane||(null===(t=c)||void 0===t?void 0:t.focusDetails.editingSession)!==y.a.Active||f.t())!function(e){var t=e.dispatchProps,n=e.componentTree,o=e.telemetryVisitor,a=Object(i.i)().createActivityObject("ClosePane",o,i.a.None);a.addDataField(u.a.PaneCloseResult,T.a.NoDialog,i.c.SystemMetadata),a.successTag(592840773),t.requestClosePane({renderContextType:n.renderContextType,telemetryVisitor:o,trackback:i.h.reserveTag(592840774)})}({dispatchProps:o,componentTree:a,telemetryVisitor:n.telemetryVisitor});else{o.discardDraftAsync({renderContextType:a.renderContextType,telemetryVisitor:n.telemetryVisitor,trackback:i.h.reserveTag(592840770)},p.a.SharedComments,!0,Object(j.a)(r,a,m,c,d,S.a.ClosePaneDraft)).then((function(e){var t;e===s.a.Canceled?(t=document.getElementById(P.x()))&&t.focus():e===s.a.Unhandled&&Object(i.i)().assertConditionTag(e!==s.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch((function(e){Object(l.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,592840771):Object(i.i)().assertConditionTag(!1,"Unknown error in closePane when calling discardDraftAsync "+e,592840772)}))}}n.d(t,"K",(function(){return A})),n.d(t,"F",(function(){return R})),n.d(t,"I",(function(){return M})),n.d(t,"D",(function(){return V})),n.d(t,"G",(function(){return F})),n.d(t,"E",(function(){return L})),n.d(t,"J",(function(){return N})),n.d(t,"C",(function(){return U})),n.d(t,"l",(function(){return B})),n.d(t,"j",(function(){return z})),n.d(t,"H",(function(){return H})),n.d(t,"a",(function(){return W})),n.d(t,"p",(function(){return G})),n.d(t,"o",(function(){return q})),n.d(t,"k",(function(){return Y})),n.d(t,"g",(function(){return K})),n.d(t,"i",(function(){return J})),n.d(t,"h",(function(){return Q})),n.d(t,"e",(function(){return Z})),n.d(t,"f",(function(){return X})),n.d(t,"b",(function(){return $})),n.d(t,"m",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"c",(function(){return ne})),n.d(t,"d",(function(){return ie})),n.d(t,"q",(function(){return oe})),n.d(t,"w",(function(){return ae})),n.d(t,"t",(function(){return re})),n.d(t,"s",(function(){return se})),n.d(t,"y",(function(){return ce})),n.d(t,"z",(function(){return de})),n.d(t,"A",(function(){return ue})),n.d(t,"x",(function(){return le})),n.d(t,"B",(function(){return me})),n.d(t,"u",(function(){return fe})),n.d(t,"v",(function(){return pe})),n.d(t,"r",(function(){return he}))},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));n(118);var i=n(65),o=n(38);function a(e){switch(e){case o.a.ClosePaneButton:return i.l();case o.a.NextCommentButton:return i.D();case o.a.PreviousCommentButton:return i.K();case o.a.GhostCard:return i.z();case o.a.NewCommentButton:return i.C();case o.a.PaneRoot:return i.x()}}function r(e){switch(e.componentType){case o.a.Card:return i.h(e,!1);case o.a.DraftCard:return i.h(e,!0);case o.a.PostEditor:return i.u(i.E(e));case o.a.CardEditor:return i.u(i.e(e));case o.a.Post:return i.H(e);case o.a.DiscreteHostedCommentRoot:return i.q(e)}}function s(e,t){return!1===e?o.a.Card:!0===e||t&&t.newComment.commentId===e?o.a.DraftCard:o.a.Card}},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(i||(i={})),t.b=i},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost"}(i||(i={}))},function(e,t,n){"use strict";var i;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(i||(i={})),t.a=i},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(579);Object.defineProperty(t,"RekaInstance",{enumerable:!0,get:function(){return i.RekaInstance}});var o=n(579);Object.defineProperty(t,"DataServiceManager",{enumerable:!0,get:function(){return o.RekaInstance}});var a=n(581);Object.defineProperty(t,"CustomTypeRegistry",{enumerable:!0,get:function(){return a.CustomTypeRegistry}});var r=n(580);Object.defineProperty(t,"RekaServiceRegistry",{enumerable:!0,get:function(){return r.RekaServiceRegistry}}),Object.defineProperty(t,"registerClasses",{enumerable:!0,get:function(){return r.registerClasses}});var s=n(580);Object.defineProperty(t,"DataServiceRegistry",{enumerable:!0,get:function(){return s.RekaServiceRegistry}});var c=n(254);Object.defineProperty(t,"EventImpl",{enumerable:!0,get:function(){return c.EventImpl}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return C}));var i=n(3),o=n(102),a=n(376),r=n(768),s=n(470),c=n(165),d=n(253),u=n(23),l=n(20),m=n(8),f=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField(u.a.InstanceCorrelationId,n.correlationId,i.c.SystemMetadata)}};function p(e){return new f(h(e),e.correlationId)}var h=function(){throw new Error("ViewManagerFactory not set")};function C(e){h=e}var g=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this,n=this.instanceMap.get(e);return n||{visit:function(n){var o=t.instanceMap.get(e);if(!o)return n.attachContext(e),void n.addDataField(u.a.MissingInstanceTelemetry,!0,i.c.SystemMetadata);o.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,i=e.contentNavigationAPI;this.initialized||this.ensureInitialized();var o=this.instanceMap.get(t);return o?this.updateInstanceObject(o,n):(this.initializeContentNavigationAPI(t,i),o=p(e),this.instanceMap.set(t,o)),o.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new l.a("Instance is not initialized",-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new l.a("Instance is not initialized",-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;m.A()&&a.a.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),a.a.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(o.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var o=this.instanceMap.get(e);if(o)o.correlationId=t;else{var a=void 0;n&&m.t()&&(Object(i.i)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),i.a.None).successTag(592511450),a=new r.a(e)),this.instanceMap.set(e,p({apiContext:e,correlationId:t,initializationReason:d.a.PaneOpen,displayMode:c.b.FullPane,foldableLayoutState:s.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:a}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){Object(o.g)(e)||Object(o.h)(t||new o.b(e),e)},e}());t.a=g},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(i||(i={}))},,,,,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var i,o=n(3),a=n(20);function r(e){if(i)throw Object(o.i)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",595857875),new a.a("WebAppColors cannot be re-initialized.",-2130957508);i=e}function s(){if(!i)throw Object(o.i)().assertConditionTag(!1,"WebAppColors is not initialized",595857876),new a.a("WebAppColors is not initialized",-2130957509);return i}},function(e,t,n){"use strict";function i(e){return void 0!==e.sessionConfiguration&&void 0!==e.author&&void 0!==e.insertIndex&&"function"==typeof e.commit&&"function"==typeof e.endDrafting}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";var i,o=n(298),a=n(469),r=n(80);!function(e){e[e.FailedToCommit=0]="FailedToCommit"}(i||(i={}));var s,c=n(109),d=n(188),u=n(103),l=n(129);!function(e){e[e.Unknown=0]="Unknown",e[e.UserAction=1]="UserAction",e[e.Suspend=2]="Suspend"}(s||(s={}));var m=n(83);n(146);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"e",(function(){return d.a})),n.d(t,"i",(function(){return u.d})),n.d(t,"h",(function(){return u.c})),n.d(t,"f",(function(){return l.a})),n.d(t,"g",(function(){return m.a}))},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r}));var i=new(n(553).a);function o(e){i.init(e)}function a(){return i}function r(e){return!0}},,function(e,t,n){"use strict";var i;function o(e){var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n(3),o=n(84),a=n(209),r=n(103),s=n(104),c=n(190),d=n(106),u=n(122),l=n(16),m=n(23),f=n(317),p=n(20),h=n(142),C=n(78),g=n(154),v=n(8),y=n(19),b=n(134),T=n(12),I=n(10),S=n(44),O=n(15),D=n(30),w=n(320),j=n(407),P=n(256),x=n(270),E=n(485),A=n(301),k=n(305);function _(e,t,n,_,R,M,V){return function(F,L){var N=L(),U=Object(i.i)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,i.a.None),B=s.b[n.sessionType],z=e.renderContextType!==l.a.None||!S.b(N)&&v.t()?e.renderContextType:S.c(N).renderContextType;return U.addDataField(m.a.SessionType,B,i.c.SystemMetadata),U.addDataField(m.a.Trackback,e.trackback,i.c.SystemMetadata),U.addDataField(m.a.RenderContextType,z,i.c.SystemMetadata),U.addDataField(m.a.IsPaneVisible,S.b(N),i.c.SystemMetadata),v.b()||n.sessionType!==r.c?(Object(y.e)(I.n(N),I.a(N))===o.b.Enabled&&Object(f.a)().catch((function(e){Object(p.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,591397600):Object(i.i)().assertConditionTag(!1,"Unknown error in beginDraftingThunk "+e,591397601)})),(v.L()?F(Object(A.a)(e,D.a.SharedComments,v.ob()?s.c(n):void 0,v.ub()?void 0:V)):Promise.resolve({draftDiscardResult:o.f.Handled,draftDiscardBehavior:u.a.CannotAutoDiscard})).catch((function(e){return Object(g.a)(e,i.h.reserveTag(591397602)),{draftDiscardResult:o.f.Unhandled,draftDiscardBehavior:u.a.CannotAutoDiscard}})).then((function(o){v.L()&&U.addDataField(m.a.DraftDiscardBehavior,o.draftDiscardBehavior,i.c.SystemMetadata);var r=L(),u=I.j(r);if(!v.ob()&&u&&Object(T.h)(u)&&v.K())return U.addDataField(m.a.SessionAlreadyRequested,!0,i.c.SystemMetadata),U.successTag(591397603),Promise.resolve(F(Object(P.a)({draftWarningType:b.a.ReturnToDraft,draftWarningReason:s.c(n)},Object(O.a)(e,i.h.reserveTag(591397632)))));if(u&&Object(T.i)(u.focusDetails)||I.g(r)&&s.d(n)||Object(y.A)(I.i(r)))return U.addDataField(m.a.SessionAlreadyRequested,!0,i.c.SystemMetadata),U.successTag(591397633),Promise.resolve(F(x.a));if(U.addDataField(m.a.SessionAlreadyRequested,!1,i.c.SystemMetadata),F(Object(E.a)(Object(O.a)(e,i.h.reserveTag(591397634)),n,_)),!Object(a.c)(t))throw new p.a("Unsupported CommentAPI.",-2130957510);return t.beginDraftingAsync(n).then((function(t){var o=Object(c.a)(t)?t.sessionConfiguration:t.updatedSessionParams?function(e,t){if(e.sessionType!==t.sessionType){if(!s.d(e))return void Object(i.i)().assertConditionTag(!1,"Invalid session conversion",591397645);if(!(s.d(t)||s.e(t)||s.f(t)))return void Object(i.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit",591397646)}switch(t.sessionType){case"CREATE":case"EDIT":case"REPLY":return t;default:return}}(n,t.updatedSessionParams):n;if(void 0===o)throw new p.a(C.f,-2130957532);s.d(n)&&v.S()&&F(Object(k.a)(Object(O.a)(e,i.h.reserveTag(591397635)),[],[],R,Object(c.a)(t)?Object(d.g)(t.author):Object(d.g)(Object(d.c)(t))));var a=Object(c.a)(t)?t:o;return M?M().then((function(){return U.successTag(591397636),F(Object(j.a)(Object(O.a)(e,i.h.reserveTag(591397637)),a,z))})).catch((function(t){return U.failTag(591397638,Object(h.a)(t)),Object(c.a)(a)&&a.endDrafting(),F(Object(w.a)(Object(O.a)(e,i.h.reserveTag(591397639)),n,t))})):(U.successTag(591397640),F(Object(j.a)(Object(O.a)(e,i.h.reserveTag(591397641)),a,z)))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?U.successTag(591397643):U.failTag(591397642,Object(h.a)(t)),F(Object(w.a)(Object(O.a)(e,i.h.reserveTag(591397644)),n,t))}))}))):(U.failTag(591397599,-2130957513),Promise.resolve(F(x.a)))}}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(i||(i={}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r}));var i="SharedCommentPane",o="DiscreteIntegratedCommentCard",a="DiscreteIsolatedCommentCard";function r(e,t){return e+"-"+t}},,,,,,,,,,function(e,t,n){"use strict";var i,o=n(0),a=n(254);!function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(i||(i={}));var r,s=function(){function e(){this.onComponentStateChanged=new a.EventImpl((function(){})),this.onComponentCommand=new a.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.onComponentStateChanged.trigger({componentName:e,state:i.Registered}),t},e.prototype.unregisterComponent=function(e){this.onComponentStateChanged.trigger({componentName:e,state:i.Unregistered})},e}();function c(){return void 0===r&&(r=new s).initialize(),r}var d=n(175),u=function(e){var t=this;this.componentName=e,this.onComponentCommand=new d.EventImpl((function(){})),c().onComponentCommand.subscribe((function(e){e.payload.componentKey===t.componentName&&t.onComponentCommand.trigger(e)}))},l=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new d.EventImpl((function(){})),c().onComponentStateChanged.subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!0,configurable:!0}),e}(),m=function(){function e(){this.componentMap={}}return e.prototype.registerComponent=function(e,t){var n=c().registerComponent(e,t);return this.componentMap[e]=n,new u(e)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],c().unregisterComponent(e)},e.prototype.getComponent=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return[2,new l(e,this)]}))}))},e}(),f=window;function p(){return void 0===f.ComponentRegistryAdapter&&(f.ComponentRegistryAdapter=new m),f.ComponentRegistryAdapter}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled"}(i||(i={}))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(i||(i={})),t.a=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventImpl=void 0;var i=function(){function e(e){this.event=e}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}(),o=function(){function e(e){this.listenerUpdate=e,this.handlers=new Map,this.hasListener=!1}return e.prototype.subscribe=function(e){var t=new i(this);return this.handlers.set(t,e),this.hasListener||this.sendUpdate(!0),t},e.prototype.unsubscribe=function(e){this.handlers.delete(e),this.hasListener&&0===this.handlers.size&&this.sendUpdate(!1)},e.prototype.unsubscribeAll=function(){this.handlers.clear(),this.hasListener&&this.sendUpdate(!1)},e.prototype.trigger=function(e){this.handlers.forEach((function(t,n){return t(e,n)}))},e.prototype.sendUpdate=function(e){this.hasListener=e,this.listenerUpdate(e)},e}();t.EventImpl=o},function(e,t,n){"use strict";var i;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(i||(i={})),t.a=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.DisplayDraftWarningType,e,t)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n(103);function o(e){return e.sessionType===i.a}function a(e){return e.sessionType===i.d&&void 0!==e.threadId}function r(e){return e.sessionType===i.b&&void 0!==e.commentId}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.CommitFailureType,{},e)}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(3),o=n(16),a=n(15),r=n(7);var s,c=(s={renderContextType:o.a.None,telemetryVisitor:Object(i.j)(i.g.ReviewedAsNotNecessary),trackback:i.h.reserveTag(595735680)},Object(a.b)(r.a.EmptyActionType,{},s))},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees_deprecated:e.currentMentionees_deprecated,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee}}function o(e){return Object.keys(e.drafts)}function a(e){return o(e).length}function r(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{}}}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r}))},,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i=function(e){return e.taskState},o=function(e){return e.taskState.tasks}},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n(3),o=n(83),a=n(122),r=n(23),s=n(8),c=n(304),d=n(134),u=n(12),l=n(10),m=n(44),f=n(15),p=n(256),h=n(538);function C(e,t,n,C){return function(g,v){var y,b=v(),T=Object(i.i)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,i.a.None),I=Object(u.d)(l.j(b));if(T.addDataField(r.a.Trackback,e.trackback,i.c.SystemMetadata),T.addDataField(r.a.RenderContextType,e.renderContextType,i.c.SystemMetadata),T.addDataField(r.a.CommitPendingAttemptedCancel,I,i.c.SystemMetadata),T.addDataField(r.a.ActionSource,t,i.c.SystemMetadata),!s.ub()&&s.w()&&!C)return Promise.resolve({draftDiscardResult:o.a.Canceled,draftDiscardBehavior:a.a.NoDraft});var S=s.ub()?Object(c.a)(l.i(b),l.j(b)):Object(c.b)(null!=C?C:m.c(b),l.i(b),l.j(b),null===(y=l.g(b))||void 0===y?void 0:y.draftId,e.telemetryVisitor);return S===a.a.CanAutoDiscard?g(Object(h.a)(e,t,!1)).then((function(e){return{draftDiscardResult:e,draftDiscardBehavior:S}})):(void 0!==n&&S===a.a.CannotAutoDiscard&&g(Object(p.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(f.a)(e,i.h.reserveTag(591728722)))),Promise.resolve({draftDiscardResult:s.w()?o.a.Canceled:o.a.Handled,draftDiscardBehavior:S}))}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var i=n(8),o=n(304),a=n(122),r=n(16),s=n(670),c=function(e,t,n,i,o){var a;return!!e&&!((null===(a=n)||void 0===a?void 0:a.selectedCardId)!==d(i)||t!==r.a.HalfPane||void 0!==o)},d=function(e){return e&&e.draftId},u=function(e,t,n,r,c,d){var u;if(r&&n&&(i.ub()?Object(o.a)(e,r):Object(o.b)(t,e,r,null===(u=c)||void 0===u?void 0:u.draftId))===a.a.CannotAutoDiscard){var l=d||Object(s.a)(e,t.renderContextType,r);return function(e,t){return n(l,e,t)}}}},,function(e,t,n){"use strict";var i=n(3),o=n(118),a=n(84),r=n(122),s=n(132),c=n(162),d=n(140);var u=n(23),l=n(8),m=n(12),f=n(19);function p(e,t,n,f,p){return void 0!==n&&Object(m.h)(n)?function(e,t,n,a,r){if(l.s()&&Object(d.a)()===s.a.Web)return!1;var m=Object(i.i)().createActivityObject("IsEmptyDraft",null!=r?r:Object(i.j)(i.g.GlobalAPI),i.a.OnSuccess);if(m.addDataField(u.a.RenderContextType,e.renderContextType,i.c.SystemMetadata),!n)return m.successTag(593512069),!1;var f=t.drafts[t.cardIdToDraftIdMap[n.selectedCardId]];if(!f||!f.isInCurrentContext||l.wb()&&f.renderContextType!==e.renderContextType)return m.successTag(593512070),!1;var p=e.getComponentById({componentType:Object(c.b)(n.selectedCardId===a),id:n.selectedCardId,renderContextType:e.renderContextType}),h=void 0;Object(o.e)(p)&&(h=p.getData());if(!h)return m.failTag(593598100,-2130957496),!1;return m.successTag(593512071),!(void 0===h||!function(e){return void 0!==e&&void 0!==e.getId&&void 0!==e.getContentsAsync&&void 0!==e.getCursorPositionAsync&&void 0!==e.draftHasContent_deprecated}(h)||h.draftHasContent_deprecated())}(e,t,n,f,p)&&!Object(m.g)(n.focusDetails)&&function(e,t){if(!t||!e.drafts[t])return!0;var n=e.drafts[t].commentDraft.sessionConfiguration;return!Object(a.i)(n)}(t,f)?r.a.CanAutoDiscard:r.a.CannotAutoDiscard:r.a.NoDraft}function h(e,t){if(void 0===t||!Object(m.h)(t))return r.a.NoDraft;if(!function(e,t){var n;if(!t)return!1;var i=e.drafts[e.cardIdToDraftIdMap[t.selectedCardId]];return!!(null===(n=i)||void 0===n?void 0:n.isDraftEmpty)}(e,t)||Object(m.g)(t.focusDetails))return r.a.CannotAutoDiscard;var n=Object(f.B)(e);return n&&Object(a.i)(n.commentDraft.sessionConfiguration)?r.a.CannotAutoDiscard:r.a.CanAutoDiscard}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}))},function(e,t,n){"use strict";var i=n(3),o=n(20),a=n(0),r=n(106),s=n(36);function c(e,t,n){void 0!==t[e]||n.has(e)||n.add(e)}function d(e){var t,n,i={};try{for(var o=Object(a.__values)(e),r=o.next();!r.done;r=o.next()){var s=r.value;i[s.authorName]=s}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}var u=n(10),l=n(409);function m(e,t,n,a,m){return function(f,p){var h=function(e,t,n,i){var o=new Set;e.forEach((function(e){return c(Object(r.g)(e.author),n,o)})),t&&t.forEach((function(e){return e.history.forEach((function(e){return c(Object(r.g)(e.records[0].user),n,o)}))})),i&&c(i,n,o);var a=[];return o.forEach((function(e){return a.push({UserId:"",Provider:"",DisplayName:e})})),a}(t,n,u.p(p()),m);if(a.getPersonaIconPropertiesArray)a.getPersonaIconPropertiesArray(h).then((function(t){f(Object(l.a)(e,d(t)))})).catch((function(e){Object(o.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,595645964):Object(i.i)().assertConditionTag(!1,"Unknown error in loadPersonaIconPropertiesThunk "+e,595645965)}));else{var C=function(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorId:"",authorColor:s.a.COMMENTS_PURPLE,authorImageURL:""})})),t}(h);f(Object(l.a)(e,d(C)))}return Promise.resolve()}}n.d(t,"a",(function(){return m}))},,function(e,t,n){"use strict";var i=n(65),o=n(162),a=n(38),r=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t},s=function(){function e(e,t,n){this.renderContextType=e,this.contextIdentifier=t}return e.prototype.getComponent=function(t){return e.domGetElementById(Object(o.c)(t))},e.prototype.getComponentById=function(t){return e.domGetElementById(Object(o.a)(t))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(t){var n=e.getActiveElement(t);return e.hasFocus(n)},e.prototype.isFocusWithin=function(t){var n=e.getActiveElement(t);return e.containsFocus(n)},e.prototype.isFocusWithinAny=function(t){var n=void 0;switch(t){case a.a.Card:n=r(document.querySelectorAll("[id*='"+i.h({id:"",renderContextType:this.renderContextType},!1)+"']"));break;case a.a.DraftCard:n=r(document.querySelectorAll("[id*='"+i.h({id:"",renderContextType:this.renderContextType},!0)+"']"));break;case a.a.PostEditor:n=r(document.querySelectorAll("[id*='"+i.u(i.E({id:"",renderContextType:this.renderContextType}))+"']"));break;case a.a.CardEditor:n=r(document.querySelectorAll("[id*='"+i.u(i.e({id:"",renderContextType:this.renderContextType}))+"']"));break;case a.a.Post:n=r(document.querySelectorAll("[id*='"+i.H({id:"",renderContextType:this.renderContextType})+"']"))}if(n)for(var o=0;o<n.length;++o){var s=n[o];if(e.containsFocus(s))return!0}return!1},e.prototype.isFocusWithinPane=function(){var t=document.getElementById(i.x());return e.containsFocus(t)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e.getActiveElement=function(t){var n;return Object(a.c)(t)?n=e.domGetElementById(Object(o.a)(t)):t.componentType!==a.a.Unknown&&(n=e.domGetElementById(Object(o.c)(t.componentType))),n},e.hasFocus=function(e){var t=document.activeElement;return!!e&&t===e},e.containsFocus=function(e){var t=document.activeElement;return!!e&&(t&&e.contains(t)||t===document.body||null===t||0===Object.keys(t).length)},e.domGetElementById=function(e){return document.getElementById(e)||void 0},e}();t.a=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i,o,a,r=n(182),s=Object(r.a)({from:{opacity:0},to:{opacity:1}}),c=Object(r.a)({from:{opacity:1},to:{opacity:0}}),d=Object(r.a)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),u=Object(r.a)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),l=Object(r.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),m=Object(r.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),f=Object(r.a)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),p=Object(r.a)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),h=Object(r.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),C=Object(r.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),g=Object(r.a)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),v=Object(r.a)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function y(e,t,n){return e+" "+t+" "+n}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(i||(i={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(o||(o={})),function(e){e.fadeIn=y(s,i.duration1,o.linear),e.fadeOut=y(c,i.duration1,o.linear),e.scaleDownIn=y(d,i.duration3,o.decelerate),e.scaleDownOut=y(u,i.duration3,o.decelerate),e.slideLeftOut=y(l,i.duration1,o.accelerate),e.slideRightOut=y(m,i.duration1,o.accelerate),e.slideLeftIn=y(f,i.duration1,o.decelerate),e.slideRightIn=y(p,i.duration1,o.decelerate),e.slideUpOut=y(h,i.duration1,o.accelerate),e.slideDownOut=y(C,i.duration1,o.accelerate),e.slideUpIn=y(g,i.duration1,o.decelerate),e.slideDownIn=y(v,i.duration1,o.decelerate)}(a||(a={}))},,,function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var i=n(3),o=n(23),a=n(20),r=!1;function s(){return Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,1328)).then((function(e){return e})).catch((function(e){}))}function c(){var e;return r||(e=Object(i.i)().createActivityObject("AtMentionLazyLoad",Object(i.j)(i.g.GlobalAPI),i.a.None),r=!0),Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,1329)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e.failTag(595895121,-2130957515),r=!1}))}function d(e){var t,r=Object(i.i)().createActivityObject("SharedCommentsUILazyLoad",Object(i.j)(i.g.GlobalAPI),i.a.None);switch(r.addDataField(o.a.ContainerName,e,i.c.SystemMetadata),e){case"CommentPaneContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(18)]).then(n.bind(null,1279))}),r);break;case"CommentHost":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(18)]).then(n.bind(null,1333))}),r);break;case"HostableCommentCardRendererContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(18)]).then(n.bind(null,1335))}),r);break;default:return r.failTag(595731076,-2130957503),Promise.reject(new a.a("Invalid container name",-2130957503))}return t.then((function(e){return r.successTag(595731075),e}),(function(e){r.failTag(595734544,-2130957504)}))}function u(e,t,n){void 0===n&&(n=3);return new Promise((function(a,r){e().then((function(e){t.addDataField(o.a.DelayLoadRetryCount,n,i.c.SystemMetadata),a(e)}),(function(i){setTimeout((function(){1!==n?u(e,t,n-1).then(a,r):r(i)}),500)}))}))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.BeginDraftingFailureType,{beginDraftingParams:t,errorInfo:n},e)}},,,function(e,t,n){"use strict";var i=n(344);n.d(t,"a",(function(){return i.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(165);function o(e){return e.containerType===i.b.HalfPane}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.ResolveAtMentionCapabilityType,{capability:t,authToken:n},e)}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=function(e){var t=Math.floor(255&e).toString(16);return(t.length<2?"0":"")+t},o=function(){var e,t="object"==typeof window&&window.crypto;if(t){var n=new Uint8Array(16);t.getRandomValues(n),e=Array.from(n)}else{e=[];for(var o=0;o<16;o++)e.push(Math.floor(256*Math.random()))}var a=e.map(i);return[a.slice(0,4),a.slice(4,6),a.slice(6,8),a.slice(8,10),a.slice(10)].map((function(e){return e.join("")})).join("-")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var i=n(103),o=n(8),a=n(19),r=JSON.stringify({ops:[{insert:""}]}),s={UserId:"",Provider:"",DisplayName:""};function c(e){var t,n=e.newComment.commentBody;return{commentBody:void 0!==n?n:r,commentId:e.newComment.commentId||"",author:(t=e.newComment.author,null!=t?t:s),parentId:"",commentFlags:0,date:e.newComment.date||new Date,anchorHintText:e.newComment.anchorHintText?e.newComment.anchorHintText:void 0}}function d(e,t){if(!o.t())return!1;var n=Object(a.B)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===i.a}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(191),o=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.e.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.e.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(75);function o(e){return!e.pendingCommentLoad||e.pendingCommentLoad.numberOfComments===e.commentData.length||!!e.virtualized&&(0!==e.commentData.length&&(void 0===e.pendingCommentLoad.selectedThreadIndex||e.pendingCommentLoad.selectedThreadIndex>=e.pendingCommentLoad.numberOfThreads||e.pendingCommentLoad.selectedThreadIndex<e.commentData.filter(i.a).length))}},,,,function(e,t,n){"use strict";var i=n(3),o=n(20),a=n(78),r=n(0),s=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,appLocale:this.localizationDetails.appLocale||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new o.a(a.l,-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 24:return CommentPaneStrings.NewPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 33:return CommentPaneStrings.EditorA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 38:return CommentPaneStrings.PostSaveA11yLabel;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 49:return CommentPaneStrings.CardSendReplyA11yLabel;case 83:return CommentPaneStrings.CardPostCommentA11yLabel;case 50:return CommentPaneStrings.ReplyBoxContainerA11yLabel;case 55:return CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.SavedCommentA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 90:return CommentPaneStrings.NewCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 109:return CommentPaneStrings.FinishEditingCommentText;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 162:return CommentPaneStrings.DraftCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(!1,Object(r.__spread)([this.getString(e)],t))},e.prototype.toFormattedString=function(e,t){for(var n="",i=t[0],o=0;;){var a=i.indexOf("{",o),r=i.indexOf("}",o);if(a<0&&r<0){n+=i.slice(o);break}if(r>0&&(r<a||a<0))n+=i.slice(o,r+1),o=r+2;else if(n+=i.slice(o,a),o=a+1,"{"!==i.charAt(o)){if(r<0)break;var s=i.substring(o,r),c=s.indexOf(":"),d=parseInt(c<0?s:s.substring(0,c),10)+1,u=c<0?"":s.substring(c+1),l=t[d];null==l&&(l=""),n+=l.toFormattedString?l.toFormattedString(u):e&&l.localeFormat?l.localeFormat(u):l.format?l.format(u):l.toString(),o=r+1}else n+="{",o++}return n},e}();n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var c=void 0;function d(){if(!c)throw new o.a(a.j,-2130957552);return c}function u(e){return Object(i.i)().assertConditionTag(void 0===c,"LocalizationAPI has already been initialized",595870274),void 0===c&&(c=new s(e)),c}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(165),o=n(16);function a(e){switch(e){case i.b.HalfPane:return o.a.HalfPane;case i.b.FullPane:default:return o.a.FullPane}}},function(e,t,n){"use strict";function i(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return i}))},,,,,function(e,t,n){"use strict";var i,o=n(0),a=n(3),r=n(227),s=n(154),c=n(8),d=n(14),u=n(30),l=n(212),m=n(55),f=n(103),p=n(104);!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(i||(i={}));var h=n(166),C=function(){function e(e){this.rawDelta=e,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t,i;if(null===(t=e)||void 0===t?void 0:t.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var o=e.attributes.atmention,a=e.optional;!o||void 0!==a&&void 0!==a.atmention||null===(i=n._users)||void 0===i||i.push({UserId:o.email,Provider:h.b})}}))},e}(),g=n(23),v=n(20),y=n(142),b=n(358),T=n(169),I=n(19),S=n(135),O=n(134),D=n(12),w=n(10),j=n(473),P=n(260),x=n(256);function E(e,t,n,o,r,s){return function(u,l){var h,v,y=Object(a.i)().createActivityObject("CommitComment",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent);y.addDocumentMetadata(a.e.Basic);var b=p.b[r.type],E=l(),k=l().taskState,_=Object(I.A)(w.i(E));if(void 0===_||_.sessionConfiguration.sessionType!==r.type)return y.failTag(593278784,-2130957522),Promise.resolve(T.a.CommitFailed);var R="",M=!1;switch(r.type){case f.b:R=r.commentId;break;case f.d:R=r.parentId,M=!0;break;case f.a:_&&(R=_.sessionConfiguration.draftId||"")}var V=w.j(E),F=!M||!!V&&(!Object(D.c)(V.focusDetails)||(null===(h=V)||void 0===h?void 0:h.focusDetails.expanded));if(y.addDataField(g.a.IsCardExpanded,F,a.c.SystemMetadata),(c.b()&&r.type===f.a||c.c()&&r.type===f.d)&&(y.addDataField(g.a.IsPreExistingTask,!!k.tasks[R],a.c.SystemMetadata,a.d.Critical),y.addDataField(g.a.AffectingTaskMetadata,!!(null===(v=s)||void 0===v?void 0:v.Task),a.c.SystemMetadata,a.d.Critical)),y.addDataField(g.a.SessionType,b,a.c.SystemMetadata),r.type!==f.a){var L=Object(I.d)(w.e(E),R);L.valid&&(y.addDataField(g.a.MatchesCommentAuthor,L.matchesCurrentUser,a.c.SystemMetadata),y.addDataField(g.a.CommentCreationTimeDeltaMs,L.timeElapsed,a.c.SystemMetadata))}return y.addDataField(g.a.AssociatedCommentId,R,a.c.SystemMetadata),y.addDataField(g.a.AtMentionsEnabled,n,a.c.SystemMetadata),y.addDataField(g.a.Trackback,e.trackback,a.c.SystemMetadata),y.addDataField(g.a.RenderContextType,e.renderContextType,a.c.SystemMetadata),Object(D.d)(V)?Promise.resolve(T.a.CommitPending):(u(Object(j.a)(d.j(e,a.h.reserveTag(593278785)))),o().then((function(o){if(!n){var l=A(u,r,o,0,y,a.h.reserveTag(593278786),a.h.reserveTag(593278787),e,s);return Promise.resolve(l)}var f=new C(o),p=f.Mentions;y.addDataField(g.a.NumberOfMentionsAdded,p.length,a.c.SystemMetadata);var h=Object(a.i)();if(c.g()&&p.length>0&&h.logFloodgateActivity&&h.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),y.addDataField(g.a.NumberOfHyperlinks,f.NumHyperlinks,a.c.SystemMetadata),!p.length){l=A(u,r,o,0,y,a.h.reserveTag(593278788),a.h.reserveTag(593278789),e,s);return Promise.resolve(l)}return t.grantUsersAccess(p).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===i.Success}(t),c=function(e){return!!e.Details&&e.Details.Canceled}(t);if(y.addDataField(g.a.AllUsersGrantedAccess,n,a.c.SystemMetadata),y.addDataField(g.a.ShareDialogCanceled,c,a.c.SystemMetadata),t.OperationResult===i.FailedSilently)return Object(m.e)("Check Access Phase failed - share dialog not shown"),y.failTag(593278790,-2130957561),u(Object(P.a)(d.j(e,a.h.reserveTag(593278791)))),u(Object(x.a)({draftWarningType:O.a.GrantAccessFailedSilently,draftWarningReason:S.a.GrantUsersAccessFailure},d.j(e,a.h.reserveTag(593278792)))),Promise.resolve(T.a.ShareFailed);if(c)return Object(m.e)("Share dialog was canceled by user"),y.successTag(593278793),u(Object(P.a)(d.j(e,a.h.reserveTag(593278794)))),Promise.resolve(T.a.ShareFailed);if(!n)return Object(m.e)("Not all users have been granted access - going back to initial state"),y.successTag(593278795),u(Object(P.a)(d.j(e,a.h.reserveTag(593278796)))),Promise.resolve(T.a.ShareFailed);var l=A(u,r,o,p.length,y,a.h.reserveTag(593278797),a.h.reserveTag(593278798),e,s);return Promise.resolve(l)}),(function(t){return y.failTag(593278799,-2130957561),Object(m.e)("Grant Users Access has failed",t),u(Object(P.a)(d.j(e,a.h.reserveTag(593278800)))),Promise.resolve(T.a.ShareFailed)}))}),(function(t){return y.failTag(593278801,-2130957539),u(Object(P.a)(d.j(e,a.h.reserveTag(593278802)))),Object(m.e)("getCommentBody failed",t),c.p()&&u(Object(x.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:O.a.CommitFailed},d.j(e,a.h.reserveTag(593278803)))),Promise.resolve(T.a.CommitFailed)})))}}function A(e,t,n,i,o,r,s,u,l){var m=function(e,t,n,i,o){try{switch(t.type){case"CREATE":e(d.p(d.j(i,a.h.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:o}));break;case"EDIT":e(d.p(d.j(i,a.h.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(d.p(d.j(i,a.h.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:o}));break;default:return Object(a.i)().assertConditionTag(!1,"Unexpected session type '"+t.type+"'",593278807),e(Object(P.a)(d.j(i,a.h.reserveTag(593278808)))),-2130957532}}catch(t){if(!Object(v.b)(t)&&!Object(b.a)(t))throw t;return e(Object(P.a)(d.j(i,a.h.reserveTag(593278809)))),c.p()&&e(Object(x.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:O.a.CommitFailed},d.j(i,a.h.reserveTag(593278810)))),Object(y.a)(t)}return}(e,t,n,u,l);return m?(o.failTag(s,m),T.a.CommitFailed):i?(t.type===f.a?(o.addDataField(g.a.CreateThreadWithMentions,!0,a.c.SystemMetadata,a.d.Critical),l&&l.Task&&o.addDataField(g.a.CreateThreadWithTaskAssigned,!0,a.c.SystemMetadata,a.d.Critical)):t.type===f.d&&(o.addDataField(g.a.CreateReplyWithMentions,!0,a.c.SystemMetadata,a.d.Critical),l&&l.Task&&o.addDataField(g.a.CreateReplyWithTaskAssigned,!0,a.c.SystemMetadata,a.d.Critical)),o.successTag(r),T.a.Success):(o.successTag(r),T.a.Success)}var k=n(539),_=n(301),R=n(538),M=n(211),V=n(253),F=n(16),L=n(475),N=n(408),U=n(484);function B(e,t){return function(n){var i=Object(U.a)(e,t);return n(i),i.payload.completion||Promise.reject(new v.a("requestDisplayConfiguration was not provided a completion from middleware.",-2130957557))}}var z=n(97),H=n(486);var W=n(373);function G(e,t){return{requestDeleteComment:function(t,n){e(d.C(t,n))},requestDeleteThread:function(t,n,i){e(d.D(t,n,i))},selectCommentCardExpand:function(t,n,i){e(d.J(t,n,void 0,d.c.ExpandCard,i))},selectCommentCardCollapse:function(t,n,i){e(d.J(t,n,void 0,d.c.CollapseCard,i))},selectCommentPost:function(t,n,i,o){e(d.J(t,n,i,d.c.SelectPost,o))},requestReopenThread:function(t,n,i){e(d.F(t,n,i))},requestResolveThread:function(t,n,i){e(d.H(t,n,i))},requestEditCommentSession:function(n,i,o){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"EDIT",commentId:i},!1,n,d.j(n,a.h.reserveTag(593265930)),c.ub()?void 0:o)},requestReplyCommentSession:function(n,i,o){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"REPLY",threadId:i},!1,n,d.j(n,a.h.reserveTag(593265931)),c.ub()?void 0:o)},commitCommentAndFocus:function(n,i,o,a,r,s){return e(E(n,t.peopleAPI,a,i,o,s)).then((function(e){return e===T.a.ShareFailed&&t.focusManager.focusActiveEditor(o,r),e}))},discardDraftAsync:function(t,n,i,o){return e(Object(R.a)(t,n,i,o))},discardDraftIfEmpty:function(t,n,i,o){return e(Object(_.a)(t,n,i,c.ub()?void 0:o))},showLowFidelityWarning:function(t,n,i){e(d.N(t,n,i))},saveDraft:function(t,n,i){e(d.I(t,{draftId:n,draftContent:i}))},clearCommentHighlight:function(t){e(d.k(t,u.a.SharedComments))},getUserContacts:function(e,n,i){return t.peopleAPI.capabilities&r.a.GetContactsForMentions?t.peopleAPI.getContactsForMentions(e,n,i):(Object(a.i)().assertConditionTag(!1,"Attempted to retrieve contacts on API without capability.",593265932),Promise.resolve([]))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateCurrentMentionees_deprecated:function(t,n){e(d.Q(t,n))},updateMentioneesStillInDraft:function(t,n){e(d.V(t,n))},addToCurrentMentionees:function(t,n){e(d.d(t,n))},updateSelectedTaskAssignee:function(t,n){e(d.X(t,n))},displayDraftWarning:function(t,n,i){e(d.r({draftWarningType:n,draftWarningReason:i},t))},showPostErrorUI:function(t,n){e(d.O(t,n))},clearPostErrorUI:function(t,n){e(d.n(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,i){e(function(e,t,n){return function(i,o){var a,r=o();(null===(a=w.j(r))||void 0===a?void 0:a.selectedCardId)!==t&&i(Object(z.b)(e,t,void 0,z.a.ExpandCard,u.a.SharedComments)),i(Object(H.a)(e,t,n))}}(t,n,i))},draftEmptinessChanged:function(t,n,i){e(d.s(t,i,n))}}}function q(e,t){return Object(o.__assign)(Object(o.__assign)({},G(e,t)),{cancelCommentPostEdit_deprecated:function(t,n,i){e(d.h(t,n,i))},cancelCommentReply_deprecated:function(t,n,i){e(d.i(t,n,i))},clearCurrentComments:function(t){e(d.m(t))},highlightComment:function(t,n){e(d.t(t,n,u.a.SharedComments))},requestCreateCommentSession:function(n,i){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"CREATE"},!1,n,d.j(n,a.h.reserveTag(593265933)),c.ub()?void 0:i)},discardDraftAndStartNewCommentSession:function(n,i,o){c.Z()?e(Object(l.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI,void 0,c.ub()?void 0:o)).catch((function(e){Object(s.a)(e,a.h.reserveTag(592314377))})):e(Object(k.a)(n,i,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI,(function(){return o}))).catch((function(e){Object(s.a)(e,a.h.reserveTag(593265934))}))},commitComment_Deprecated:function(n,i,o,a){return e(E(n,t.peopleAPI,a,i,o))},queueLoadThreads:function(t,n){e(d.x(t,{threadIds:n}))},selectFirstThreadInNextCommentContext:function(t){e(d.L(t))},selectLastThreadInPreviousCommentContext:function(t){e(d.M(t))},nextPopulatedContextDetailsUpdated:function(t,n){e(d.v(t,n))},requestClosePane:function(t){e(d.B(t))},requestDisplayConfiguration:function(t,n){return e(B(t,n))},readyToRender:function(t){e(d.y(t))},requestModalConfirmation:function(t,n,i,o){e(d.E(t,n,i,o))},initializeView:function(n){var i,o,r,s,d,u;e((i=n.renderContextType,o=t.initializationReason,r=t.commentAPI,s=t.peopleAPI,d=t.telemetryVisitor,u=c.ub()?void 0:n,function(e){return e(Object(L.a)({renderContextType:i,trackback:a.h.reserveTag(595899542),telemetryVisitor:d})),o===V.a.NewThread?(i===F.a.HalfPane&&e(B({renderContextType:i,trackback:a.h.reserveTag(595899543),telemetryVisitor:d},{displayMode:M.a.Variable,desiredHeight:0})).catch((function(e){Object(v.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,595645966):Object(a.i)().assertConditionTag(!1,"Unknown error in initializeViewThunk "+e,595645967)})),e(Object(l.a)({renderContextType:i,trackback:a.h.reserveTag(595898586),telemetryVisitor:d},r,{sessionType:"CREATE"},!1,s,void 0,c.ub()?void 0:u)).then((function(){e(Object(N.a)({renderContextType:i,trackback:a.h.reserveTag(595899545),telemetryVisitor:d}))}))):e(Object(N.a)({renderContextType:i,trackback:a.h.reserveTag(595899546),telemetryVisitor:d}))}))},updateFocusTypeAfterContextChange:function(t,n){e(d.U(t,n))},updateRenderLocksForAllDrafts:function(t,n){e(d.R(t,n))}})}function Y(e,t){return Object(o.__assign)(Object(o.__assign)({},G(e,t)),{updateRenderLockForDraft:function(t,n,i){e(d.R(t,n,i))},highlightComment:function(n){e(d.t(n,t.resource.id,u.a.SharedComments))},requestDisplayConfiguration:function(n,i){return t.componentTree.renderContextType!==F.a.HalfPane?Promise.resolve():e(B(n,i))}})}n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return Y}))},,,function(e,t,n){"use strict";var i=n(0),o=n(76);var a=n(396);n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r,s={parentId:"",commentId:"",author:{UserId:"",Provider:"",DisplayName:void 0,Email:void 0,IsCurrentUser:void 0},anchorHintText:"",commentFlags:0,commentBody:(r=new a.a,r.insert(""),r.toJSON())};function c(e,t){for(var n,i=null===(n=t)||void 0===n?void 0:n(),a=[],r=0,s=void 0;r<e.length;){if(e[r].type===o.a.Thread){var c=e[r].id;s=c,a.push(u(c,void 0,i))}else a.push(u(e[r].id,s,i));r++}return a}function d(e){return e.map((function(e){return u(e,void 0,void 0)}))}function u(e,t,n){var o=void 0;n&&(o=n.commentData.find((function(t){return t.commentId===e})));return o||Object(i.__assign)(Object(i.__assign)({},s),{commentId:e,parentId:t||""})}},,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(3),o=n(154),a=n(8),r=n(14),s=n(212);function c(e,t,n,c,d,u,l,m){n(Object(s.a)(u,e,c,d,t,void 0,a.ub()?void 0:m)).catch((function(e){Object(o.a)(e,i.h.reserveTag(591397647)),n(Object(r.f)(l,c,e))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),this.draftHasContent_deprecated=this.draftHasContent_deprecated.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.draftHasContent_deprecated=function(){return this.mockContents.length>0},e}()},,function(e,t,n){"use strict";var i,o=n(254);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(i||(i={})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var a={sendCodeMarker:function(e){},onStartEvent:new o.EventImpl((function(){})),onStopEvent:new o.EventImpl((function(){}))}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n(0);function o(e){var t,n=[{}];return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n.every((function(e,t){return e===o[t]}))?t:(n=o,t=e.apply(void 0,Object(i.__spread)(o)))}}function a(e,t){var n=o(e);return function(){return n.apply(void 0,Object(i.__spread)(t()))}}},,,,,,,function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";var i;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReadOnly=3]="ReadOnly",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(i||(i={})),t.a=i},,,,,,,function(e,t,n){"use strict";var i=n(0);!function(e){function t(t,n){var i,o=this,a="Error "+("0x"+((i=n)<0?4294967295+i+1:i).toString(16)+": ")+t+"\nStack:\n"+(new Error).stack;return(o=e.call(this,a)||this).errorCode=n,o}Object(i.__extends)(t,e)}(Error);n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s}));var o,a=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function r(e,t,n){return{fullName:e,email:t,resolveState:n}}function s(e){return JSON.parse(e).ops.map((function(e){return e.insert})).join("")}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(o||(o={}))},,,,,,,,,function(e,t,n){"use strict";var i=n(470);n.d(t,"a",(function(){return i.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var i=n(469),o=n(146),a=n(96),r=n(255),s=n(307),c=n(357),d=n(19),u=n(535),l=n(554),m=n(293);function f(e){return{commentData:[],cardViewState:{},postViewState:{},focusedComment:void 0,pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:o.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,virtualized:!1,focusedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(m.d)(),atMentionState:{capability:i.a.Unknown,authToken:void 0},wasDataReceived_deprecated:!1,capabilities:{resolve:!0},authToken:void 0,modelCapabilities:Object(d.j)(),appLocale:e,suggestionsDetails:void 0}}function p(e,t,n,i){return function(e,t,n,i){return{paneState:{viewContainer:e,componentTree:new s.a(Object(c.a)(e.containerType),i),visible_deprecated:t,visibilityState:t?a.a.Visible:a.a.Closed,initializationStatus:r.a.NotInitialized,focusTypeAfterContextChange:void 0},contentExtensions:Object(u.b)(),taskState:Object(l.a)(),commentState:f(n)}}(e,t,n,i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.BeginDraftingSuccessType,{draftDetails:t,draftRenderContextType:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.EndViewInitialization,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.LoadPersonaIconPropertiesType,{personaIconPropertiesMap:t},e)}},,,,function(e,t,n){"use strict";var i=n(405),o=(n(324),n(471),n(211),n(155),n(165));n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return o.a}))},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var i=n(146),o=n(19),a=n(12),r=n(10),s=n(44),c=n(8);function d(e,t){return!!c.K()||!(e&&Object(a.i)(e.focusDetails)||t)}function u(e){return!!e.focusedComment&&m(e.focusedComment)}function l(e){return function(e){var t=c.t()&&!s.b(e);return r.f(e).nextPopulatedContextDetails!==i.a.NoComments||Object(o.b)(r.e(e),t)}(e)&&m(r.j(e))}function m(e){return c.K()||!e||!Object(a.i)(e.focusDetails)}},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(3),o=n(146),a=n(106),r=n(20),s=n(78),c=n(8),d=n(381),u=n(134),l=n(12),m=n(389),f=n(147);n(124),n(16);function p(e,t){if(t<3)throw new r.a(s.i,-2130957559);var n=c.o();return t-2==1?n?e.getString(106):e.getString(9):n?e.formatString(107,String(t-2)):e.formatString(10,String(t-2))}function h(e,t){switch(t){case o.a.AtFinishNextCommentIsFirst:return e.getString(8);case o.a.AtStartNextCommentIsFirst:return e.getString(6);case o.a.MoreCommentsUpcoming:case o.a.DocumentHasComments:return e.getString(7);case o.a.NoComments:case o.a.Unknown:default:return""}}function C(e,t,n,i){return n?t?e.getString(16):e.getString(17):c.K()&&void 0!==i&&i!==f.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function g(e,t){switch(t){case u.a.ReturnToDraft:return e.getString(110);case u.a.GrantAccessFailedSilently:return e.getString(134);case u.a.CommitFailed:return e.getString(135);case u.a.None:return Object(i.i)().assertConditionTag(!1,"Invalid DraftWarningType: "+t,595686755),""}}function v(e){return e.getString(112)}function y(e){return e.getString(113)}function b(e,t){return void 0===t&&(t=!0),c.fb()?t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113):t?e.getString(112):e.getString(113)}function T(e,t){return t?t.focusDetails.editingSession===l.a.LowFidelityWarningOnEdit?e.getString(35):t.focusDetails.editingSession===l.a.LowFidelityWarningOnDelete?e.getString(36):"":""}n.d(t,"t",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return C})),n.d(t,"e",(function(){return g})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"n",(function(){return b})),n.d(t,"h",(function(){return T})),n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return O})),n.d(t,"i",(function(){return D})),n.d(t,"b",(function(){return w})),n.d(t,"j",(function(){return j})),n.d(t,"o",(function(){return P})),n.d(t,"p",(function(){return x})),n.d(t,"r",(function(){return E})),n.d(t,"q",(function(){return A})),n.d(t,"c",(function(){return k})),n.d(t,"m",(function(){return _})),n.d(t,"s",(function(){return R}));var I=Object(d.a)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return"RangeError"===e.name}return!1}));function S(e,t){var n=I();try{if(n){var o={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,o)}return Object(i.i)().assertConditionTag(!1,"The locale and options arguments are not supported",595882385),e.toLocaleDateString()}catch(o){return Object(i.i)().assertConditionTag(!1,"LocaleDateString conversion failed: "+o.name+", locale: "+t+", areLocaleAndOptionsArgumentsSupported: "+n+", Date: "+e.toString(),595953050),""}}function O(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function D(e){return c.C()?{loading:e.getString(94),error:e.getString(95),limitedResults:e.getString(96),emptyResults:e.getString(93),suggestionsAnnouncement:e.getString(97),pickerModePlaceholderText:" ",useThisAddress:""}:{isRTL:e.getLocaleInfo().isRightToLeft,noResultsFound:e.getString(61),searchDirectory:e.getString(59),searching:e.getStringWithStandardPlaceholders(57),suggestedContactsHeader:e.getString(62),topNResults:e.getStringWithStandardPlaceholders(60),typeToSearch:e.getString(58),loading:e.getString(73),accessibilityOnShowAnnouncement:e.getStringOrUndefined(74),a11yLabelForSuggestion:e.getStringWithStandardPlaceholdersOrUndefined(86)}}function w(e,t){var n="";switch(e){case m.a.Draft:case m.a.DraftPreCommitPending:n=t.getString(90);break;default:n=t.getString(89)}return n}function j(e){return e.getString(122)}function P(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(a.g)(e))}function x(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(a.g)(e)):n.formatString(129,Object(a.g)(e))}function E(e){return e.formatString(111,e.getString(133))}function A(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}var k=Object(d.a)((function(e,t,n,i){var o=t===m.a.Draft||t===m.a.DraftPreCommitPending,r=Object(a.e)(i);return r?o?e.formatString(178,r):n?e.formatString(179,r):e.formatString(178,r):o?e.getString(173):e.getString(174)}));function _(e,t){return e?t.getString(176):t.getString(126)}function R(e,t,n){var i;return e?n.getString(180):(null===(i=t)||void 0===i?void 0:i.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}},,,,,,,,function(e,t,n){var i=n(388),o=n(311),a=n(574),r=n(928),s=n(749),c=function(e,t,n){var d,u,l,m,f=e&c.F,p=e&c.G,h=e&c.S,C=e&c.P,g=e&c.B,v=p?i:h?i[t]||(i[t]={}):(i[t]||{}).prototype,y=p?o:o[t]||(o[t]={}),b=y.prototype||(y.prototype={});for(d in p&&(n=t),n)l=((u=!f&&v&&void 0!==v[d])?v:n)[d],m=g&&u?s(l,i):C&&"function"==typeof l?s(Function.call,l):l,v&&r(v,d,l,e&c.U),y[d]!=l&&a(y,d,m),C&&b[d]!=l&&(b[d]=l)};i.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(453)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var i,o=n(3);function a(e){i=e}function r(e){i?i.announceToScreenReader(e):Object(o.i)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&a(e)},e}(),c=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(i||(i={}))},function(e,t,n){"use strict";function i(e){return"function"==typeof e.getViewContainer}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.AddContentExtensionType,{extension:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.BeginProcessingCommitType,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.BeginProcessingDiscardType,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.BeginViewInitialization,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.CancelDiscardType,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.ClearCommentHighlightType,{actionSource:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e){return Object(i.b)(o.a.ClearCommentSelectionType,{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.CommitDraftType,t,e)}function r(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.HighlightCommentType,{commentId:t,actionSource:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.LoadCommentType,{commentData:t,tasks:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.LoadVirtualizedCommentsType,{threadInfo:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.ReloadCommentsType,t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.RequestDisplayConfigurationType,{displayConfig:t,completion:void 0},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.SessionRequestStartedAndLockFocusType,{params:t,captureFocusedThreadIdBeforeSession:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t,n){return Object(i.b)(o.a.ShowLowFidelityWarningType,{commentId:t,commentSessionState:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.TopVisibleThreadChangedType,{threadId:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.UpdateAtMentionAuthTokenType,{authToken:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.UpdateContextStateType,{contextState:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),o=n(7);function a(e,t){return Object(i.b)(o.a.UpdateSuggestionsDetailsType,{details:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(540);function o(){Object(i.a)().beginInitialization()}},,,,,,,,,,,,,,function(e,t,n){"use strict";n(66);n(190);var i=n(76),o=n(75),a=n(259);n(213);n.d(t,"e",(function(){return i.n})),n.d(t,"a",(function(){return o.b})),n.d(t,"b",(function(){return a.a})),n.d(t,"d",(function(){return a.c})),n.d(t,"c",(function(){return a.b}))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(847),o=n(123);n.o(o,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return o.initializeRuntime})),n.o(o,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return o.instantiateSharedComments})),n.o(o,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return o.renderCommentPaneWithAppInfo}));var a=n(764);n.d(t,"renderCommentPaneWithAppInfo",(function(){return a.a}));n(773);var r=n(774);n.d(t,"instantiateSharedComments",(function(){return r.a}));var s=n(491);n.d(t,"initializeRuntime",(function(){return s.a})),Object(i.a)()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),o=n(86),a=n(5),r=n(1),s=n(8);function c(e){var t=n(952),c=n(953),d=o.a()?n(954):n(955),u=n(956),l=n(957),m=n(958),f=n(959),p=n(960),h=n(961),C=n(962),g={HintBarEllipses_16:r.createElement(t,null),CancelGlyph:r.createElement(c,null),NewComment:r.createElement(d,null),CancelGlyph_TaskPane:r.createElement(u,null),Send2_Fluent:r.createElement(l,null),Delete_Fluent:r.createElement(m,null),Edit_Fluent:r.createElement(f,null),Checkmark_Fluent:r.createElement(p,null),CommentReopen_Fluent:r.createElement(h,null),Error:r.createElement(C,null)};if(e||s.b()){var v=n(963),y=n(964),b=n(965),T=n(966),I=n(967),S=n(968),O=n(969);g=Object(i.__assign)(Object(i.__assign)({},g),{TaskAssign:r.createElement(v,null),TaskComplete:r.createElement(y,null),TaskDelete:r.createElement(b,null),TaskEdit:r.createElement(T,null),TaskReopen:r.createElement(I,null),TaskStatusCircleCheckmark:r.createElement(S,null),ChevronDown12:r.createElement(O,null)})}Object(a.ib)({icons:g})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={name:"OfficeSharedComments",version:n(769).a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(102),o=n(553),a=n(349),r=n(550),s=n(708),c=n(406),d=n(20),u=n(818),l=n(176),m=n(819);function f(e){if(void 0===e.hostCommentAPI)throw new d.a("'hostCommentAPI' was not supplied",-2130957511);if(void 0===e.peopleAPI)throw new d.a("'peopleAPI' was not supplied",-2130957511);if(void 0===e.viewContainerProvider)throw new d.a("'viewContainerProvider' was not supplied",-2130957511);var t=Object(i.f)(e.apiContext),n=Object(a.a)(),f=e.themeAPI||new r.a,p=e.hostCommentAPI;return(p=new o.a).init(e.hostCommentAPI),new u.a({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:p,peopleAPI:e.peopleAPI,localizationAPI:n,themeAPI:f,initializationReason:e.initializationReason,commentStore:Object(s.a)(p,e.viewContainerProvider,Object(c.b)(e.viewContainerProvider.getViewContainer(),e.paneVisible,n.getLocaleInfo().appLocale,e.apiContext),l.a.getTelemetryVisitor(e.apiContext),t,n),viewStrategyFactory:new m.a,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver})}},function(e,t,n){"use strict";function i(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var i=n(0),o=n(3),a=n(14);function r(){return{extensions:{}}}function s(e,t){switch(void 0===e&&(e={extensions:{}}),void 0===t&&(t=a.b),t.type){case a.a.AddContentExtensionType:return function(e,t){var n;Object(o.i)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var a=t.payload.extension;return Object(i.__assign)(Object(i.__assign)({},e),{extensions:Object(i.__assign)(Object(i.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:a,priority:a.priority},n))})}(e,t);case a.a.RemoveContentExtensionType:return function(e,t){var n,o,a=Object(i.__assign)({},e.extensions);try{for(var r=Object(i.__values)(t.payload.renderModes),s=r.next();!s.done;s=r.next()){var c=s.value;delete a[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return Object(i.__assign)(Object(i.__assign)({},e),{extensions:a})}(e,t);case a.a.UpdateExtensionPriorityType:return function(e,t){var n=Object(i.__assign)({},e.extensions);for(var o in t.payload.updates)n[o]&&(n[o]=Object(i.__assign)(Object(i.__assign)({},n[o]),{priority:t.payload.updates[o]}));return Object(i.__assign)(Object(i.__assign)({},e),{extensions:n})}(e,t);default:return e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n(25),o=function(e){return e.contentExtensions.extensions},a=function(e,t){var n;return t.renderMode===i.d.Integrated?void 0!==(n=o(e)[t.renderMode])&&n.priority!==i.c.Disabled:t.renderMode===i.d.Isolated&&(void 0!==(n=o(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==i.c.Disabled)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return C}));var i=n(3),o=n(25),a=n(344),r=n(75),s=n(20),c=n(78),d=n(8),u=n(12),l=n(147),m=n(16),f=n(339);function p(e,t,n){for(var i,o,r,s=new a.a(t,-1);!(r=s.next()).done;){var c=r.value.commentId;if((null===(i=n[c])||void 0===i?void 0:i.alternateId)===e||c===e)break}return null===(o=r.value)||void 0===o?void 0:o.commentId}function h(e,t,n,o,a){var u=d.H()&&n||e,l=t.filter((function(e){return Object(r.b)(e)===u})),m=a,p=!1;if(!o||o.newComment.commentId!==e&&o.draftId!==e){if(m&&m.isInCurrentContext)throw Object(i.i)().assertConditionTag(!1,"Bad Store State, missing lie for new draft requested.",593786640),new s.a(c.b,-2130957556);m=void 0}else l=[Object(f.a)(o)],p=!0;return{thread:l,isDraftThread:p,draftThreadState:m}}function C(e,t,n,i){if(e.draftThreadState){var a=d.e()?o.a.Enabled_ForcePrimary:o.a.Enabled_Default;return e.draftThreadState.renderContextType===m.a.None||e.draftThreadState.renderContextType===n?a:o.a.Disabled}return e.isDraftThread||e.thread.length>0?!d.e()||i!==l.a.InCard&&i!==l.a.InChildPost?o.a.Enabled_Default:o.a.Enabled_ForcePrimary:t&&t.focusDetails.editingSession===u.a.SessionRequestPending?o.a.Disabled:o.a.Invalid}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(3),o=n(14),a=n(103),r=n(83),s=n(23),c=n(19),d=n(12),u=n(10),l=n(15),m=n(474),f=n(476);function p(e,t,n,p){return function(h,C){var g=C(),v=Object(i.i)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,i.a.None),y=u.j(g),b=Object(d.d)(y);v.addDataField(s.a.Trackback,e.trackback,i.c.SystemMetadata),v.addDataField(s.a.RenderContextType,e.renderContextType,i.c.SystemMetadata),v.addDataField(s.a.CommitPendingAttemptedCancel,b,i.c.SystemMetadata),v.addDataField(s.a.ActionSource,t,i.c.SystemMetadata);var T=function(e,t,n){var r=c.A(u.i(e)),s=u.j(e);if(!r)return s&&Object(d.g)(s.focusDetails)&&Object(d.e)(s.focusDetails.editingSession)?{cancelAction:o.h(Object(l.a)(n,i.h.reserveTag(593278744)),s.focusDetails.selectedPostId,t),sessionType:a.b}:-2130957522;var m=r.sessionConfiguration.sessionType;switch(r.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:o.g(Object(l.a)(n,i.h.reserveTag(593278745)),t),sessionType:m};case"REPLY":return{cancelAction:o.i(Object(l.a)(n,i.h.reserveTag(593278746)),r.sessionConfiguration.threadId,t),sessionType:m};case"EDIT":return{cancelAction:o.h(Object(l.a)(n,i.h.reserveTag(593278747)),r.sessionConfiguration.commentId,t),sessionType:m};default:return Object(i.i)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(g,n,e);if("number"==typeof T)return v.failTag(i.h.reserveTag(593278749),T),Promise.resolve(r.a.Handled);var I=T.sessionType,S=T.cancelAction;return v.addDataField(s.a.ActiveSessionType,I,i.c.SystemMetadata),b||!y||y.focusDetails.editingSession!==d.a.Active&&y.focusDetails.editingSession!==d.a.LowFidelityWarningOnEdit&&y.focusDetails.editingSession!==d.a.LowFidelityWarningOnDelete?(v.addDataField(s.a.DiscardUnnecessary,!0,i.c.SystemMetadata),v.successTag(593278755),Promise.resolve(r.a.Unhandled)):(v.addDataField(s.a.DiscardUnnecessary,!1,i.c.SystemMetadata),h(Object(m.a)(Object(l.a)(e,i.h.reserveTag(593278750)))),v.addDataField(s.a.DiscardDialogShown,!!p,i.c.SystemMetadata),p?p((function(){return h(S),v.addDataField(s.a.CancelledByUser,!1,i.c.SystemMetadata),v.successTag(593278751),r.a.Handled}),(function(){return v.addDataField(s.a.CancelledByUser,!0,i.c.SystemMetadata),v.successTag(593278752),h(Object(f.a)(Object(l.a)(e,i.h.reserveTag(593278753)))),r.a.Canceled})):(h(S),v.successTag(593278754),Promise.resolve(r.a.Handled)))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(3),o=n(104),a=n(16),r=n(23),s=n(154),c=n(8),d=n(10),u=n(44),l=n(320),m=n(212),f=n(301);function p(e,t){switch(e){case a.a.None:case a.a.ModalDraft:return;case a.a.DiscreteIntegrated:case a.a.DiscreteIsolated:case a.a.FullPane:case a.a.HalfPane:return t(e)}}function h(e,t,n,h,C,g,v){return function(y,b){var T,I,S=b(),O=o.b[h.sessionType];if(c.w()?(T=d.w()(S),I=null!=T?T:a.a.None):I=e.renderContextType!==a.a.None||!u.b(S)&&c.t()?e.renderContextType:u.c(S).renderContextType,c.L())return y(Object(m.a)(e,n,h,C,g,void 0,p(I,v)));var D=Object(i.i)().createActivityObject("DiscardDraftAndStartNewCommentSession",e.telemetryVisitor,i.a.None);return D.addDataField(r.a.SessionType,O,i.c.SystemMetadata),D.addDataField(r.a.Trackback,e.trackback,i.c.SystemMetadata),D.addDataField(r.a.RenderContextType,I,i.c.SystemMetadata),D.addDataField(r.a.IsPaneVisible,u.b(S),i.c.SystemMetadata),y(Object(f.a)(e,t,void 0,p(I,v))).then((function(t){return D.addDataField(r.a.DiscardDraftIfEmptyResult,t.draftDiscardResult,i.c.SystemMetadata),y(Object(m.a)(e,n,h,C,g,void 0,v(I)))})).catch((function(t){return Object(s.a)(t,i.h.reserveTag(594921089)),y(Object(l.a)(e,h,t))}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(156),o=n(20),a=n(78),r=n(8),s=n(176);function c(){if(!r.t())throw new o.a(a.p,-2130957516);return s.a.getViewManager(i.a)}},,,,,,,,function(e,t,n){"use strict";var i=n(3),o=n(405),a=n(20),r=n(55),s=n(231),c=n(1),d=n(42),u=n(65),l=n(8),m=n(221),f=n(176),p=n(96),h=n(155),C=function(){function e(e,t,n){var o=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case p.a.Visible:o.viewContainerBase.identifier?o.rootNode=document.getElementById(o.viewContainerBase.identifier):Object(i.i)().assertConditionTag(!1,"View container base identifier expected",592241222),o.providerPromise.then((function(e){o.renderIntoView(e)})).catch((function(e){Object(a.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,592241223):Object(i.i)().assertConditionTag(!1,"Unknown error in onViewEventReceived "+e,592241224)}));break;case p.a.Closed:o.viewContainerBase.identifier&&o.rootNode&&(Object(d.unmountComponentAtNode)(o.rootNode),o.rootNode=null);break;case p.a.Hidden:Object(i.i)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",592217540);break;default:Object(r.h)(e.viewContainerVisibilityState)}},this.processVisibilityEvent_deprecated=function(e){e.visible?(o.viewContainerBase.identifier?o.rootNode=document.getElementById(o.viewContainerBase.identifier):Object(i.i)().assertConditionTag(!1,"View container base identifier expected",595691472),o.providerPromise.then((function(e){o.renderIntoView(e)})).catch((function(e){Object(a.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,595646040):Object(i.i)().assertConditionTag(!1,"Unknown error in onViewEventReceived "+e+" (deprecated path)",595646041)}))):o.viewContainerBase.identifier&&o.rootNode&&(Object(d.unmountComponentAtNode)(o.rootNode),o.rootNode=null)},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var c=Object(m.d)(m.a,t);l.t()&&this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(s.b)().getComponent(c),this.providerPromise.then((function(e){e.onStateChanged.subscribe(o.onProviderStateChange)})).catch((function(e){Object(a.b)(e)?Object(i.i)().assertConditionTag(!1,e.message,595646038):Object(i.i)().assertConditionTag(!1,"Unknown error in ClientViewContainer constructor "+e,595646039)})))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!0,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=e.component,n=Object(i.i)().createActivityObject("RenderPaneIntoView",f.a.getTelemetryVisitor(this.context),i.a.None);t?(Object(d.render)(c.createElement(t,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(u.x());e&&e.focus()})),n.successTag(595649618)):n.failTag(595649617,-2130957502)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===s.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(i.i)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",595899021)})):e===s.a.Unregistered&&Object(d.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case h.a.VisibilityChanged_deprecated:this.processVisibilityEvent_deprecated(e);break;case h.a.VisibilityChanged:this.processVisibilityEvent(e);break;case h.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case h.a.FoldableLayoutStateChanged:case h.a.FocusTriggered:break;default:Object(r.h)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),g=function(){function e(e,t,n){if(!n)throw new a.a("initialViewContainer must be provided at initialization for web ViewContainerProvider.",-2130957557);this._currentContainer=new C(n,t)}return e.prototype.getViewContainer=function(){return this._currentContainer},e.prototype.changeViewContainerType=function(e){},e.prototype.registerForViewContainerEvents=function(e){},e.prototype.unregisterForViewContainerEvents=function(e){},e}(),v=n(0),y=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(v.__spread)(t))}))}},enumerable:!0,configurable:!0}),e}(),b=function(e){function t(t,n){var i=e.call(this)||this;return i.viewContainerProvider=n,i.processEvent=function(e){var t=e;if(e.eventType===h.a.VisibilityChanged_deprecated&&l.O()){var n=e.visible?p.a.Visible:p.a.Closed;t={eventType:h.a.VisibilityChanged,viewContainerVisibilityState:n}}i.fireEvent(t)},i.apiContext=t,n.registerForViewContainerEvents(i.processEvent),i}return Object(v.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(this.currentContainer=new C(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(function(){function e(){this.changedEvent=new y}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e.prototype.fireEvent=function(e){this.changedEvent.invoke(e)},e}());function T(e,t,n,i){return new g(t,e,i)}var I=n(471);function S(e,t){var n=void 0,a=t();return Object(I.a)(a)?l.t()?function(e,t){return new b(e,t)}(e,a):(Object(i.i)().assertConditionTag(!1,"ViewContainerProvider code in the host is not properly gated",591729827),T(e,(n=a.getViewContainer()).containerType,o.a.Indeterminate,n)):T(e,(n=a).containerType,o.a.Indeterminate,n)}n.d(t,"a",(function(){return S}))},function(e,t,n){"use strict";var i=n(150),o=n(1),a=n(42),r=n(0),s=n(11),c=Object(s.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}}})),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(r.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=c();return o.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(o.PureComponent);function u(){var e=document.createElement("div");document.body.appendChild(e),a.render(o.createElement(d,{ref:m}),e),Object(i.c)({announceToScreenReader:function(e){l&&l.appendLiveRegionUpdate(e)}})}n.d(t,"a",(function(){return u}));var l=void 0;function m(e){l=e}},function(e,t,n){"use strict";var i=n(3),o=n(36),a={themeId:1,palette:{ApplePaneTopBorder:o.a.GRAY_C,ButtonBorder:o.a.GRAY_B,CardAccent:o.a.GRAY_B,CardBackground:o.a.WHITE,CardHoveredBackground:o.a.GRAY_20,CardDraftBoxBackgroundHovered:o.a.WHITE,CardDraftBoxBorderHovered:o.a.GRAY_160,CardDraftBoxBorder:o.a.GRAY_110,CardDraftBoxBackground_HalfPane:o.a.WHITE,CardDraftBoxBackground:o.a.GRAY_A,CardDraftBoxBorder_deprecated:o.a.GRAY_B,CardExpandButtonBorder:o.a.GRAY_B,CardHeroBarBackground_HalfPane:o.a.GRAY_A,CardHeroBarBackground:o.a.WHITE,CardPlaceholderColor_deprecated:o.a.GRAY_E,CardReplyBackground_HalfPane:o.a.GRAY_A,CardReplyBackground:o.a.GRAY_A,CardReplyTopBorder:o.a.GRAY_B,CardSelectionColor:o.a.COMMENTS_PURPLE,CardShadowColor:o.a.BLACK,CardBorder:o.a.GRAY_B,CardBorderEmphasis:o.a.COMMENTS_PURPLE,SelectedBorder:o.a.GRAY_100,CommandBarBorder:o.a.GRAY_B,CommandBarTopBorder:o.a.GRAY_B,GhostCommentWrapperBorder:o.a.GRAY_D,IconButtonDisabledTint:o.a.GRAY_C,IconButtonFocusedTint:o.a.GRAY_I,NavigationBarBackground:o.a.WHITE,NavigationBarBorder:o.a.GRAY_B,PaneBackground_HalfPane:o.a.WHITE,PaneBackground:o.a.GRAY_A,UnreadDotColor:o.a.DOT_BLUE,UnreadDotBorderColor:o.a.WHITE,ResolvedPersonaBackground:o.a.GRAY_A,ExpandButtonFocusBackground:"transparent",FocusBorderColor:o.a.GRAY_150,CardPlaceholderColor:o.a.GRAY_130}};n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.prototype.getTheme=function(){return Object(i.i)().assertConditionTag(!1,"Should not be called",592986821),a},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}()},,function(e,t,n){"use strict";n(26);var i={LivePersonaPicker:{webSettingName:"LivePersonaPicker"},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton"},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments"},CommentsFluentUI:{webSettingName:"CommentsFluentUI"},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks"},NoDiscardOnFocusLoss:{},NewDraftingUI:{webSettingName:"DiscreteHostedComments"},CommentsFluentUIV2:{webSettingName:"CommentsFluentUIV2"},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply"},NewModelState:{},HeadlessBoot:{},NativeDiscreteHostedComments:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},NewTaskAssigneePayload:{webSettingName:"NewTaskAssigneePayload"},NewCommentStateDesigns:{},ExtendedDrafting:{},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair"}};n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";var i=n(0),o=n(20),a=n(338),r=n(106),s=n(78),c=n(8),d=n(191),u=n(505),l=function(){function e(e,t,n,i,o){var a=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=i,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.handleCommentEvents=function(e,t){e===d.d.UpdateDraftThread&&Object(u.e)(t)&&t.draftId===a.sessionConfiguration.draftId&&(t.anchorHintText&&(a._anchorHintText=t.anchorHintText),void 0!==t.insertIndex&&(a._insertIndex=t.insertIndex))},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!0,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(i.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new o.a(s.k,-2130957526);if(!this._active)throw new o.a(s.e,-2130957525);var t=c.b()&&this.sessionConfiguration.sessionType===d.h;if(void 0===e&&!t||t&&void 0!==e)throw new o.a(s.f,-2130957507);return c.b()?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}();n.d(t,"a",(function(){return m}));var m=function(){function e(){}return e.prototype.init=function(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e))},e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new o.a("Drafting APIs are undefined on Host Comment API",-2130957527);var n=Object(a.a)(),s=Object(i.__assign)(Object(i.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(s).then((function(e){return new l(t.hostCommentAPI,Object(r.c)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||s,e.insertIndex)}))},e}()},function(e,t,n){"use strict";var i=n(0),o=n(3),a=n(84),r=n(8),s=n(14),c=n(213);function d(){return{tasks:{}}}function u(e,t){if(void 0===e&&(e={tasks:{}}),void 0===t&&(t=s.b),!r.b())return e;switch(t.type){case s.a.LoadCommentType:return function(e,t){var n,o;if(!t.payload.tasks)return e;var a={};try{for(var r=Object(i.__values)(t.payload.tasks),s=r.next();!s.done;s=r.next()){var c=s.value;a[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return Object(i.__assign)(Object(i.__assign)({},e),{tasks:a})}(e,t);case s.a.ReloadCommentsType:return function(e,t){var n,o;if(!t.payload.tasks)return e;var a={};try{for(var r=Object(i.__values)(t.payload.tasks),s=r.next();!s.done;s=r.next()){var c=s.value;a[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return Object(i.__assign)(Object(i.__assign)({},e),{tasks:a})}(e,t);case s.a.CommentContextChangedType:return function(e){return Object(i.__assign)(Object(i.__assign)({},e),{tasks:{}})}(e);case s.a.ApplyCommentChangesType:return function(e,t){var n=Object(i.__assign)({},e.tasks);return t.payload.changes.forEach((function(e){if(e.type!==a.c.Unknown){var t=e.model.commentId;switch(e.type){case a.c.Delete:delete n[t];break;case a.c.Load:case a.c.Insert:case a.c.Modify:Object(o.i)().assertConditionTag(e.type===a.c.Modify||!n[e.model.commentId],"Task should not already be populated on initial load",593875215);var i=e.task;if(i){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===c.a.Create}(i))return void Object(o.i)().assertConditionTag(!1,"Invalid task payload - dropping task data",593875213);n[t]=i}}}else Object(o.i)().assertConditionTag(!1,"Unknown change type",593875214)})),Object(i.__assign)(Object(i.__assign)({},e),{tasks:n})}(e,t);default:return e}}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}))},,,,,,,,,,,,,,,,,,,,function(e,t,n){var i=n(922),o=n(927);e.exports=n(452)?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i=n(311),o=n(388),a=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(930)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var i=n(752);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RekaInstance=void 0;var i=n(580),o=function(){function e(){this.services={},this.factories={},this.nextNativePromiseId=0,this.nativePromises={},this.nativeBridge=void 0}return e.prototype.initBridge=function(e,t){this.nativeBridge=e,i.registerClasses.apply(void 0,t),this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:"init",value:"",promiseId:0})},e.prototype.getConstantJson=function(e,t){this.verifyNativeBridgePresent();var n=this.nativeBridge.RekaConstants;if(void 0!==n){var i=n[e];if(void 0!==i){var o=i[t];if(void 0!==o)return o}}throw new Error('Reka native service "'+e+'" must be registered before accessing it\'s constant property "'+t+'". This error also happens when the service implementation does not use the generated code from the correct (usually the latest) version of Reka service definition.')},e.prototype.InvokeNative=function(e,t,n){this.verifyNativeBridgePresent(),this.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:0})},e.prototype.InvokeNativeAndReturn=function(e,t,n){var i=this;return new Promise((function(o,a){var r=++i.nextNativePromiseId;i.nativePromises[r]={onSuccess:function(e){return o(e)},onFailure:function(e){return a(e)}},i.nativeBridge?i.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:r}):a("Native bridge is not initialized.")}))},e.prototype.RegisterService=function(e,t){this.factories[e]=t},e.prototype.invokeJavaScript=function(e){var t=this,n=e.serviceName,i=void 0===n?"":n,o=e.methodName,a=void 0===o?"":o,r=e.value,s=void 0===r?"":r,c=e.promiseId,d=void 0===c?0:c;if("$RekaBridge"===i)return this.invokeJavaScriptBridge(a,s,d);var u=(this.services[i]||(this.services[i]=this.factories[i]())).Invoke(a,s);this.nativeBridge&&u&&u.then&&u.then((function(e){return t.invokeNativeBridge("onSuccess",e,d)}),(function(e){return t.invokeNativeBridge("onFailure",e,d)}))},e.prototype.invokeNativeBridge=function(e,t,n){this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:e,value:t,promiseId:n})},e.prototype.invokeJavaScriptBridge=function(e,t,n){var i=this.nativePromises[n];i&&(delete this.nativePromises[n],i[e](t))},e.prototype.verifyNativeBridgePresent=function(){if(!this.nativeBridge)throw new Error("Native bridge is not initialized.")},e}();t.RekaInstance=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerClasses=t.registerClass=t.RekaServiceRegistry=t.stringifyJson=t.parseJson=void 0;var i=n(581),o=n(579),a=n(254);function r(e,t){var n=e?JSON.parse(e):[];if(Array.isArray(n))return t?i.CustomTypeRegistry.validateParsedObj(n,t):n;throw new Error("Everything should be an array")}function s(e,t){if("object"==typeof t)for(var n=i.CustomTypeRegistry.getExternalTypeInfos(),o=0,a=Object.keys(n);o<a.length;o++){var r=n[a[o]];if(t instanceof r.typeConstructor){r.stringify&&(t=r.stringify(t));break}}return t}function c(e){if(Array.isArray(e))return 0===e.length?"":JSON.stringify(e,s);throw new Error("Everything should be an array")}function d(e){var t,n,i;if("string"!=typeof e){switch(e[0]){case"FireAndForgetMethod":return[(t=e)[0],void 0,t[1]];case"ReturnsPromiseMethod":return[(n=e)[0],[n[1]],n[2]];case"Event":case"Constant":return[(i=e)[0],[i[1]],void 0]}}return[e,void 0,void 0]}t.parseJson=r,t.stringifyJson=c;var u=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,i=d(this.methodInfos[e])[2],o=(n=this.service)[e].apply(n,r(t,i));if(o&&o.then)return o.then((function(e){return c([e])}))},e}(),l=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n=d(this.methodInfos[e])[1];this.service[e].trigger(r(t,n)[0])},e}(),m=function(){function e(){this.nativeServices={}}return e.prototype.registerService=function(e){var t=e.serviceInfo,n=t[0],i=t[1],a=e.factory;o.RekaInstance.RegisterService(n,(function(){return new u(a(),i)}))},e.prototype.getNativeService=function(e){var t=e[0],n=e[1],i=this.nativeServices[t];if(!i){this.nativeServices[t]=i={};for(var s=!1,u={},m=function(e){var l=d(n[e]),m=l[0],f=l[1];switch(m){case"ReturnsPromiseMethod":i[e]=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return o.RekaInstance.InvokeNativeAndReturn(t,e,c(n)).then((function(e){return r(e,f)[0]}))};break;case"FireAndForgetMethod":i[e]=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return o.RekaInstance.InvokeNative(t,e,c(n))};break;case"Event":i[e]=new a.EventImpl((function(t){return i.updateEventListeners(e,t)})),s=!0;break;case"Constant":Object.defineProperty(i,e,{configurable:!1,enumerable:!0,get:function(){return void 0===u[e]&&(u[e]=r(o.RekaInstance.getConstantJson(t,e),f)[0]),u[e]}})}},f=0,p=Object.keys(n);f<p.length;f++){m(p[f])}s&&(i.updateEventListeners=function(e,n){o.RekaInstance.InvokeNative(t,e,n?"1":"0")},o.RekaInstance.RegisterService(t,(function(){return new l(i,n)})))}return i},e}();function f(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return new e}})}t.RekaServiceRegistry=new m,t.registerClass=f,t.registerClasses=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return f(e)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTypeRegistry=void 0;var i=n(950),o=function(){function e(){this.typeInfos={},this.typeInfosCache=[],this.externalTypes={}}return e.prototype.constuctor=function(e){void 0===e&&(e=!1),this.throwOnError=e},e.prototype.registerTypeInfos=function(e){if(-1===this.typeInfosCache.indexOf(e)){this.typeInfosCache.push(e);for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],o=this.typeInfos[i];o?o!==e[i]&&this.handleError("There are two definitions of the same namespace and interface: "+i):this.typeInfos[i]=e[i]}}},e.prototype.getTypeInfo=function(e){var t=this.typeInfos[e];if(t)return t;this.handleError('CustomTypeInfo "'+e+'" not registered as a custom types.')},e.prototype.registerExternalTypeInfos=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];this.externalTypes[i]?this.handleError('The external type "'+i+'" is already defined.'):this.externalTypes[i]=e[i]}},e.prototype.getExternalType=function(e){return this.externalTypes[e]},e.prototype.getExternalTypeInfos=function(){return this.externalTypes},e.prototype.validateParsedObj=function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];e[a]=i.verifyType(e[a],t[a])}return e},e.prototype.setThrowOnError=function(e){this.throwOnError=e},e.prototype.handleError=function(e){if(this.throwOnError)throw new Error(e)},e}();t.CustomTypeRegistry=new o},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(i||(i={}))},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(i.__spread)(e)),t=void 0}}},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));n(132),n(140);var i="sharedcommentsdemo"===Object({NODE_ENV:"production"}).TEST_PAGE,o=!1},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n(59);function o(e,t){if(!t)return e;switch(e){case i.c.ArrowLeft:return i.c.ArrowRight;case i.c.ArrowRight:return i.c.ArrowLeft;default:return e}}function a(e){switch(e){case"Down":return i.c.ArrowDown;case"Up":return i.c.ArrowUp;case"Left":return i.c.ArrowLeft;case"Right":return i.c.ArrowRight;case"OS":return i.c.Meta;case"Del":return i.c.Delete;case"Spacebar":return" ";case"Esc":return i.c.Escape;case"Ctrl":case"Ctl":return i.c.Control;case"F6":return i.c.F6;case"F12":return i.c.F12;default:return e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(8),o=n(19),a=n(12),r=n(147);function s(e,t,n,s){if(n&&Object(a.h)(n)){if(n.selectedCardId===e){if(i.t()&&s){var c=Object(o.B)(s);if(c&&c.renderContextType!==t)return r.a.InOtherContextOfThisCard}return Object(a.c)(n.focusDetails)?r.a.InCard:r.a.InChildPost}return r.a.InOtherCard}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(3),o=n(12),a=n(124),r=n(145);function s(e,t,n){var s=function(e,t){if(!t)return;if(Object(o.c)(t.focusDetails))return e.drafts[e.cardIdToDraftIdMap[t.selectedCardId]];return e.drafts[e.postIdToDraftIdMap[t.focusDetails.selectedPostId]]}(e,n);if(!s)return Object(i.i)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(r.b)(t)?a.a.ClosePaneDraft:a.a.CancelNewDraft;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return a.a.CancelNewDraft;case"EDIT":return a.a.CancelPostEdit;case"REPLY":return a.a.CancelReplyDraft;case"METADATA":return Object(i.i)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),a.a.CancelNewDraft}}},function(e,t,n){"use strict";function i(e){return void 0!==e.getContentsAsync&&void 0!==e.getCursorPositionAsync&&void 0!==e.setContents}n.d(t,"a",(function(){return i}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(133),o=n(398),a=n(42),r=function(){return function(e){return function(t){return Object(a.unstable_batchedUpdates)((function(){return e(t)}))}}},s=n(55),c=function(){return function(e){return function(t){var n,i="string"==typeof t.type?t.type:t.name||"Unknown Action",o=Object(s.g)(s.b.Redux,i),a=e(t);return null===(n=o)||void 0===n||n.end(),a}}},d=n(666),u=n(270),l=n(0),m=n(3),f=n(84),p=n(80),h=n(188),C=n(146),g=n(372),v=n(104),y=n(190),b=n(75),T=n(259),I=n(232),S=n(106),O=n(96),D=n(132),w=n(16),j=n(65),P=n(140),x=n(357),E=n(145),A=n(366),k=n(396),_=n(20),R=n(78),M=n(8),V=n(7),F=n(23),L=n(12);function N(e,t,n,i){if(M.G()&&e&&e.focusDetails.editingSession===L.a.Active&&(!t||t.focusDetails.editingSession!==L.a.Active)){var o=Object(m.i)().createActivityObject("SilentDiscardOnMerge",Object(m.j)(m.g.GlobalAPI),m.a.None);o.addDataField("DiscardReason",n,m.c.SystemMetadata),o.addDataField("MergeSource",i,m.c.SystemMetadata),o.successTag(592007882)}}function U(e,t,n){if(Object.keys(t.drafts).length<Object.keys(e.drafts).length){var i=Object(m.i)().createActivityObject("SilentDiscardOnViewChange",Object(m.j)(m.g.GlobalAPI),m.a.None);i.addDataField("ViewChangeSource",n,m.c.SystemMetadata),i.successTag(591661013)}}function B(e,t,n){if(M.F()){var i=Object(m.i)().createActivityObject("MarkCommentCreation",n,m.a.None,m.b.NecessaryServiceDataEvent);i.addDataField(F.a.DraftId,e,m.c.SystemMetadata),i.addDataField(F.a.CommentId,t,m.c.SystemMetadata),i.addDocumentMetadata(m.e.Basic),i.successTag(591152859)}}var z=n(19),H=n(127),W=n(534),G=n(293),q=n(99),Y=n(179),K=n(406);function J(e,t){switch(void 0===e&&(e=Object(K.a)("")),void 0===t&&(t=u.a),t.type){case V.a.HighlightCommentType:return function(e,t){var n=z.G(t.payload.commentId);if(n===e.highlightedCommentId)return e;!M.B()&&e.focusedComment&&n===e.focusedComment.selectedCardId&&(n=void 0);return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedComment:e.focusedComment,createdCommentLie:e.createdCommentLie,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,highlightedCommentId:n}}(e,t);case V.a.ApplyCommentChangesType:return function(e,t){var n,i,o,a;if(!t.payload.changes.length)return e;var r={commentData:Object(l.__spread)(e.commentData),cardViewState:Object(l.__assign)({},e.cardViewState),postViewState:Object(l.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,focusedComment:e.focusedComment,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,draftState:e.draftState,wasDataReceived_deprecated:e.wasDataReceived_deprecated},c=e.createdCommentLie,d=null===(a=e.createdCommentLie)||void 0===a?void 0:a.index;try{for(var u=Object(l.__values)(t.payload.changes),f=u.next();!f.done;f=u.next()){var C=f.value;if(C.type===p.b.Load&&(C=void 0!==r.postViewState[C.model.commentId]?Object(l.__assign)(Object(l.__assign)({},C),{type:p.b.Modify}):Object(l.__assign)(Object(l.__assign)({},C),{type:p.b.Insert})),C.type===p.b.Insert){if((v=C.model.parentId)&&(r.cardViewState[v]=Object(l.__assign)(Object(l.__assign)({},r.cardViewState[v]),{pending:H.a.None})),r.commentData.splice(C.index,0,C.model),C.tempId){if(v||(r.cardViewState=Object(l.__assign)(Object(l.__assign)({},z.I(r.cardViewState,[C.tempId])),z.f([C.model],void 0,C.tempId))),r.postViewState=Object(l.__assign)(Object(l.__assign)({},z.J(r.postViewState,[C.tempId])),z.z([C.model])),e.createdCommentLie&&e.createdCommentLie.newComment.commentId===C.tempId&&(d=void 0),r.focusedComment&&r.focusedComment.selectedCardId===C.tempId){var g=r.focusedComment;r.focusedComment=z.q(C.model),N(g,r.focusedComment,4,2)}}else Object(m.i)().assertConditionTag(!r.postViewState[C.model.commentId],"Received insert for existing comment "+C.model.commentId,594122589),r.cardViewState=Object(l.__assign)(Object(l.__assign)({},r.cardViewState),z.f([C.model])),r.postViewState=Object(l.__assign)(Object(l.__assign)({},r.postViewState),z.z([C.model]));void 0!==d&&C.index<=d&&d++}else if(C.type===p.b.Modify){if((T=r.commentData[C.index]).commentId===C.model.commentId){r.commentData[C.index]=C.model;var v=Object(b.b)(C.model);r.cardViewState[v]=Object(l.__assign)(Object(l.__assign)({},r.cardViewState[v]),{pending:H.a.None,loadState:{state:q.a.Loaded}}),e.cardViewState[v]&&e.cardViewState[v].loadState.state!==q.a.Loaded&&(r.wasDataReceived_deprecated=!0);var y=T.displayDate===C.model.displayDate&&T.date===C.model.date?r.postViewState[C.model.commentId].displayDate:z.g(C.model.date,C.model.displayDate,e.appLocale);if(r.postViewState=Object(l.__assign)(Object(l.__assign)({},r.postViewState),((o={})[C.model.commentId]=Object(l.__assign)(Object(l.__assign)({},r.postViewState[C.model.commentId]),{pending:Y.a.None,displayDate:y}),o)),C.model.commentFlags&h.a.Resolved&&r.focusedComment&&r.focusedComment.selectedCardId===C.model.commentId){g=r.focusedComment;r.focusedComment=z.p(r.focusedComment),N(g,r.focusedComment,1,2),r.draftState=z.x(r.focusedComment,g,!0,r.draftState)}}else Object(m.i)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(s.e)("changeIndex did not match comment for "+C.model.commentId)}else if(C.type===p.b.Delete){g=r.focusedComment;r.focusedComment=z.k(r.focusedComment,r.commentData,C.index,C.index+1);var T=r.commentData[C.index];if(N(g,r.focusedComment,""===T.parentId?3:2,2),T.commentId===C.model.commentId&&r.commentData.splice(C.index,1),r.highlightedCommentId===C.model.commentId&&(r.highlightedCommentId=void 0),r.topVisibleThreadId===C.model.commentId&&(r.topVisibleThreadId=void 0),r.draftState=z.K(r.draftState,C.model.commentId),r.draftState=z.M(r.draftState,C.model.commentId),r.cardViewState=Object(l.__assign)({},z.I(r.cardViewState,[C.model.commentId])),r.postViewState=Object(l.__assign)({},z.J(r.postViewState,[C.model.commentId])),C.model.commentId===r.focusedThreadIdBeforeCommentSession){var I=C.index;r.commentData.length?(I>=r.commentData.length&&(I=r.commentData.length-1),r.focusedThreadIdBeforeCommentSession=Object(b.b)(r.commentData[I])):r.focusedThreadIdBeforeCommentSession=void 0}void 0!==d&&C.index<d&&d--}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}void 0===d?c=void 0:c&&d!==c.index&&(c=Object(l.__assign)(Object(l.__assign)({},c),{index:d}));return{pendingCommentLoad:e.pendingCommentLoad,virtualized:e.virtualized,contextState:e.contextState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,createdCommentLie:c,draftState:r.draftState,focusedComment:r.focusedComment,commentData:r.commentData,cardViewState:r.cardViewState,postViewState:r.postViewState,highlightedCommentId:r.highlightedCommentId,topVisibleThreadId:r.topVisibleThreadId,focusedThreadIdBeforeCommentSession:r.focusedThreadIdBeforeCommentSession,wasDataReceived_deprecated:r.wasDataReceived_deprecated}}(e,t);case V.a.LoadCommentType:return function(e,t){var n=Object(l.__spread)(e.commentData,t.payload.commentData),i=z.D(e.modelCapabilities,e.virtualized),o=z.H(e,n,i),a=o.pendingCommentLoad,r=o.focusedComment;return{draftState:e.draftState,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,suggestionsDetails:e.suggestionsDetails,commentData:n,pendingCommentLoad:a,focusedComment:r,appLocale:e.appLocale,cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),z.f(t.payload.commentData,i?q.a.Placeholder:q.a.Loaded)),postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.z(t.payload.commentData)),wasDataReceived_deprecated:!i||e.wasDataReceived_deprecated}}(e,t);case V.a.LoadVirtualizedCommentsType:return function(e,t){var n=Object(A.b)(t.payload.threadInfo.map((function(e){return e.threadId}))),i=Object(l.__spread)(e.commentData,n);if(!z.D(e.modelCapabilities,e.virtualized))throw new _.a("virtualizeCommentsReducer requires virtualization",-2130957500);var o=z.H(e,i,!0),a=o.pendingCommentLoad,r=o.focusedComment;return{draftState:e.draftState,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,suggestionsDetails:e.suggestionsDetails,commentData:i,pendingCommentLoad:a,focusedComment:r,cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),z.C(t.payload.threadInfo)),postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.z(n)),wasDataReceived_deprecated:e.wasDataReceived_deprecated,appLocale:e.appLocale}}(e,t);case V.a.CancelCommentCreateThreadType:return function(e,t){if(!e.createdCommentLie)return e;var n,i=e.createdCommentLie.draftId,o=z.I(e.cardViewState,[i]),a=z.J(e.postViewState,[i]);e.focusedThreadIdBeforeCommentSession&&(n={selectedCardId:e.focusedThreadIdBeforeCommentSession,focusDetails:{expanded:!0,editingSession:L.a.None}});return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,createdCommentLie:void 0,focusedComment:n,cardViewState:o,postViewState:a,focusedThreadIdBeforeCommentSession:void 0,draftState:z.N(e.draftState)}}(e);case V.a.CancelCommentPostEditType:return function(e,t){var n=z.l(e,t.payload.commentId);return{commentData:e.commentData,cardViewState:e.cardViewState,postViewState:e.postViewState,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n,focusedThreadIdBeforeCommentSession:void 0,draftState:z.M(e.draftState,t.payload.commentId)}}(e,t);case V.a.CancelCommentReplyType:return function(e,t){var n=z.n(e.focusedComment,t.payload.commentId);return{commentData:e.commentData,cardViewState:e.cardViewState,postViewState:e.postViewState,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n,focusedThreadIdBeforeCommentSession:void 0,draftState:z.N(e.draftState)}}(e,t);case V.a.SelectCommentType:return function(e,t){var n=!1,i=e.focusedComment;if(!z.P(i,t))return e;if(!t.payload.selectedCard)throw new _.a(R.g,-2130957536);var o=void 0,a=z.O(i,t);if(a){e.commentData.filter((function(e){return e.parentId===a.selectedCardId||e.commentId===a.selectedCardId})).forEach((function(t){e.postViewState[t.commentId].displayDate||(o||(o=Object(l.__assign)({},e.postViewState)),o[t.commentId]=z.y(e.postViewState[t.commentId].displayDate||z.g(t.date,t.displayDate,e.appLocale),e.postViewState[t.commentId].displayingErrorUI),n=!0)}))}return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,cardViewState:e.cardViewState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:a,postViewState:n&&o?o:e.postViewState}}(e,t);case V.a.RequestThreadResolveType:return function(e,t){var n;return{draftState:e.draftState,commentData:e.commentData,postViewState:e.postViewState,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:H.a.Card,loadState:{state:q.a.Loaded}}),n)),focusedComment:z.o(e.focusedComment,t)}}(e,t);case V.a.ReloadCommentsType:return function(e,t){var n,i={},o={},a=e.focusedComment,r=a&&!Object(L.c)(a.focusDetails),s=!1,c=!1,d=!1,u=e.focusedThreadIdBeforeCommentSession,f=e.draftState,p=z.D(e.modelCapabilities,e.virtualized),C={};e.commentData.forEach((function(e){C[e.commentId]=e}));var g=!1,v=!1;if(t.payload.comments.forEach((function(t){var n;if(t.commentId===e.highlightedCommentId&&(g=!0),t.commentId===e.topVisibleThreadId&&(v=!0),t.commentId in C){if(""===t.parentId){e.cardViewState[t.commentId]&&Object(m.i)().assertConditionTag(e.cardViewState[t.commentId].pending!==H.a.Delete,"Card pending delete remained after a reload.",593762527);var r=e.cardViewState[t.commentId];if(!r||r.pending!==H.a.None||p){var f=null===(n=r)||void 0===n?void 0:n.loadState;o[t.commentId]=Object(l.__assign)(Object(l.__assign)({},r),{pending:H.a.None,loadState:f&&f.state===q.a.Placeholder?{state:q.a.Placeholder,initialItemCount:f.initialItemCount}:{state:q.a.NeedsReload}})}else o[t.commentId]=r}if(e.postViewState[t.commentId]&&Object(m.i)().assertConditionTag(e.postViewState[t.commentId].pending!==Y.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[t.commentId]&&e.postViewState[t.commentId].pending===Y.a.None?i[t.commentId]=e.postViewState[t.commentId]:i[t.commentId]=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.commentId]),{pending:Y.a.None}),a){if(a.selectedCardId===t.commentId)if(c=!0,t.commentFlags&h.a.Resolved)N(a,a=z.p(a),1,1);a.selectedCardId!==Object(b.b)(t)||Object(L.c)(a.focusDetails)||a.focusDetails.selectedPostId!==t.commentId||(s=!0)}u&&u===t.commentId&&(d=!0)}else{""===t.parentId&&(o[t.commentId]=z.u(p?{loadState:{state:q.a.Placeholder,initialItemCount:1}}:{loadState:{state:q.a.Loaded}}));i[t.commentId]=z.y(t.displayDate,!1)}})),n=z.a(e.createdCommentLie,t.payload.comments,e.cardViewState,!0)){var y=n.newComment.commentId;c=!(!a||n.newComment.commentId!==a.selectedCardId),o[y]=e.cardViewState[y],i[y]=e.postViewState[y]}if(c){if(r&&!s&&a&&!p){T=a;a={selectedCardId:a.selectedCardId,focusDetails:{expanded:!0,editingSession:L.a.None}},N(T,a,2,1)}}else{var T;N(T=a,a=void 0,3,1)}e.focusedComment&&a!==e.focusedComment&&(f=z.x(a,e.focusedComment,s,f));if(!d&&u){var I=e.commentData.findIndex((function(e){return e.commentId===u}));if(I<0&&(Object(m.i)().assertConditionTag(!1,"focusedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),I=0),t.payload.comments.length){I>=t.payload.comments.length&&(I=t.payload.comments.length-1);var S=t.payload.comments[I];u=Object(b.b)(S)}else u=void 0}return{virtualized:e.virtualized,contextState:e.contextState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:f,commentData:Object(l.__spread)(t.payload.comments),cardViewState:o,postViewState:i,focusedComment:a,pendingCommentLoad:void 0,highlightedCommentId:g?e.highlightedCommentId:void 0,topVisibleThreadId:v?e.topVisibleThreadId:void 0,createdCommentLie:n,focusedThreadIdBeforeCommentSession:u}}(e,t);case V.a.RequestReopenThreadType:return function(e,t){var n,i=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:H.a.Card}),n));return{draftState:e.draftState,commentData:e.commentData,postViewState:e.postViewState,focusedComment:e.focusedComment,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,cardViewState:i}}(e,t);case V.a.RequestDeletePostType:return function(e,t){var n,i=Object(l.__assign)(Object(l.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{pending:Y.a.Delete}),n));return{draftState:e.draftState,commentData:e.commentData,cardViewState:e.cardViewState,focusedComment:e.focusedComment,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,postViewState:i}}(e,t);case V.a.RequestDeleteThreadType:return function(e,t){var n,i=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:H.a.Delete}),n));return{draftState:e.draftState,commentData:e.commentData,postViewState:e.postViewState,focusedComment:e.focusedComment,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,cardViewState:i}}(e,t);case V.a.DispatchLoadThreadsType:return function(e,t){var n=Object(l.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){var t=n[e].loadState;n[e]=Object(l.__assign)(Object(l.__assign)({},n[e]),{loadState:t.state===q.a.Placeholder?{state:q.a.Loading,initialItemCount:t.initialItemCount}:{state:q.a.Loading}})})),{draftState:e.draftState,commentData:e.commentData,postViewState:e.postViewState,focusedComment:e.focusedComment,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,cardViewState:n}}(e,t);case V.a.BeginDraftingSuccessType:return function(e,t){var n,i,o,a,r;if(z.A(e.draftState))throw new _.a("Draft already active!",-2130957551);var c=e.focusedThreadIdBeforeCommentSession;if(!Object(y.a)(t.payload.draftDetails))throw new _.a("Invalid comment draft!",-2130957545);var d=t.payload.draftDetails;switch(d.sessionConfiguration.sessionType){case"CREATE":var u={parentId:"",commentId:d.sessionConfiguration.draftId,author:d.author,anchorHintText:d.anchorHintText};return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,createdCommentLie:{index:d.insertIndex,newComment:u,draftId:d.sessionConfiguration.draftId},cardViewState:Object(l.__assign)(Object(l.__assign)({},z.I(e.cardViewState,[Object(j.w)()])),z.h(u)),postViewState:Object(l.__assign)(Object(l.__assign)({},z.J(e.postViewState,[Object(j.w)()])),z.i(u)),focusedComment:z.r(e.commentData,d),focusedThreadIdBeforeCommentSession:c,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[d.sessionConfiguration.draftId]={commentDraft:d,isDraftEmpty:!0,isInCurrentContext:!0,renderContextType:t.payload.draftRenderContextType},n)),cardIdToDraftIdMap:Object(l.__assign)(Object(l.__assign)({},e.draftState.cardIdToDraftIdMap),(i={},i[d.sessionConfiguration.draftId]=d.sessionConfiguration.draftId,i))})};case"EDIT":case"REPLY":if(!Object(T.b)(d.sessionConfiguration)&&!Object(T.c)(d.sessionConfiguration))throw Object(m.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new _.a(R.f,-2130957532);var f=void 0;!e.focusedComment||Object(T.c)(d.sessionConfiguration)&&d.sessionConfiguration.threadId!==e.focusedComment.selectedCardId||v.e(d.sessionConfiguration)&&!Object(L.c)(e.focusedComment.focusDetails)&&d.sessionConfiguration.commentId!==e.focusedComment.focusDetails.selectedPostId?(Object(m.i)().assertConditionTag(!1,"Mismatch between initCommentSessionSuccess id and focusedComment selected id - falling back to using payload ids",593762524),f=z.r(e.commentData,d)):f=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.Active})});var p,h=e.draftState.cardIdToDraftIdMap,C=e.draftState.postIdToDraftIdMap;if(v.f(d.sessionConfiguration))h=Object(l.__assign)(Object(l.__assign)({},h),((o={})[d.sessionConfiguration.threadId]=d.sessionConfiguration.draftId,o)),p=!0;else if(v.e(d.sessionConfiguration)){var g=d.sessionConfiguration.commentId;C=Object(l.__assign)(Object(l.__assign)({},C),((a={})[g]=d.sessionConfiguration.draftId,a)),p=!1,M.ub()&&e.commentData.some((function(e){if(e.commentId===g){var t=Object(k.d)(e.commentBody);return p=0===t.length||Object(P.a)()===D.a.Web&&"\n"===t,!0}return!1}))}else Object(s.h)(d.sessionConfiguration),p=!0;return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:Object(l.__assign)(Object(l.__assign)({},f),{focusDetails:Object(l.__assign)({},f.focusDetails)}),focusedThreadIdBeforeCommentSession:c,draftState:{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(r={},r[d.sessionConfiguration.draftId]={commentDraft:d,isDraftEmpty:p,isInCurrentContext:!0,renderContextType:t.payload.draftRenderContextType},r)),cardIdToDraftIdMap:h,postIdToDraftIdMap:C},cardViewState:z.I(e.cardViewState,[Object(j.w)()]),postViewState:z.J(e.postViewState,[Object(j.w)()]),createdCommentLie:void 0};default:return e}}(e,t);case V.a.BeginDraftingFailureType:return function(e,t){if(void 0===e.focusedComment)return Object(m.i)().assertConditionTag(!1,"FocusedComment already undefined when failing focused comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.None})}):e.focusedThreadIdBeforeCommentSession&&(n={selectedCardId:e.focusedThreadIdBeforeCommentSession,focusDetails:{expanded:!1,editingSession:L.a.None}});return{commentData:e.commentData,cardViewState:e.cardViewState,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,postViewState:e.postViewState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n,focusedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:z.N(e.draftState)}}(e,t);case V.a.SessionRequestStartedAndLockFocusType:return function(e,t){var n,i=void 0,o=e.cardViewState,a=e.postViewState;if(e.createdCommentLie)return Object(m.i)().assertConditionTag(!1,"SessionRequestStartedAndLockFocus unexpected defined comment lie in state",593764356),e;if(v.f(t.payload.params))n=t.payload.params.threadId;else if(v.e(t.payload.params)){var r=t.payload.params.commentId,s=e.commentData.find((function(e){return e.commentId===r}));if(!s)return Object(m.i)().assertConditionTag(!1,"Could not lock focus on missing comment "+r,593764357),e;n=Object(b.b)(s)}else{var c={commentId:n=Object(j.w)()};i={index:-1,newComment:c,draftId:n},o[n]&&Object(m.i)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),o=Object(l.__assign)(Object(l.__assign)({},o),z.h(c)),a[n]&&Object(m.i)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),a=Object(l.__assign)(Object(l.__assign)({},a),z.i(c))}var d=void 0;t.payload.captureFocusedThreadIdBeforeSession&&e.focusedComment&&(d=e.focusedComment.selectedCardId);return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,postViewState:a,cardViewState:o,focusedThreadIdBeforeCommentSession:d,focusedComment:z.t(e.focusedComment,t,n),createdCommentLie:i}}(e,t);case V.a.CommentContextChangedType:return function(e,t){var n,i,o=!1,a={},r={},s={};i=t.payload.contextDetails?Object(l.__assign)(Object(l.__assign)({},Object(W.a)(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:C.a.Unknown,isReadOnly:M.J()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var c=t.payload.draftIds;if(c){var d=M.ob()?z.L(e.draftState,e.focusedComment):e.draftState;if(Object(G.a)(d)>0&&(o=!0,Object(G.b)(d).forEach((function(e){var t=c.includes(e);a[e]=Object(l.__assign)(Object(l.__assign)({},d.drafts[e]),{isInCurrentContext:t})})),e.createdCommentLie)){var u=e.createdCommentLie.draftId;u&&(null===(n=a[u])||void 0===n?void 0:n.isInCurrentContext)&&(r=z.v(u),s=z.w(u),e.createdCommentLie.index>-1&&(r[u].pending=H.a.None,s[u].pending=Y.a.None))}}var m=o?Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:a}):Object(G.d)();return U(e.draftState,m,2),{personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,virtualized:!!t.payload.virtualized,commentData:[],cardViewState:r,postViewState:s,focusedComment:o?e.focusedComment:void 0,pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},wasDataReceived_deprecated:0===t.payload.numberOfComments||e.wasDataReceived_deprecated,contextState:i,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?z.G(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:o?e.createdCommentLie:void 0,focusedThreadIdBeforeCommentSession:void 0,draftState:m}}(e,t);case V.a.NextPopulatedContextDetailsUpdatedType:return function(e,t){return{draftState:e.draftState,commentData:e.commentData,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedComment:e.focusedComment,pendingCommentLoad:e.pendingCommentLoad,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}}}(e,t);case V.a.ShowLowFidelityWarningType:return function(e,t){var n,i=t.payload,o=i.commentId,a=i.commentSessionState,r=e.commentData.find((function(e){return e.commentId===o}));if(!r)return Object(m.i)().assertConditionTag(!1,"Comment not found",593762530),e;if(e.focusedComment&&Object(L.i)(e.focusedComment.focusDetails))return Object(m.i)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;n=(M.z()?a!==L.a.LowFidelityWarningOnDeleteThread:a!==L.a.LowFidelityWarningOnDelete||r.parentId)?{selectedCardId:Object(b.b)(r),focusDetails:{selectedPostId:o,editingSession:a}}:{selectedCardId:o,focusDetails:{editingSession:M.z()?L.a.LowFidelityWarningOnDeleteThread:L.a.LowFidelityWarningOnDelete,expanded:z.E(o,e.focusedComment)}};return{draftState:e.draftState,commentData:e.commentData,cardViewState:e.cardViewState,postViewState:e.postViewState,pendingCommentLoad:e.pendingCommentLoad,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,createdCommentLie:e.createdCommentLie,contextState:e.contextState,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n}}(e,t);case V.a.ClearCommentsType:return Object(K.a)(e.appLocale);case V.a.ClearCommentSelectionType:return function(e,t){var n=e.focusedComment;if(!z.P(n,t))return e;return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:void 0}}(e,t);case V.a.ClearCommentHighlightType:return function(e,t){return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedComment:e.focusedComment,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,topVisibleThreadId:e.topVisibleThreadId,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,highlightedCommentId:void 0}}(e);case V.a.TopVisibleThreadChangedType:return function(e,t){return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedComment:e.focusedComment,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,topVisibleThreadId:t.payload.threadId}}(e,t);case V.a.UpdateContextStateType:return function(e,t){var n=Object(l.__assign)({},e.contextState);void 0!==t.payload.contextState.commentThreadCounts&&(n.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n.isReadOnly=t.payload.contextState.isReadOnly);return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedComment:e.focusedComment,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,contextState:n}}(e,t);case V.a.BeginProcessingCommitType:return function(e,t){if(!e.focusedComment||e.focusedComment.focusDetails.editingSession!==L.a.Active)return Object(m.i)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var n=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.CommitPending})});return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n}}(e);case V.a.CommitFailureType:return function(e,t){if(!e.focusedComment||e.focusedComment.focusDetails.editingSession!==L.a.CommitPending)return Object(m.i)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var n=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.Active})});return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:n}}(e);case V.a.BeginProcessingDiscardType:return function(e){if(!e.focusedComment||e.focusedComment.focusDetails.editingSession!==L.a.Active&&e.focusedComment.focusDetails.editingSession!==L.a.LowFidelityWarningOnEdit&&e.focusedComment.focusDetails.editingSession!==L.a.LowFidelityWarningOnDelete)return Object(m.i)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var t=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.DiscardPending})});return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:t}}(e);case V.a.CancelDiscardType:return function(e){if(!e.focusedComment||e.focusedComment.focusDetails.editingSession!==L.a.DiscardPending)return Object(m.i)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var t=Object(l.__assign)(Object(l.__assign)({},e.focusedComment),{focusDetails:Object(l.__assign)(Object(l.__assign)({},e.focusedComment.focusDetails),{editingSession:L.a.Active})});return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,contextState:e.contextState,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:t}}(e);case V.a.LoadPersonaIconPropertiesType:return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(l.__assign)(Object(l.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return{draftState:e.draftState,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,personaIconPropertiesMap:n}}(e,t);case V.a.CommitDraftType:return function(e,t){var n=z.A(e.draftState);if(void 0===n)return Object(m.i)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;var n=t.temporaryCommentId;if(!n)throw Object(m.i)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new _.a(R.f,-2130957545);var i={parentId:"",commentId:n,commentBody:t.commentBody,author:e.createdCommentLie.newComment.author},o=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),z.v(n)),a=Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.w(n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment&&{selectedCardId:n,focusDetails:{expanded:!0,editingSession:L.a.None}},highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,createdCommentLie:Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie),{newComment:i}),cardViewState:o,postViewState:a,focusedThreadIdBeforeCommentSession:void 0,draftState:z.N(e.draftState)}}(e,t.payload.data);case"REPLY":return function(e,t){var n,i;if(!t.parentId)throw new _.a(R.g,-2130957536);var o=M.U()?Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.parentId]),{pending:H.a.Editor,loadState:{state:q.a.Loaded}}),n)):Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((i={})[t.parentId]={pending:H.a.Editor,loadState:{state:q.a.Loaded}},i));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,postViewState:e.postViewState,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,cardViewState:o,focusedComment:z.m(e,t),focusedThreadIdBeforeCommentSession:void 0,draftState:z.N(e.draftState)}}(e,t.payload.data);case"EDIT":return function(e,t){var n,i=z.l(e,t.commentId),o=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.commentId]),{pending:Y.a.Post});return{commentData:e.commentData,cardViewState:e.cardViewState,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,createdCommentLie:e.createdCommentLie,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),(n={},n[t.commentId]=o,n)),focusedComment:i,focusedThreadIdBeforeCommentSession:void 0,draftState:z.N(e.draftState)}}(e,t.payload.data);default:throw new _.a("Unexpected session type for commit",-2130957532)}}(e,t);case V.a.ResolveAtMentionCapabilityType:return function(e,t){return{draftState:e.draftState,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,atMentionState:{capability:t.payload.capability,authToken:t.payload.authToken},authToken:t.payload.authToken,modelCapabilities:Object(l.__assign)(Object(l.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})}}(e,t);case V.a.UpdateAtMentionAuthTokenType:return function(e,t){return{draftState:e.draftState,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,personaIconPropertiesMap:e.personaIconPropertiesMap,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,atMentionState:{capability:e.atMentionState.capability,authToken:t.payload.authToken},authToken:t.payload.authToken}}(e,t);case V.a.SaveDraftType:return function(e,t){var n,i=e.draftState.drafts;if(void 0===i[t.payload.draftId])return M.rb()?Promise.resolve(t.payload.draftContent.editorContent).then((function(e){Object(k.d)(e).length>0&&Object(m.i)().assertConditionTag(!1,"saveDraftReducer called with an invalid draft id and non-empty content",591661014)})).catch((function(){Object(m.i)().assertConditionTag(!1,"saveDraftReducer called with invalid draft id and failed to check content length",591661015)})):Object(m.i)().assertConditionTag(0===Object.keys(i).length,"saveDraftReducer called with an invalid draft id",593762522),e;var o=Object(l.__assign)(Object(l.__assign)({},i),((n={})[t.payload.draftId]=Object(l.__assign)(Object(l.__assign)({},i[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,createdCommentLie:e.createdCommentLie,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:o})}}(e,t);case V.a.DraftEmptinessChangedType:return function(e,t){var n;if(!M.ub())return e;var i=e.draftState.drafts;if(void 0===i[t.payload.draftId])return Object(m.i)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=Object(l.__assign)(Object(l.__assign)({},i),((n={})[t.payload.draftId]=Object(l.__assign)(Object(l.__assign)({},i[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,createdCommentLie:e.createdCommentLie,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:o})}}(e,t);case V.a.UpdateDraftRenderContextType:return function(e,t){var n=z.S(e.draftState,(function(n){var i=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?i.renderContextType:t.payload.isClaimingLock&&i.renderContextType===w.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||i.renderContextType!==t.actionDetail.renderContextType?i.renderContextType:w.a.None}));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,createdCommentLie:e.createdCommentLie,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:n}}(e,t);case V.a.ViewContainerChangedType:return function(e,t){var n=z.S(e.draftState,(function(n){var i=e.draftState.drafts[n];return Object(E.b)(i.renderContextType)?Object(x.a)(t.payload.viewContainer.containerType):i.renderContextType}));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,createdCommentLie:e.createdCommentLie,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:n}}(e,t);case V.a.DisplayDraftWarningType:return function(e,t){var n,i=z.A(e.draftState);if(void 0===i)return Object(m.i)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var o=i.sessionConfiguration.draftId,a=e.draftState.drafts;if(!a[o])return Object(m.i)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var r=a[o].draftWarningState,s=Object(l.__assign)(Object(l.__assign)({},a),((n={})[o]=Object(l.__assign)(Object(l.__assign)({},a[o]),{draftWarningState:{warningCounter:r?r.warningCounter+1:0,type:t.payload.draftWarningType}}),n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:s})}}(e,t);case V.a.UpdateCapabilitiesType:return function(e,t){return{postViewState:e.postViewState,cardViewState:e.cardViewState,draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,wasDataReceived_deprecated:e.wasDataReceived_deprecated,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,capabilities:t.payload.capabilities}}(e,t);case V.a.UpdateModelCapabilitiesType:return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&I.a.AtMentionKnown?t.payload.modelCapabilityFlags&I.a.AtMentionEnabled?f.b.Enabled:f.b.Disabled:f.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&I.a.NewThread),resolve:!!(t.payload.modelCapabilityFlags&I.a.Resolve),virtualized:!!(t.payload.modelCapabilityFlags&I.a.Virtualized),tasks:t.payload.modelCapabilityFlags&I.a.TasksKnown?t.payload.modelCapabilityFlags&I.a.TasksEnabled?g.a.Enabled:g.a.Disabled:g.a.Unknown};return{postViewState:e.postViewState,cardViewState:e.cardViewState,draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,modelCapabilities:n}}(e,t);case V.a.UpdateCurrentMentioneesType:return function(e,t){var n,i=z.A(e.draftState);if(void 0===i)return Object(m.i)().assertConditionTag(!1,"Expected active draft to be present",593764362),e;var o=i.sessionConfiguration;if(Object(T.b)(o))return e;var a=o.draftId,r=e.draftState.drafts;if(!r[a])return Object(m.i)().assertConditionTag(!1,"Expected draft to be present on update current mentionees",593764363),e;var s=r[a].selectedTaskAssignee,c=!!s&&t.payload.users.find((function(e){return Object(S.i)(e,s)})),d=Object(l.__assign)(Object(l.__assign)({},r),((n={})[a]=Object(l.__assign)(Object(l.__assign)({},r[a]),{currentMentionees_deprecated:t.payload.users,selectedTaskAssignee:c?s:void 0}),n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:d})}}(e,t);case V.a.UpdateMentioneesStillInDraftType:return function(e,t){var n,i=z.A(e.draftState);if(void 0===i)return Object(m.i)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=i.sessionConfiguration;if(Object(T.b)(o))return e;var a=e.draftState.drafts[o.draftId];if(!a)return Object(m.i)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var r=a.currentMentionees,s={};for(var c in r)s[c]={mentionee:Object(l.__assign)({},r[c].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(c)};var d=a.selectedTaskAssignee;if(d){var u=Object(S.f)(d);s[u]&&s[u].stillInDraft||(d=void 0)}var f=Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:s,selectedTaskAssignee:d}),n))});return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:f}}(e,t);case V.a.AddToCurrentMentioneesType:return function(e,t){var n,i=z.A(e.draftState);if(void 0===i)return Object(m.i)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var o=i.sessionConfiguration;if(Object(T.b)(o))return e;var a=e.draftState.drafts[o.draftId];if(!a)return Object(m.i)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var r=a.currentMentionees,s=Object(S.f)(t.payload.mentionee);if(r&&r[s])return e;var c={};for(var d in r)c[d]={mentionee:Object(l.__assign)({},r[d].mentionee),stillInDraft:r[d].stillInDraft};c[s]={mentionee:Object(l.__assign)({},t.payload.mentionee),stillInDraft:!0};var u=Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:c}),n))});return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:u}}(e,t);case V.a.UpdateSelectedTaskAssigneeType:return function(e,t){var n,i=z.A(e.draftState);if(void 0===i)return Object(m.i)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=i.sessionConfiguration;if(Object(T.b)(o))return e;var a=o.draftId,r=e.draftState.drafts;if(!r[a])return Object(m.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var s=Object(l.__assign)(Object(l.__assign)({},r),((n={})[a]=Object(l.__assign)(Object(l.__assign)({},r[a]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:s})}}(e,t);case V.a.ShowPostErrorUIType:return function(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),i=Object(l.__assign)({},e.postViewState);return i[t.payload.commentId]=n,{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,draftState:e.draftState,cardViewState:e.cardViewState,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,postViewState:i}}(e,t);case V.a.ClearPostErrorUIType:return function(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),i=Object(l.__assign)({},e.postViewState);return i[t.payload.commentId]=n,{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,draftState:e.draftState,cardViewState:e.cardViewState,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,postViewState:i}}(e,t);case V.a.UpdateDraftThreadType:return function(e,t){var n,i;if(!e.createdCommentLie)return e;if(e.createdCommentLie.draftId!==t.payload.draftId)return Object(m.i)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var o=Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie),{newComment:Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie.newComment),{anchorHintText:(n=t.payload.anchorHintText,null!=n?n:e.createdCommentLie.newComment.anchorHintText)}),index:(i=t.payload.insertIndex,null!=i?i:e.createdCommentLie.index)});return{draftState:e.draftState,commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,contextState:e.contextState,focusedComment:e.focusedComment,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,personaIconPropertiesMap:e.personaIconPropertiesMap,cardViewState:e.cardViewState,postViewState:e.postViewState,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,atMentionState:e.atMentionState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,createdCommentLie:o}}(e,t);case V.a.ViewContainerVisibilityChangedType:return function(e,t){var n=e.draftState,i=e.focusedComment;t.payload.visibilityState!==O.a.Visible&&!M.t()&&M.ob()&&(n=z.L(n,e.focusedComment),e.focusedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0&&(i=z.n(e.focusedComment,e.focusedComment.selectedCardId)));return n=z.S(n,(function(n){var i=e.draftState.drafts[n];return z.Q(i.renderContextType,t.payload.visibilityState)})),U(e.draftState,n,1),{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,focusedComment:i,draftState:n}}(e,t);case V.a.ViewContainerVisibilityChangedType_deprecated:return function(e,t){var n=z.S(e.draftState,(function(n){var i=e.draftState.drafts[n];return z.R(i.renderContextType,t.payload.visible)}));return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,suggestionsDetails:e.suggestionsDetails,draftState:n}}(e,t);case V.a.UpdateSuggestionsDetailsType:return function(e,t){if(!M.db())return e;return{commentData:e.commentData,pendingCommentLoad:e.pendingCommentLoad,createdCommentLie:e.createdCommentLie,contextState:e.contextState,highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,personaIconPropertiesMap:e.personaIconPropertiesMap,atMentionState:e.atMentionState,focusedComment:e.focusedComment,cardViewState:e.cardViewState,postViewState:e.postViewState,wasDataReceived_deprecated:e.wasDataReceived_deprecated,capabilities:e.capabilities,authToken:e.authToken,modelCapabilities:e.modelCapabilities,appLocale:e.appLocale,draftState:e.draftState,suggestionsDetails:t.payload.details}}(e,t);default:return e}}var Q=n(535),Z=n(156),X=n(165),$=n(255),ee=n(307),te=n(14);function ne(){Object(m.i)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function ie(e,t){switch(void 0===e&&(e={viewContainer:{closeView:ne,openView:ne,containerType:X.b.FullPane,moveFocusToCanvas_donotuse:ne},componentTree:new ee.a(w.a.FullPane,Z.a),visible_deprecated:!1,visibilityState:O.a.Closed,initializationStatus:$.a.NotInitialized,focusTypeAfterContextChange:void 0}),void 0===t&&(t=te.b),t.type){case te.a.ViewContainerChangedType:return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return{visible_deprecated:e.visible_deprecated,visibilityState:e.visibilityState,initializationStatus:e.initializationStatus,focusTypeAfterContextChange:e.focusTypeAfterContextChange,viewContainer:t.payload.viewContainer,componentTree:n?new ee.a(Object(x.a)(t.payload.viewContainer.containerType),e.componentTree.contextIdentifier,e.componentTree):e.componentTree}}(e,t);case te.a.ViewContainerVisibilityChangedType:return function(e,t){return{viewContainer:e.viewContainer,componentTree:e.componentTree,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:t.payload.visibilityState!==O.a.Closed||M.A()?e.initializationStatus:$.a.NotInitialized,visibilityState:t.payload.visibilityState,visible_deprecated:t.payload.visibilityState===O.a.Visible}}(e,t);case te.a.ViewContainerVisibilityChangedType_deprecated:return function(e,t){return{viewContainer:e.viewContainer,componentTree:e.componentTree,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:t.payload.visible||M.A()?e.initializationStatus:$.a.NotInitialized,visible_deprecated:t.payload.visible,visibilityState:t.payload.visible?O.a.Visible:O.a.Closed}}(e,t);case te.a.ViewContainerFoldableLayoutStateChangedType:return function(e,t){if(!M.eb())return{componentTree:e.componentTree,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:e.initializationStatus,visibilityState:e.visibilityState,visible_deprecated:e.visible_deprecated,viewContainer:e.viewContainer};var n=Object(l.__assign)(Object(l.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return{componentTree:e.componentTree,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:e.initializationStatus,visibilityState:e.visibilityState,visible_deprecated:e.visible_deprecated,viewContainer:n}}(e,t);case te.a.BeginViewInitialization:return function(e){return{viewContainer:e.viewContainer,componentTree:e.componentTree,visible_deprecated:e.visible_deprecated,visibilityState:e.visibilityState,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:$.a.Initializing}}(e);case te.a.EndViewInitialization:return function(e){return{viewContainer:e.viewContainer,componentTree:e.componentTree,visible_deprecated:e.visible_deprecated,visibilityState:e.visibilityState,focusTypeAfterContextChange:e.focusTypeAfterContextChange,initializationStatus:$.a.Initialized}}(e);case te.a.UpdateFocusTypeAfterContextChangeType:return function(e,t){return{viewContainer:e.viewContainer,componentTree:e.componentTree,visible_deprecated:e.visible_deprecated,visibilityState:e.visibilityState,initializationStatus:e.initializationStatus,focusTypeAfterContextChange:t.payload.focusTypeAfterContextChange}}(e,t);default:return e}}var oe=n(554),ae=void 0;function re(e,t){void 0===t&&(t=u.a),ae||(ae=Object(i.combineReducers)({paneState:ie,contentExtensions:Q.a,taskState:oe.b,commentState:J}));var n=ae(e,t);return d.a&&Object(s.e)("Comments Store: ACTION: ",t," STATE: ",n),n}var se=n(209),ce=n(103),de=n(30);var ue=n(10),le=function(){return{threadIdRequests:new Map,sequenceId:0}},me=function(e,t,n){return void 0===n&&(n=20),i=function(e){return function(t,n){var i,o,a=ue.d(e.getState());try{for(var r=Object(l.__values)(n),s=r.next();!s.done;s=r.next()){var c=s.value;a[c]&&a[c].loadState.state===q.a.Placeholder&&t.threadIdRequests.set(c,t.sequenceId++)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return t}}(e),o=function(e,t,n){return function(i){for(var o=Array.from(i.threadIdRequests.entries()).sort((function(e,t){var n=Object(l.__read)(e,2),i=(n[0],n[1]),o=Object(l.__read)(t,2);return o[0],i-o[1]})),a=[],r=ue.d(e.getState()),s=o.pop();s&&a.length<n;s=o.pop()){var c=Object(l.__read)(s,1)[0];i.threadIdRequests.delete(c),r[c]&&r[c].loadState.state===q.a.Placeholder&&a.push(c)}if(a.length&&e.dispatch(Object(te.q)({renderContextType:w.a.None,telemetryVisitor:t,trackback:m.h.reserveTag(594888212)},{threadIds:a})),i.threadIdRequests.size>0)return i}}(e,t,n),r=500,d=(a=le)(),u=function(){var e=o(d);e?(d=e,c=setTimeout(u,r)):(d=a(),c=void 0)},(f=function(e){d=i(d,e),c||s||(c=setTimeout(u,0)),c||(c=setTimeout(u,s||r))}).reset=function(){void 0!==c&&(clearTimeout(c),d=a(),c=void 0)},f;var i,o,a,r,s,c,d,u,f},fe=n(300),pe=n(25),he=n(102),Ce=n(536),ge=n(44);function ve(e,t,n){var i=e.getState(),o=Ce.a(i)[pe.d.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function ye(e,t,n,i){return"CREATE"===i&&ve(e,t,n)}function be(e,t){return 0===ue.f(t).lastContextChangeIncrement||ue.o(t)?pe.c.Disabled:(M.O()||ge.b(t))&&ge.a(t)?e===pe.d.Integrated?pe.c.Disabled:pe.c.Secondary:pe.c.Primary}function Te(e,t){var n=Ce.a(e)[t];n&&(n.controller.priority=n.priority)}var Ie=function(e){return function(t){return function(n){var i=e.getState().commentState.draftState.drafts;if(t(n),M.ob()){var o=e.getState().commentState.draftState.drafts;Object.keys(i).forEach((function(e){void 0===o[e]&&i[e].commentDraft.endDrafting()}))}}}},Se=n(142),Oe=n(358),De=n(479);function we(e){switch(e.type){case V.a.ApplyCommentChangesType:return{name:"ApplyCommentChangesAction",aggregationMode:m.a.OnSuccess};case V.a.BeginProcessingCommitType:return{name:"BeginProcessingCommitAction",aggregationMode:m.a.None};case V.a.CancelCommentCreateThreadType:return{name:"CancelCommentCreateThreadAction",aggregationMode:m.a.None};case V.a.CancelCommentPostEditType:return{name:"CancelCommentPostEditAction",aggregationMode:m.a.None};case V.a.CancelCommentReplyType:return{name:"CancelCommentReplyAction",aggregationMode:m.a.None};case V.a.ClearCommentSelectionType:return{name:"ClearCommentSelectionAction",aggregationMode:m.a.OnSuccess};case V.a.CommitDraftType:return{name:"CommitDraftAction",aggregationMode:m.a.None};case V.a.DisplayDraftWarningType:return{name:"DisplayDraftWarningAction",aggregationMode:m.a.None};case V.a.ReloadCommentsType:return{name:"ReloadCommentsAction",aggregationMode:m.a.OnSuccess};case V.a.RequestDeletePostType:return{name:"DeletePostAction",aggregationMode:m.a.None};case V.a.RequestDeleteThreadType:return{name:"DeleteThreadAction",aggregationMode:m.a.None,diagnosticLevel:m.b.NecessaryServiceDataEvent,logDocumentMetadata:m.e.Basic};case V.a.DispatchLoadThreadsType:return{name:"LoadThreadsAction",aggregationMode:m.a.OnSuccess};case V.a.RequestReopenThreadType:return{name:"ReopenThreadAction",aggregationMode:m.a.None};case V.a.RequestThreadResolveType:return{name:"ResolveThreadAction",aggregationMode:m.a.None,diagnosticLevel:m.b.NecessaryServiceDataEvent,logDocumentMetadata:m.e.Basic};case V.a.SelectCommentType:return{name:"SelectCommentAction",aggregationMode:m.a.None};case V.a.SelectFirstThreadInNextCommentContextType:return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:m.a.None};case V.a.SelectLastThreadInPreviousCommentContextType:return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:m.a.None};case V.a.SessionRequestStartedAndLockFocusType:return{name:"SessionRequestStartedAndLockFocusAction",aggregationMode:m.a.None};case V.a.ShowLowFidelityWarningType:return{name:"ShowLowFidelityWarningAction",aggregationMode:m.a.None};case V.a.UpdateDraftRenderContextType:return{name:"UpdateDraftRenderContext",aggregationMode:m.a.None};default:return}}var je=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===we(t)){var n=Object(m.i)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,m.a.None);n.addDataField(F.a.OperationType,t.type,m.c.SystemMetadata),n.addDataField(F.a.Trackback,t.actionDetail.trackback,m.c.SystemMetadata),n.failTag(593278723,Object(Se.a)(e))}!function(e){if(Object(Oe.a)(e))throw e;if(!Object(_.b)(e))throw Object(m.i)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+e+(e instanceof Error?"\n\nStack:\n"+e.stack:""),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(m.i)().assertConditionTag(!1,"Comments Error: "+e,595720020)}}(e)}}}};var Pe,xe=n(150),Ee=n(442);!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(Pe||(Pe={}));var Ae=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={}}return e.prototype.beginTracking=function(e,t,n,i){var o=i||Object(m.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,m.a.None);o.addDataField(F.a.OperationType,n,m.c.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(m.i)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,m.h.reserveTag(595907678))),this.performanceActivities[e]={activity:o,expectedChangeType:t}},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(m.i)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,m.h.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failTracker=function(e,t,n){var i=this.performanceActivities[e];i&&(i.activity.failTag(t,void 0!==n?n:-2130957541),delete this.performanceActivities[e])},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(i){n.performanceActivities[i].activity.failTag(e,void 0!==t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var i=this.performanceActivities[e];i&&(i.activity.addDataField("ExpectedChangeArrived",i.expectedChangeType===t?Pe.Yes:Pe.No,m.c.SystemMetadata),i.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];n.activity.addDataField("ExpectedChangeArrived",Pe.Unknown,m.c.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),ke=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(L.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType",te.a.ShowLowFidelityWarningType,m.c.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(m.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,m.a.None),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(L.b)(t);!this.activity||n===this.selectedCommentId&&Object(L.e)(t.focusDetails.editingSession)||(this.activity.addDataField(F.a.OperationType,e.type,m.c.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function _e(e,t){t?e.addDataField(F.a.AffectingTaskMetadata,!0,m.c.SystemMetadata):e.addDataField(F.a.AffectingTaskMetadata,!1,m.c.SystemMetadata)}function Re(e,t,n){var i,o,a=t.find((function(e){return e.commentId===n})),r=(null===(i=a)||void 0===i?void 0:i.parentId)||(null===(o=a)||void 0===o?void 0:o.commentId);t.some((function(e){return(e.commentId===r||e.parentId===r)&&0!=(e.commentFlags&f.d.IsNew)}))&&r&&e.addDataField(F.a.CommentIsNew,r,m.c.SystemMetadata)}var Me=function(e){var t=new Ae(e),n=new ke(e);return function(e){return function(i){return function(o){var a,r,c=function(){var t,n,a,r,s,c,d=we(o);if(!d)return Object(m.i)().assertConditionTag(!1,"Event name not defined for action type: "+o.type,595616738),i(o);var u=Object(m.i)().createActivityObject(d.name,o.actionDetail.telemetryVisitor,d.aggregationMode,d.diagnosticLevel);u.addDataField(F.a.Trackback,o.actionDetail.trackback,m.c.SystemMetadata),u.addDataField(F.a.RenderContextType,o.actionDetail.renderContextType,m.c.SystemMetadata),d.logDocumentMetadata&&u.addDocumentMetadata(d.logDocumentMetadata);var l=function(e,t){u.addDataField(F.a.CommentId,t,m.c.SystemMetadata);var n=Object(z.d)(e,t);n.valid&&(u.addDataField(F.a.MatchesCommentAuthor,n.matchesCurrentUser,m.c.SystemMetadata),u.addDataField(F.a.CommentCreationTimeDeltaMs,n.timeElapsed,m.c.SystemMetadata)),M.h()&&Re(u,e,t)},f=e.getState(),p=fe.b(e.getState());switch(o.type){case V.a.CommentContextChangedType:u.addDataField(F.a.NumberOfThreads,o.payload.numberOfThreads,m.c.SystemMetadata),o.payload.virtualized||u.addDataField(F.a.NumberOfComments,o.payload.numberOfComments,m.c.SystemMetadata);break;case V.a.CommitDraftType:var h=function(e){if(e.type===V.a.CommitDraftType)return{name:"CommitDraft"+Object(De.b)(e.payload)+"Action",aggregationMode:m.a.None}}(o);if(!h)return Object(m.i)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),i(o);var C=Object(m.i)().createActivityObject(h.name,o.actionDetail.telemetryVisitor,m.a.None);C.addDataField(F.a.RenderContextType,o.actionDetail.renderContextType,m.c.SystemMetadata),C.successTag(595903074);var g=v.b[o.payload.sessionType];u.addDataField(F.a.SessionType,g,m.c.SystemMetadata),M.h()&&"REPLY"===o.payload.sessionType&&Re(u,ue.e(f),o.payload.data.parentId);break;case V.a.DisplayDraftWarningType:u.addDataField(F.a.DraftWarningType,o.payload.draftWarningType,m.c.SystemMetadata),u.addDataField(F.a.DraftWarningReason,o.payload.draftWarningReason,m.c.SystemMetadata);var y=Object(z.B)(f.commentState.draftState);y&&u.addDataField(F.a.IsDraftInCurrentContext,y.isInCurrentContext,m.c.SystemMetadata);break;case V.a.UpdateDraftRenderContextType:u.addDataField(F.a.IsClaimingDraftLock,o.payload.isClaimingLock,m.c.SystemMetadata),u.addDataField(F.a.IsUpdatingAllDraftLocks,!o.payload.draftId,m.c.SystemMetadata);break;case V.a.SelectCommentType:u.addDataField(F.a.SelectType,te.c[o.payload.focusType],m.c.SystemMetadata),u.addDataField(F.a.ActionSource,de.a[o.payload.source],m.c.SystemMetadata);var b=ue.j(f),T=!(!b||b.selectedCardId!==o.payload.selectedCard);u.addDataField(F.a.IsCurrentCard,T,m.c.SystemMetadata),M.h()&&(T||Re(u,ue.e(f),o.payload.selectedCard));break;case V.a.RequestThreadResolveType:case V.a.RequestReopenThreadType:if(_e(u,o.payload.isTask),l(ue.e(f),o.payload.commentId),o.payload.isTask){var I=o.type===V.a.RequestThreadResolveType?F.a.ResolveThreadWithTask:F.a.ReopenThreadWithTask;u.addDataField(I,!0,m.c.SystemMetadata,m.d.Critical);var S=null===(a=null===(n=null===(t=p[o.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===a?void 0:a.time;u.addDataField(F.a.TaskCreationTimeDeltaMs,S?Date.now()-S.getTime():0,m.c.SystemMetadata,m.d.Critical)}break;case V.a.RequestDeleteThreadType:if(_e(u,o.payload.isTask),o.payload.isTask){u.addDataField(F.a.DeleteThreadWithTask,!0,m.c.SystemMetadata,m.d.Critical);S=null===(c=null===(s=null===(r=p[o.payload.commentId])||void 0===r?void 0:r.history[0])||void 0===s?void 0:s.records[0])||void 0===c?void 0:c.time;u.addDataField(F.a.TaskCreationTimeDeltaMs,S?Date.now()-S.getTime():0,m.c.SystemMetadata,m.d.Critical)}l(ue.e(f),o.payload.commentId);break;case V.a.RequestDeletePostType:l(ue.e(f),o.payload.commentId);break;case V.a.ReloadCommentsType:u.addDataField(F.a.NumberOfThreads,o.payload.numberOfThreads,m.c.SystemMetadata)}try{var O=e.getState(),D=i(o),w=e.getState(),j=ue.i(O),P=ue.i(w);switch(o.type){case V.a.UpdateDraftRenderContextType:var x=o.payload.draftId?j.drafts[o.payload.draftId]:Object(z.B)(j),E=o.payload.draftId?P.drafts[o.payload.draftId]:Object(z.B)(P),A=void 0!==x&&void 0!==E&&x.renderContextType!==E.renderContextType;u.addDataField(F.a.DidDraftLockUpdate,A,m.c.SystemMetadata)}return u.successTag(595616739),D}catch(e){throw u.failTag(595616768,Object(Se.a)(e,-2130957541)),e}};switch(o.type){case V.a.BeginProcessingCommitType:var d=Object(m.i)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,m.a.None);try{c()}catch(e){throw d.failTag(595687567,Object(Se.a)(e,-2130957541)),e}if(!(u=Object(z.A)(ue.i(e.getState())))){d.failTag(595687569,-2130957541);break}t.beginTracking(u.sessionConfiguration.draftId,v.a[u.sessionConfiguration.sessionType],u.sessionConfiguration.sessionType,d);break;case V.a.CommitFailureType:var u=Object(z.A)(ue.i(e.getState()));Object(m.i)().assertConditionTag(!!u,"Draft should exist when failing a commit.",595132701),u&&t.failTracker(u.sessionConfiguration.draftId,m.h.reserveTag(595132702)),i(o);break;case V.a.RequestThreadResolveType:case V.a.RequestReopenThreadType:t.beginTracking(o.payload.commentId,p.a.Modify,o.type);try{c()}catch(e){throw t.failTracker(o.payload.commentId,m.h.reserveTag(595907670),Object(Se.a)(e,-2130957541)),e}break;case V.a.RequestDeletePostType:case V.a.RequestDeleteThreadType:t.beginTracking(o.payload.commentId,p.a.Delete,o.type);try{c()}catch(e){throw t.failTracker(o.payload.commentId,m.h.reserveTag(595907671),Object(Se.a)(e,-2130957541)),e}break;case V.a.CommentContextChangedType:try{i(o)}catch(e){throw t.failAllTrackers(m.h.reserveTag(595731294),Object(Se.a)(e,-2130957541)),e}break;case V.a.LoadCommentType:case V.a.LoadVirtualizedCommentsType:if(!t.getTracker("LoadCommentTracker",p.a.Load)){d=Object(m.i)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,m.a.None);t.beginTracking("LoadCommentTracker",p.a.Load,o.type,d)}i(o);break;case V.a.ReloadCommentsType:if(!t.getTracker("LoadCommentTracker",p.a.Load)){d=Object(m.i)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,m.a.None);t.beginTracking("LoadCommentTracker",p.a.Load,o.type,d)}try{c()}catch(e){throw t.failAllTrackers(m.h.reserveTag(595907672),Object(Se.a)(e,-2130957541)),e}t.endAllTrackers(m.h.reserveTag(595907673));break;case V.a.OnInitialRenderType:var f=t.getTracker("LoadCommentTracker",p.a.Load);f&&(o.payload.commentId&&f.activity.addDataField(F.a.AssociatedCommentId,o.payload.commentId,m.c.SystemMetadata),t.endTracker("LoadCommentTracker",p.a.Load,m.h.reserveTag(595646476))),i(o);break;case V.a.ApplyCommentChangesType:try{c()}catch(e){throw t.failAllTrackers(m.h.reserveTag(595907674),Object(Se.a)(e,-2130957541)),e}try{for(var h=Object(l.__values)(o.payload.changes),C=h.next();!C.done;C=h.next()){var g=C.value;if(g.type===p.a.Load||g.type===p.a.Unknown)break;if(g.type!==p.a.Delete&&g.type!==p.a.Modify){if(g.type===p.a.Insert){void 0!==g.tempId&&""===g.model.parentId&&B(g.tempId,g.model.commentId,o.actionDetail.telemetryVisitor);var y=g.tempId||g.model.parentId;void 0!==y&&t.endTracker(y,g.type,m.h.reserveTag(595857620))}}else t.endTracker(g.model.commentId,g.type,m.h.reserveTag(595907675))}}catch(e){a={error:e}}finally{try{C&&!C.done&&(r=h.return)&&r.call(h)}finally{if(a)throw a.error}}break;case V.a.CommitDraftType:u=Object(z.A)(ue.i(e.getState()));if(c(),o.payload.data.temporaryCommentId&&u)switch(u.sessionConfiguration.sessionType){case"CREATE":!function(e,t,n){B(e,t,n)}(u.sessionConfiguration.draftId,o.payload.data.temporaryCommentId,o.actionDetail.telemetryVisitor),t.updateTrackerId(u.sessionConfiguration.draftId,o.payload.data.temporaryCommentId);break;case"REPLY":t.updateTrackerId(u.sessionConfiguration.draftId,u.sessionConfiguration.threadId);break;case"EDIT":t.updateTrackerId(u.sessionConfiguration.draftId,u.sessionConfiguration.commentId);break;case"METADATA":t.updateTrackerId(u.sessionConfiguration.draftId,u.sessionConfiguration.threadId)}break;case V.a.DispatchLoadThreadsType:case V.a.CancelCommentCreateThreadType:case V.a.CancelCommentPostEditType:case V.a.CancelCommentReplyType:case V.a.SelectFirstThreadInNextCommentContextType:case V.a.SelectLastThreadInPreviousCommentContextType:case V.a.SessionRequestStartedAndLockFocusType:case V.a.UpdateDraftRenderContextType:case V.a.ClearCommentSelectionType:case V.a.SelectCommentType:case V.a.DisplayDraftWarningType:c();break;case V.a.ShowLowFidelityWarningType:c();var b=ue.j(e.getState());b&&n.beginTracking(b);break;case V.a.ViewContainerVisibilityChangedType_deprecated:var T=Object(m.i)().createActivityObject(o.payload.visible?"ViewContainerOpened":"ViewContainerClosed",o.actionDetail.telemetryVisitor,m.a.Always);i(o),T.successTag(592511449);break;case V.a.ViewContainerVisibilityChangedType:var I="";switch(o.payload.visibilityState){case O.a.Closed:I="ViewContainerClosed";break;case O.a.Hidden:I="ViewContainerHidden";break;case O.a.Visible:I="ViewContainerVisible";break;default:Object(s.h)(o.payload.visibilityState)}T=Object(m.i)().createActivityObject(I,o.actionDetail.telemetryVisitor,m.a.Always);i(o),T.successTag(592241220);break;default:i(o)}var S=ue.j(e.getState());S&&n.endTrackingIfWarningDismissed(o,S)}}}},Ve=n(211),Fe=n(324),Le=function(e){return function(e){return function(t){return function(n){switch(n.type){case te.a.RequestShowPaneType:(i=ge.d(e.getState())).openView();break;case te.a.RequestClosePaneType:(i=ge.d(e.getState())).closeView();break;case te.a.MoveFocusToCanvasType:if(!M.xb())(i=ge.d(e.getState())).moveFocusToCanvas_donotuse();break;case te.a.RequestModalConfirmationType:(i=ge.d(e.getState())).invokeModalConfirmationDialog?i.invokeModalConfirmationDialog(n.payload.onConfirm,n.payload.onCancel,n.payload.displayStrings):(Object(m.i)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),i.closeView());break;case te.a.RequestDisplayConfigurationType:var i=ge.d(e.getState());Object(Fe.a)(i)&&Object(Ve.b)(n.payload.displayConfig)?n.payload.completion=i.setDisplayConfiguration(n.payload.displayConfig):n.payload.completion=Promise.reject();break;case te.a.ReadyToRenderType:(i=ge.d(e.getState())).onReadyToRender&&i.onReadyToRender();break;case te.a.BeginDraftingSuccessType:i=ge.d(e.getState());if(Object(Fe.a)(i)){if("CREATE"===(Object(y.a)(n.payload.draftDetails)?n.payload.draftDetails.sessionConfiguration.sessionType:n.payload.draftDetails.sessionType))return i.setDisplayConfiguration({displayMode:Ve.a.Variable,desiredHeight:0}).then((function(){return t(n)}))}M.qb()?Ne(e.getState(),i):!M.A()||ge.b(e.getState())||M.t()||i.openView();break;case te.a.DisplayDraftWarningType:M.qb()&&Ne(e.getState());break;case te.a.CancelCommentCreateThreadType:case te.a.CancelCommentPostEditType:case te.a.CancelCommentReplyType:if(n.payload.closeOnDiscard){i=ge.d(e.getState());return t(n),void i.closeView()}}var o=e.getState(),a=t(n);return function(e,t){var n=ge.d(t);if(!Object(Fe.a)(n))return;var i=ue.j(t),o=ue.j(e),a=Object(L.h)(i),r=Object(L.h)(o),s=ue.g(t),c=ue.g(e);(a!==r||!Object(Fe.a)(ge.d(e))||!s&&c)&&(a?i&&s&&i.selectedCardId===s.draftId||n.setDisplayConfiguration({displayMode:Ve.a.FullScreen}).catch((function(e){Object(_.b)(e)?Object(m.i)().assertConditionTag(!1,e.message,593278721):Object(m.i)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to FullScreen "+e,593278722)})):s?n.setDisplayConfiguration({displayMode:Ve.a.Variable,desiredHeight:0}).catch((function(e){Object(_.b)(e)?Object(m.i)().assertConditionTag(!1,e.message,593278689):Object(m.i)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to Variable "+e,593278690)})):n.setDisplayConfiguration({displayMode:Ve.a.Normal}).catch((function(e){Object(_.b)(e)?Object(m.i)().assertConditionTag(!1,e.message,593278691):Object(m.i)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to Normal "+e,593278720)})))}(o,e.getState()),a}}}};function Ne(e,t){!M.A()||ge.b(e)||M.t()||(t||ge.d(e)).openView()}function Ue(e,t,n,a,s,d){var u=Object(i.compose)(Object(i.applyMiddleware)(c,r,o.default,je,Me(a),function(e,t){return function(n){var i=me(n,t);return function(t){return function(o){var a,r,s;switch(o.type){case V.a.CommentContextChangedType:i.reset();break;case V.a.CancelCommentCreateThreadType:case V.a.CancelCommentReplyType:case V.a.CancelCommentPostEditType:if(!M.ob()){var c=n.getState(),d=z.A(ue.i(c));void 0!==d&&d.endDrafting()}break;case V.a.ClearCommentHighlightType:o.payload.actionSource===de.a.SharedComments&&e.highlightComment("");break;case V.a.DisplayDraftWarningType:t(o);var u=n.getState(),l=ue.j(u);if(M.K()&&l&&Object(L.i)(l.focusDetails))M.xb()&&M.j()||e.selectComment(l.selectedCardId);return;case V.a.CommitDraftType:var f=n.getState(),p=fe.b(n.getState()),h=z.A(ue.i(f));if(void 0!==h){if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var C=void 0;h.sessionConfiguration.sessionType!==ce.a&&h.sessionConfiguration.sessionType!==ce.b&&(C=p[h.sessionConfiguration.threadId]&&p[h.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=C,h.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=h.commit(o.payload.data.commentBody);var g=t(o);return M.ob()||h.endDrafting(),g}break;case V.a.QueueLoadThreadsType:var y=n.getState();return z.D(ue.n(y),ue.u(y))?void i(o.payload.threadIds):void Object(m.i)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case V.a.DispatchLoadThreadsType:var b=n.getState();if(!z.D(ue.n(b),ue.u(b)))return;e.loadThreads(o.payload.threadIds);break;case V.a.SessionRequestStartedAndLockFocusType:Object(v.f)(o.payload.params)&&e.selectComment(o.payload.params.threadId);break;case V.a.HighlightCommentType:o.payload.actionSource===de.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case V.a.RequestDeletePostType:var T=n.getState(),I=ue.j(T);if(I&&!Object(L.c)(I.focusDetails)&&I.focusDetails.selectedPostId===o.payload.commentId&&Object(L.i)(I.focusDetails))return;e.deleteComment(o.payload.commentId);break;case V.a.RequestDeleteThreadType:e.deleteComment(o.payload.commentId);break;case V.a.RequestThreadResolveType:if(M.b()&&Object(se.c)(e))e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=fe.b(n.getState())[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch((function(e){Object(_.b)(e)?Object(m.i)().assertConditionTag(!1,e.message,593768922):Object(m.i)().assertConditionTag(!1,"Unknown error in CommentAPIMiddleware "+e,593768923)}));else e.setThreadResolvedState(o.payload.commentId,!0);break;case V.a.RequestReopenThreadType:if(M.b()&&Object(se.c)(e))e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=fe.b(n.getState())[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch((function(e){Object(_.b)(e)?Object(m.i)().assertConditionTag(!1,e.message,593768924):Object(m.i)().assertConditionTag(!1,"Unknown error in CommentAPIMiddleware "+e,593768925)}));else e.setThreadResolvedState(o.payload.commentId,!1);break;case V.a.SelectFirstThreadInNextCommentContextType:e.selectFirstThreadInNextCommentContext();break;case V.a.SelectLastThreadInPreviousCommentContextType:e.selectLastThreadInPreviousCommentContext();break;case V.a.SelectCommentType:var S=n.getState(),O=ue.g(S),D=O&&O.draftId;if(M.j()||o.payload.source===de.a.SharedComments&&o.payload.selectedCard!==D&&z.P(ue.j(S),o)&&e.selectComment(o.payload.selectedCard),t(o),M.j()){var w=n.getState(),j=ue.j(S),P=ue.j(w);o.payload.source===de.a.SharedComments&&P&&(null===(a=j)||void 0===a?void 0:a.selectedCardId)!==(null===(r=P)||void 0===r?void 0:r.selectedCardId)&&e.selectComment(P?null===(s=P)||void 0===s?void 0:s.selectedCardId:"")}return;case V.a.ReloadCommentsType:case V.a.ApplyCommentChangesType:if(!M.ob()){var x=n.getState();if(t(o),(A=ue.j(x))&&A.focusDetails.editingSession!==L.a.None)if(!(R=ue.j(n.getState()))||R.focusDetails.editingSession===L.a.None){var E=z.A(ue.i(x));void 0!==E&&E.endDrafting()}return}break;case V.a.ShowLowFidelityWarningType:var A,k=(A=ue.j(n.getState()))?A.selectedCardId:void 0;t(o);var R,F=(R=ue.j(n.getState()))?R.selectedCardId:void 0;return void(F&&F!==k&&e.selectComment(F))}return t(o)}}}}(e,a),Ie,Le(),function(e){return function(t){return function(t){return function(n){switch(n.type){case te.a.DisplayDraftWarningType:Object(xe.b)(Ee.e(e,n.payload.draftWarningType))}return t(n)}}}}(d),function(e,t){return function(n){return function(i){return function(o){var a,r,s;switch(o.type){case te.a.AddContentExtensionType:o.payload.extension.priority=be(o.payload.extension.provider.scope.renderMode,n.getState());break;case te.a.RemoveContentExtensionType:try{for(var c=Object(l.__values)(o.payload.renderModes),d=c.next();!d.done;d=c.next()){var u=d.value,f=Ce.a(n.getState())[u];f&&f.controller.unregisterExtension()}}catch(e){a={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(a)throw a.error}}break;case te.a.UpdateExtensionPriorityType:i(o),Te(n.getState(),pe.d.Integrated),Te(n.getState(),pe.d.Isolated);break;case te.a.ApplyCommentChangesType:case te.a.CancelCommentCreateThreadType:if(M.vb()&&ve(n,o,i))return;break;case te.a.CommentContextChangedType:case te.a.LoadCommentType:case te.a.LoadVirtualizedCommentsType:case te.a.ReloadCommentsType:case te.a.ViewContainerVisibilityChangedType:case te.a.ViewContainerVisibilityChangedType_deprecated:return i(o),void n.dispatch(Object(te.T)({renderContextType:w.a.None,telemetryVisitor:t,trackback:m.h.reserveTag(594834319)},(s={},s[pe.d.Integrated]=be(pe.d.Integrated,n.getState()),s[pe.d.Isolated]=be(pe.d.Isolated,n.getState()),s)));case te.a.BeginDraftingSuccessType:var p=o.payload.draftDetails,h=Object(y.a)(p)?p.sessionConfiguration:p;if(ye(n,o,i,h.sessionType))return;break;case te.a.BeginDraftingFailureType:if(ye(n,o,i,o.payload.beginDraftingParams.sessionType))return;break;case te.a.UpdateDraftRenderContextType:if(o.payload.isClaimingLock||o.actionDetail.renderContextType===w.a.DiscreteIsolated)break;if((C=Object(z.A)(ue.i(n.getState())))&&ye(n,o,i,C.sessionConfiguration.sessionType))return;break;case te.a.SelectContentType:if(!M.j())return e.selectNextOrPreviousContent(o.payload.selectDirection,o.payload.from),i(o);break;case te.a.MoveFocusToCanvasType:if(!M.j()&&M.xb())return e.moveFocus({region:he.a.Canvas,resource:o.payload.resource}),i(o);break;case te.a.ViewContainerVisibilityChangedType_deprecated:if(!o.payload.visible)if((C=Object(z.A)(ue.i(n.getState())))&&ye(n,o,i,C.sessionConfiguration.sessionType))return;break;case te.a.ViewContainerVisibilityChangedType:var C;if(o.payload.visibilityState===O.a.Closed)if((C=Object(z.A)(ue.i(n.getState())))&&ye(n,o,i,C.sessionConfiguration.sessionType))return}return i(o)}}}}(s,a),function(e){return function(t){return function(n){return function(i){var o;if(!(M.xb()&&M.j()))return n(i);n(i);var a=t.getState();switch(i.type){case te.a.DisplayDraftWarningType:var r=ue.j(a);M.K()&&r&&Object(L.i)(r.focusDetails)&&e.bringContentIntoView({contentIdentifier:{contentId:r.selectedCardId,contentType:pe.b.CommentThread}});break;case te.a.SelectCommentType:var s=ue.j(a),c=s&&Object(L.i)(s.focusDetails);i.payload.source===de.a.SharedComments&&c&&s&&e.bringContentIntoView({contentIdentifier:{contentId:s.selectedCardId,contentType:pe.b.CommentThread}});break;case te.a.ViewContainerVisibilityChangedType:var d=ge.a(a),u=(r=ue.j(a),ue.r(a));r&&!d&&Object(L.i)(r.focusDetails)&&(null===(o=u)||void 0===o?void 0:o.isInCurrentContext)&&e.bringContentIntoView({contentIdentifier:{contentId:r.selectedCardId,contentType:pe.b.CommentThread}});break;case te.a.SelectContentType:e.selectNextOrPreviousContent(i.payload.selectDirection,i.payload.from);break;case te.a.MoveFocusToCanvasType:e.moveFocus({region:he.a.Canvas,resource:i.payload.resource})}}}}}(s)));return Object(i.createStore)(re,n,u)}n.d(t,"a",(function(){return Ue}))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o=n(1),a=n(0);function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!i)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return i((function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return e.apply(void 0,Object(a.__spreadArrays)(n,t))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!i)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return i((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i)throw new Error("Recursive calls of hooks is not supported!");i=e;var o=s.apply(void 0,t);return i=void 0,o}}n.d(t,"a",(function(){return u}));var d,u={useMemo:c(o.useMemo),useEffect:c(o.useEffect),useLayoutEffect:c(o.useLayoutEffect),useCallback:(d=o.useCallback,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(i)throw new Error("Recursive calls of hooks is not supported!");i=d;var n=r.apply(void 0,e);return i=void 0,n})}},,,,,,,,,,,,,,,,,,,function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(931);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var i=n(751),o=n(753),a=n(932);e.exports=function(e){return function(t,n,r){var s,c=i(t),d=o(c.length),u=a(r,d);if(e&&n!=n){for(;d>u;)if((s=c[u++])!=s)return!0}else for(;d>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){var i=n(577),o=n(578);e.exports=function(e){return i(o(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(754),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i=n(756)("unscopables"),o=Array.prototype;null==o[i]&&n(574)(o,i,{}),e.exports=function(e){o[i][e]=!0}},function(e,t,n){var i=n(576)("wks"),o=n(575),a=n(388).Symbol,r="function"==typeof a;(e.exports=function(e){return i[e]||(i[e]=r&&a[e]||(r?a:o)("Symbol."+e))}).store=i},function(e,t,n){"use strict";var i=n(758);n.o(i,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return i.initializeRuntime})),n.o(i,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return i.instantiateSharedComments})),n.o(i,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return i.renderCommentPaneWithAppInfo}))},function(e,t,n){"use strict";var i=n(759);n.o(i,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return i.initializeRuntime})),n.o(i,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return i.instantiateSharedComments})),n.o(i,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return i.renderCommentPaneWithAppInfo}))},function(e,t){},function(e,t,n){"use strict";n(639)},function(e,t,n){"use strict";var i=n(762);n.o(i,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return i.initializeRuntime})),n.o(i,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return i.instantiateSharedComments})),n.o(i,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return i.renderCommentPaneWithAppInfo}))},function(e,t,n){"use strict";var i=n(763);n.o(i,"initializeRuntime")&&n.d(t,"initializeRuntime",(function(){return i.initializeRuntime})),n.o(i,"instantiateSharedComments")&&n.d(t,"instantiateSharedComments",(function(){return i.instantiateSharedComments})),n.o(i,"renderCommentPaneWithAppInfo")&&n.d(t,"renderCommentPaneWithAppInfo",(function(){return i.renderCommentPaneWithAppInfo}))},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));n(765),n(767);var i=n(156),o=n(29),a=n(3),r=n(102),s=n(86),c=n(1),d=n(42),u=n(209),l=n(349),m=n(550),f=n(189),p=n(253),h=n(549),C=n(551),g=n(317),v=n(20),y=n(552),b=n(548),T=n(531),I=n(532),S=n(176),O=n(533);function D(e,t,n,D,w,j,P,x,E,A){Object(S.b)(O.a),Object(o.b)({appSettings:x||{},mapping:y.a}),Object(a.k)(I.a,n());var k,_=Object(l.b)(j);s.c(_.getLocaleInfo().isRightToLeft),Object(T.a)(),Object(a.i)().assertConditionTag(!!x,"appSettings should not be undefined",591005569),Object(u.b)(t()),Object(f.b)(A),Object(h.a)(),Object(g.c)("CommentHost").then((function(t){k=t,Object(d.render)(c.createElement(k.default,{apiContext:i.a,getCommentAPI:u.a,viewContainerAPI:Object(b.a)(i.a,w),peopleAPI:D?D():new C.a,contentNavigationAPI:new r.c,localizationAPI:_,themeAPI:new m.a,initializationReason:P||p.a.PaneOpen,useMockCommentPane:!1}),document.getElementById(e)),E&&E()})).catch((function(e){Object(v.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,591005570):Object(a.i)().assertConditionTag(!1,"Unknown error in renderCommentPaneWithAppInfo on delayLoadSharedCommentsUI "+e,591005571)}))}},function(e,t,n){n(937),e.exports=n(311).Array.findIndex},function(e,t,n){var i=n(578);e.exports=function(e){return Object(i(e))}},function(e,t,n){n(942),e.exports=n(311).Object.assign},function(e,t,n){"use strict";var i=n(254),o=function(e){this.onMockUIAction=new i.EventImpl((function(){}))};t.a=o},function(e,t,n){"use strict";var i=n(970).SharedCommentsVersion;t.a=i},,,function(e,t,n){"use strict";var i;!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(i||(i={})),t.a=i},function(e,t,n){"use strict"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n(156),o=n(29),a=n(3),r=n(25),s=n(86),c=(n(765),n(767),n(209)),d=n(349),u=n(189),l=n(413),m=n(253),f=n(549),p=n(20),h=n(78),C=n(552),g=n(8),v=n(548),y=n(338),b=n(531),T=n(532),I=n(540),S=n(176),O=n(491),D=n(533);function w(e,t,n,w,j,P,x,E){try{try{if(Object(I.a)())return void Object(a.i)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(p.b)(e))throw e}if(Object(S.b)(D.a),Object(o.b)({appSettings:x||{},mapping:C.a}),Object(a.k)(T.a,t),Object(a.i)().assertConditionTag(!!x,"appSettings should not be undefined",595616278),!g.t)throw Object(a.i)().assertConditionTag(!1,"Instantiate should only be used when DHCs are enabled!",595896459),new p.a(h.p,-2130957516);var A=Object(d.b)(j);s.c(A.getLocaleInfo().isRightToLeft),Object(b.a)(),Object(c.b)(e);var k=e,_=Object(v.a)(i.a,(function(){return w})),R=Object(y.a)();S.a.ensureViewManager({apiContext:i.a,displayMode:l.b.FullPane,foldableLayoutState:l.a.Indeterminate,initializationReason:P||m.a.PaneOpen,correlationId:R,viewContainerProvider:_,peopleAPI:n,hostCommentAPI:k,paneVisible:!1,initializeImmediately:!1}),Object(u.b)(E),Object(f.a)(),Object(r.e)().onExtensionFirstRequested.subscribe((function(e){e.contentType===r.b.CommentThread&&Object(O.a)()}))}catch(e){throw Object(p.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,594367139):Object(a.i)().assertConditionTag(!1,"Unknown error in ClientViewContainer constructor "+e,594367168),e}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o=n(0),a=n(55),r=n(3),s=n(231),c=n(25),d=n(376),u=n(84),l=n(298),m=n(109),f=n(129),p=n(83),h=n(66),C=n(76),g=n(232),v=n(227),y=n(155),b=n(16),T=n(307),I=n(102),S=n(118),O=n(123),D=n(8),w=n(14),j=n(30),P=n(345),x=n(19),E=n(127),A=n(134),k=n(12),_=n(10),R=n(44),M=n(147);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ShouldRetry=1]="ShouldRetry",e[e.Handled=2]="Handled"}(i||(i={}));var V,F=n(132),L=n(140),N=n(145);function U(e,t){return{type:V.DispatchAction,action:t,causedBy:e}}function B(e){return e.type===V.FocusComponent&&void 0!==e.component}function z(e,t,n){return Object(o.__assign)({type:V.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.FocusComponent=0]="FocusComponent",e[e.FocusTag=1]="FocusTag",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(V||(V={}));var H=n(162),W=n(381),G=n(38);function q(e,t,n){return t?n?{type:V.Compound,first:t,then:n,causedBy:e}:t:n}function Y(e,t){if(t)t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0);else if(e.shouldRetryOnMount)return i.ShouldRetry;return i.Handled}function K(e,t,n){if(!e)return i.NoCommand;var o=i.Handled;if(B(e)){var a=e.component;if(Object(G.c)(a))o=Y(e,t.getComponentById(a));else if(a.componentType!==G.a.Unknown){var r=a.componentType;o=Y(e,t.getComponent(r))}}else!function(e){return e.type===V.DispatchAction&&void 0!==e.action}(e)?function(e){return e.type===V.Compound&&void 0!==e.first&&void 0!==e.then}(e)&&(K(e.first,t,n),K(e.then,t,n)):n.dispatch(e.action);return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),o}var J=function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}(),Q=function(e){function t(t){var n=e.call(this,t)||this,i=t.nativeEvent,o=i.altKey,a=i.shiftKey,r=i.ctrlKey,s=i.metaKey,c=i.key;return n.altKey=o,n.shiftKey=a,n.ctrlKey=r,n.metaKey=s,n.key=Object(S.f)(c),n}return Object(o.__extends)(t,e),t}(J);function Z(e,t,n){var i=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return n.apply(void 0,Object(o.__spread)([e],t))},a=function(n){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];var s=i.apply(void 0,Object(o.__spread)([n],a)),c=K(s,n,e);t(s,c)};return a.processCommand=i,a}var X=[];function $(e,t,n,i){var a=function(t,n){var i,a=Object(o.__read)(n),s=a[0],c=a.slice(1),d=s();K(r.apply(void 0,Object(o.__spread)([(i=t,new Q(i)),d],c)),d,e)},r=function(e,a){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];if(n(a)){var c=Object(S.d)(Object(S.f)(e.key),t),d=i[S.b[c]];return d?d.handler.apply(d,Object(o.__spread)([e,a],r)):void 0}};if(D.W()){var s=Object.keys(i).map((function(e){return{key:e,eventPhase:i[e].phase}})),c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return a(t,e)},getKeyDownEvents:function(){return D.u()||n(e[0]())?s:X}}};return c.processEvent=r,c}var d=function(e){var t=Object(o.__read)(e,1)[0];return n(t())?u():[]},u=Object(W.a)((function(){return Object.keys(i).map((function(e){return{key:e,eventPhase:i[e].phase}}))})),l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){a(t,e)},getKeyDownEvents:function(){return d(e)}}};return l.processEvent=r,l}var ee=n(168),te=function(){function e(e,t,n,a){var s=this;this.commentStore=e,this.selectionCommandFactory=t,this.isRTL=n,this.telemetryVisitor=a,this.focusToRetry=void 0,this.commandExecuteCallback=function(e,t){e&&B(e)&&(t===i.ShouldRetry?s.focusToRetry={command:Object(o.__assign)(Object(o.__assign)({},e),{shouldRetryOnMount:!1}),timestamp:Date.now()}:s.focusToRetry=void 0)},this.commentContentsKeyDown=$(this.commentStore,this.isRTL,(function(){var e=_.j(s.commentStore.getState());return!e||!Object(k.h)(e)}),{ArrowDown:{handler:function(e,t,n){var i=s.onDownKey(e,t,n?n():void 0);return i&&(i.stopPropagation=!0,i.preventDefault=!0),i},phase:S.a.Bubbling},ArrowUp:{handler:function(e,t,n){var i=s.onUpKey(e,t,n?n():void 0);return i&&(i.stopPropagation=!0,i.preventDefault=!0),i},phase:S.a.Bubbling},ArrowRight:{handler:function(e,t,n){var i=s.onRightKey(e,t.renderContextType,n?n():void 0);return i&&(i.stopPropagation=!0,i.preventDefault=!0),i},phase:S.a.Bubbling},ArrowLeft:{handler:function(e,t){var n=s.onLeftKey(e,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:S.a.Bubbling},Tab:{handler:function(e,t){var n=s.onTabKey(e,t.renderContextType);return n&&(n.stopPropagation=!0),n},phase:S.a.None},Home:{handler:function(e,t){if(t.renderContextType===b.a.FullPane){var n=s.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,j.a.SharedComments,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:S.a.Capturing},End:{handler:function(e,t){if(t.renderContextType===b.a.FullPane){var n=s.selectionCommandFactory.selectLastThreadInCurrentContext(e,!1,j.a.SharedComments,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:S.a.Capturing},F12:{handler:function(e,t){var n=s.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:S.a.None}}),this.focusCommentCardCommand=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){var n=_.j(s.commentStore.getState());if(n&&n.selectedCardId===t){var i=s.checkForActiveEditorFocus(void 0,e.renderContextType,n);if(i)return i}var o=z(void 0,{componentType:Object(H.b)(t,_.g(s.commentStore.getState())),id:t,renderContextType:e.renderContextType});return o.preventScroll=e.renderContextType===b.a.DiscreteIntegrated,o})),this.focusCommentPostCommand=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){var n=_.j(s.commentStore.getState());if(n&&!Object(k.c)(n.focusDetails)&&n.focusDetails.selectedPostId===t){var i=s.checkForActiveEditorFocus(void 0,e.renderContextType,n);if(i)return i}return z(void 0,{componentType:G.a.Post,id:t,renderContextType:e.renderContextType})})),this.focusCommentPaneCommand=Z(this.commentStore,this.commandExecuteCallback,(function(e){if(Object(N.b)(e.renderContextType)){var t=_.j(s.commentStore.getState()),n=void 0;if(n=s.checkForActiveEditorFocus(void 0,e.renderContextType,t))return n;if(n=s.checkForCommentSelectionFocus(e.renderContextType,t,_.g(s.commentStore.getState())))return n;if(!D.J()){if(!e.getComponent(G.a.ClosePaneButton)){var i=_.e(s.commentStore.getState());return i.length>0?s.focusCommentCardCommand.processCommand(e,i[0].commentId):void Object(r.i)().assertConditionTag(Object(L.a)()===F.a.Windows||Object(L.a)()===F.a.iOS&&e.renderContextType===b.a.FullPane,"Shouldn't be reached on non-windows platforms",593802307)}return z(void 0,{componentType:G.a.ClosePaneButton})}return z(void 0,{componentType:G.a.NewCommentButton})}Object(r.i)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",593802306)})),this.focusActiveEditorCommand=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){var n=_.j(s.commentStore.getState());if(n&&n.focusDetails.editingSession===k.a.Active)switch(t.type){case"REPLY":case"CREATE":return z(void 0,{componentType:G.a.CardEditor,id:n.selectedCardId,renderContextType:e.renderContextType});case"EDIT":if(!Object(k.c)(n.focusDetails))return z(void 0,{componentType:G.a.PostEditor,id:n.focusDetails.selectedPostId,renderContextType:e.renderContextType});break;default:Object(r.i)().assertConditionTag(!1,"Unknown session type.",593802308)}})),this.commentCardMounted=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){var n;if(n=s.handleFocusRetry({componentType:Object(H.b)(t.id,_.g(s.commentStore.getState())),id:t.id,renderContextType:e.renderContextType}))return n;var i=Object(N.b)(e.renderContextType);return i&&!e.isFocusWithinPane()||!(i||e.isFocusWithinAny(G.a.Card)||e.isFocusWithinAny(G.a.DraftCard))?void 0:t.selected?s.focusCommentCardCommand.processCommand(e,t.id):void 0})),this.commentCardEditorMounted=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){return s.handleFocusRetry({componentType:G.a.CardEditor,id:t,renderContextType:e.renderContextType})})),this.commentPostEditorMounted=Z(this.commentStore,this.commandExecuteCallback,(function(e,t){return s.handleFocusRetry({componentType:G.a.PostEditor,id:t,renderContextType:e.renderContextType})})),this.commentPanePropsUpdated=Z(this.commentStore,this.commandExecuteCallback,(function(e,t,n){var i;if(i=s.checkIfCardEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))return i;if(i=s.checkIfPostEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))return i;if(i=s.checkForNewDraft(e.renderContextType,t.draftState,n.draftState))return i;var o=t.focusedCommentInfo&&t.focusedCommentInfo.focusedComment,a=n.focusedCommentInfo&&n.focusedCommentInfo.focusedComment;return(i=s.checkForDiscard(e,o,a))?i:e.isFocusWithinPane()?(i=s.checkForSelectionChange(e,o,a))||(i=s.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,n.createdCommentLie))||(i=s.checkForReplyFinished(e,o,a,a&&n.cardViewStates[a.selectedCardId]))?i:s.checkForLowFidelityWarning(e,o,a):void 0})),this.discreteCommentCardPropsUpdated=Z(this.commentStore,this.commandExecuteCallback,(function(e,t,n){return n.cardRelativeDraftingState===M.a.InCard&&s.shouldFocusDraftEditorForReturnToDraft(t.draftState.drafts[t.draftState.cardIdToDraftIdMap[t.threadId]],n.draftState.drafts[n.draftState.cardIdToDraftIdMap[n.threadId]])?Object(o.__assign)(Object(o.__assign)({},z(void 0,{renderContextType:e.renderContextType,componentType:G.a.CardEditor,id:n.threadId})),{shouldRetryOnMount:!0}):n.cardRelativeDraftingState===M.a.InChildPost&&(i=s.checkIfPostEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))?i:n.cardRelativeDraftingState!==M.a.InCard&&n.cardRelativeDraftingState!==M.a.InChildPost||!(i=s.checkForNewDraft(e.renderContextType,t.draftState,n.draftState))?(i=s.checkForDiscard(e,t.focusState,n.focusState))?i:e.isFocusWithinAny(G.a.Card)||e.isFocusWithinAny(G.a.DraftCard)?s.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?z(void 0,{renderContextType:e.renderContextType,componentType:Object(H.b)(n.isDraftThread),id:n.threadId}):(i=s.checkForSelectionChange(e,t.focusState,n.focusState))||(i=s.checkForReplyFinished(e,t.focusState,n.focusState,n.cardState))?i:s.checkForLowFidelityWarning(e,t.focusState,n.focusState):void 0:i;var i})),this.paneContainerKeyDown=$(this.commentStore,this.isRTL,(function(e){return!!Object(N.b)(e.renderContextType)||(Object(r.i)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",593802309),!1)}),{Escape:{handler:function(e,t){return U(e,w.B({renderContextType:t.renderContextType,trackback:r.h.reserveTag(593802310),telemetryVisitor:s.telemetryVisitor}))},phase:S.a.Capturing},Tab:{handler:function(e,t){if(Object(L.a)()!==F.a.Windows)return s.paneContainerTabHandling(e,t)},phase:S.a.None},ArrowDown:{handler:function(e,t){if(Object(L.a)()!==F.a.Windows){var n=s.onDownKey(e,t);return n&&(n.stopPropagation=!0),n}},phase:S.a.None},ArrowUp:{handler:function(e,t){if(Object(L.a)()!==F.a.Windows){var n=s.onUpKey(e,t);return n&&(n.stopPropagation=!0),n}},phase:S.a.None}}),this.commentEditorKeyDown=$(this.commentStore,this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var n=s.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:S.a.None}}),this.onUserAction=Z(this.commentStore,this.commandExecuteCallback,(function(e,t,n){if(e.renderContextType===b.a.FullPane)return t===ee.a.RequestNewCommentFromHost?z(void 0,{componentType:G.a.PaneRoot}):t===ee.a.DeleteThread||t===ee.a.CancelNewThreadDraft?void 0===n?(Object(r.i)().assertConditionTag(void 0!==n,"User action options are required",595121954),s.focusNewCommentButton(e)):n.isNewCommentButtonFocusable?s.focusNewCommentButton(e):s.selectionCommandFactory.focusAndSelectSiblingThread(e.renderContextType,n.threadIndex):void 0}))}return e.prototype.handleFocusRetry=function(e){if(this.focusToRetry){var t=Date.now()-this.focusToRetry.timestamp;if(t>15e3)return Object(r.i)().assertConditionTag(!1,"Took too long to mount component for focus retry: "+t+" ms",594060876),void(this.focusToRetry=void 0);var n=this.focusToRetry.command.component;if(Object(G.b)(n,e)){var i=this.focusToRetry.command;return this.focusToRetry=void 0,i}}},e.prototype.onDownKey=function(e,t,n){if(_.e(this.commentStore.getState()).length){var i=_.j(this.commentStore.getState()),o=_.g(this.commentStore.getState());if(i){if(Object(k.c)(i.focusDetails)||t.isFocusOn({componentType:Object(H.b)(i.selectedCardId,o),id:i.selectedCardId,renderContextType:t.renderContextType})){if(t.renderContextType===b.a.DiscreteIsolated)return;var a={direction:I.d.Next,source:j.a.SharedComments,collapseCard:!0,forceCurrentContext:!0},s=void 0;return s=D.O()?D.t()&&!R.a(this.commentStore.getState()):D.t()&&!R.b(this.commentStore.getState()),this.selectionCommandFactory.selectNextOrPreviousThread(e,a,t.renderContextType,t,s)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==b.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,j.a.SharedComments,t.renderContextType);Object(r.i)().assertConditionTag(!1,"focusedComment missing on down key handler for DiscreteIsolated card",593802311)}},e.prototype.onUpKey=function(e,t,n){if(_.e(this.commentStore.getState()).length){var i=_.j(this.commentStore.getState());if(i){if(Object(k.c)(i.focusDetails)||t.isFocusOn({componentType:Object(H.b)(i.selectedCardId,_.g(this.commentStore.getState())),id:i.selectedCardId,renderContextType:t.renderContextType})){if(t.renderContextType===b.a.DiscreteIsolated)return;var o={direction:I.d.Previous,source:j.a.SharedComments,collapseCard:!0,forceCurrentContext:!0},a=void 0;return a=D.O()?D.t()&&!R.a(this.commentStore.getState()):D.t()&&!R.b(this.commentStore.getState()),this.selectionCommandFactory.selectNextOrPreviousThread(e,o,t.renderContextType,t,a)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==b.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,j.a.SharedComments,t.renderContextType);Object(r.i)().assertConditionTag(!1,"focusedComment missing on up key handler for DiscreteIsolated card",593802312)}},e.prototype.onRightKey=function(e,t,n){if(_.e(this.commentStore.getState()).length){var i=this.selectionCommandFactory.selectRootPostOfFocusedThread(e,t);return i||(t===b.a.DiscreteIsolated?this.selectionCommandFactory.selectNextPostWithinCard(e,t,n):this.selectionCommandFactory.selectNextPost(e,t,n))}},e.prototype.onLeftKey=function(e,t){if(_.e(this.commentStore.getState()).length)return this.selectionCommandFactory.selectAndCollapseFocusedThread(e,j.a.SharedComments,t)},e.prototype.onTabKey=function(e,t){return void 0===_.j(this.commentStore.getState())&&_.e(this.commentStore.getState()).length>0?t===b.a.DiscreteIsolated?void Object(r.i)().assertConditionTag(!1,"focusedComment missing on tab key handler for DiscreteIsolated card",593802313):this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,j.a.SharedComments,t):this.checkForActiveEditorFocus(e,t,_.j(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var e=Object(x.B)(_.i(this.commentStore.getState()));return e&&!e.isInCurrentContext},e.prototype.checkForActiveEditorFocus=function(e,t,n){if(!this.isDraftInOtherContext())return n&&Object(k.c)(n.focusDetails)&&Object(k.h)(n)?z(e,{componentType:G.a.CardEditor,id:n.selectedCardId,renderContextType:t}):n&&!Object(k.c)(n.focusDetails)&&Object(k.h)(n)?z(e,{componentType:G.a.PostEditor,id:n.focusDetails.selectedPostId,renderContextType:t}):void 0},e.prototype.handleMoveFocusEvent=function(e,t){var n;if(e.altKey){var i=_.j(this.commentStore.getState()),o=i?{contentId:null===(n=i)||void 0===n?void 0:n.selectedCardId,contentType:c.b.CommentThread}:void 0;return U(e,w.u({renderContextType:t.renderContextType,trackback:r.h.reserveTag(593802314),telemetryVisitor:this.telemetryVisitor},o))}},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(!this.isDraftInOtherContext())return t&&t.selectedCardId?z(void 0,{componentType:Object(H.b)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e}):void 0},e.prototype.checkForDiscard=function(e,t,n){if(Object(L.a)()!==F.a.Web&&t&&n){var i=t.focusDetails,o=n.focusDetails;if(i.editingSession===k.a.DiscardPending&&o.editingSession===k.a.None)return this.focusCommentCardCommand.processCommand(e,n.selectedCardId);if(Object(k.c)(i)===Object(k.c)(o)&&t.selectedCardId===n.selectedCardId){if(D.ab()){if(!Object(k.j)(t,n))return}else if(!(i.editingSession===k.a.DiscardPending&&o.editingSession===k.a.Active))return;if(Object(k.c)(i)||Object(k.c)(o))return z(void 0,{componentType:G.a.CardEditor,id:n.selectedCardId,renderContextType:e.renderContextType},{shouldRetryOnMount:D.ab()});if(i.selectedPostId===o.selectedPostId)return z(void 0,{componentType:G.a.PostEditor,id:o.selectedPostId,renderContextType:e.renderContextType},{shouldRetryOnMount:D.ab()})}}},e.prototype.paneContainerTabHandling=function(e,t){var n=this.commentStore.getState(),i=Object(x.D)(_.n(n),_.u(n));if(!Object(P.a)({commentData:_.e(n),pendingCommentLoad:_.o(n),virtualized:i}))return(c=z(e,{componentType:G.a.ClosePaneButton})).stopPropagation=!0,c.preventDefault=!0,c;var o=t.getComponent(G.a.ClosePaneButton),a=t.getComponent(G.a.NewCommentButton),r=!D.t()&&Object(k.h)(_.j(n))||!a?o:a;if(D.o()){var s=_.j(n),c=void 0;return s?t.isFocusWithin({componentType:Object(H.b)(s.selectedCardId,_.g(this.commentStore.getState())),id:s.selectedCardId,renderContextType:t.renderContextType})||(c=this.checkForActiveEditorFocus(e,t.renderContextType,_.j(n))):r&&e.isEventTarget(r)&&!e.shiftKey&&(c=this.onTabKey(e,t.renderContextType)),c&&(c.stopPropagation=!0,c.preventDefault=!0),c}return o&&e.isEventTarget(o)&&e.shiftKey||r&&e.isEventTarget(r)&&!e.shiftKey?((c=this.onTabKey(e,t.renderContextType))&&(c.preventDefault=!0,c.stopPropagation=!0),c):void 0},e.prototype.checkForNewDraft=function(e,t,n){if(!this.isDraftInOtherContext()){var i=Object(x.B)(n);if(i&&i.renderContextType===e){var a=t.drafts[i.commentDraft.sessionConfiguration.draftId];if(!a||a.renderContextType!==e){if(Object(O.isEditDraftSessionConfiguration)(i.commentDraft.sessionConfiguration))return z(void 0,{componentType:G.a.PostEditor,id:i.commentDraft.sessionConfiguration.commentId,renderContextType:e});var r=Object(O.isReplyDraftSessionConfiguration)(i.commentDraft.sessionConfiguration)?i.commentDraft.sessionConfiguration.threadId:i.commentDraft.sessionConfiguration.draftId;return Object(o.__assign)(Object(o.__assign)({},z(void 0,{componentType:G.a.CardEditor,id:r,renderContextType:e})),{shouldRetryOnMount:!0})}}}},e.prototype.checkForSelectionChange=function(e,t,n){if(n&&((!t||Object(k.b)(t)!==Object(k.b)(n)||Object(k.c)(t.focusDetails)!==Object(k.c)(n.focusDetails))&&!(n&&Object(k.i)(n.focusDetails)||e.isFocusOn({componentType:G.a.NextCommentButton})||e.isFocusOn({componentType:G.a.PreviousCommentButton}))))return Object(k.c)(n.focusDetails)?this.focusCommentCardCommand.processCommand(e,n.selectedCardId):this.focusCommentPostCommand.processCommand(e,n.focusDetails.selectedPostId)},e.prototype.checkForReplyFinished=function(e,t,n,i){if(n&&t&&Object(k.c)(n.focusDetails)&&i&&i.pending!==E.a.Editor&&t.focusDetails.editingSession!==k.a.None)return n.focusDetails.editingSession===k.a.None?this.focusCommentCardCommand.processCommand(e,n.selectedCardId):void 0},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==E.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,i){var o=this,a=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(a)return z(void 0,{renderContextType:e.renderContextType,componentType:Object(H.b)(a[0],i),id:a[0]})},e.prototype.shouldFocusDraftEditorForReturnToDraft=function(e,t){var n,i;return D.p()?Object(x.c)(e,t)&&(null===(i=null===(n=t)||void 0===n?void 0:n.draftWarningState)||void 0===i?void 0:i.type)!==A.a.CommitFailed:Object(x.c)(e,t)},e.prototype.checkIfCardEditorShouldFocusForReturnToDraft=function(e,t,n){var i=this,a=Object.keys(n.cardIdToDraftIdMap).filter((function(e){var o=n.cardIdToDraftIdMap[e];return i.shouldFocusDraftEditorForReturnToDraft(t.drafts[o],n.drafts[o])}));if(a.length>0)return Object(o.__assign)(Object(o.__assign)({},z(void 0,{renderContextType:e.renderContextType,componentType:G.a.CardEditor,id:a[0]})),{shouldRetryOnMount:!0})},e.prototype.checkIfPostEditorShouldFocusForReturnToDraft=function(e,t,n){var i=this,a=Object.keys(n.postIdToDraftIdMap).filter((function(e){var o=n.postIdToDraftIdMap[e];return i.shouldFocusDraftEditorForReturnToDraft(t.drafts[o],n.drafts[o])}));if(a.length>0)return Object(o.__assign)(Object(o.__assign)({},z(void 0,{renderContextType:e.renderContextType,componentType:G.a.PostEditor,id:a[0]})),{shouldRetryOnMount:!0})},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&!Object(k.c)(n.focusDetails)&&Object(k.e)(n.focusDetails.editingSession))return t&&!Object(k.c)(t.focusDetails)&&Object(k.e)(t.focusDetails.editingSession)?void 0:z(void 0,{componentType:G.a.Post,renderContextType:e.renderContextType,id:n.focusDetails.selectedPostId})},e.prototype.focusNewCommentButton=function(e){if(e.getComponent(G.a.NewCommentButton))return z(void 0,{componentType:G.a.NewCommentButton});Object(r.i)().assertConditionTag(!D.J(),"cant find new comment button, but its enabled",593802315);var t=e.getComponent(G.a.ClosePaneButton);return Object(r.i)().assertConditionTag(void 0!==t||Object(L.a)()===F.a.Windows||Object(L.a)()===F.a.iOS&&e.renderContextType===b.a.FullPane,"cant find close button on platform where we should be able to find it",593802316),t?z(void 0,{componentType:G.a.ClosePaneButton}):void 0},e}(),ne=n(146),ie=n(191),oe=n(75),ae=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(oe.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&ie.e.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&ie.e.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),re=n(323),se=n(67),ce=n(188),de=n(148),ue=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=se.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var i=this.items[n];if(Object(de.a)(i)&&i.commentModel.commentId===t)return i.commentModel}for(n=this.pointer+1;n<this.items.length;++n){i=this.items[n];if(Object(de.a)(i)&&i.commentModel.commentId===t)return i.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&ce.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&ce.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();var le=function(){function e(e,t){this.commentStore=e,this.telemetryVisitor=t}return e.prototype.selectThreadInCurrentContext=function(e,t,n,i,o){return U(e,w.J(t,n,void 0,i?w.c.CollapseCard:w.c.ExpandCard,o))},e.prototype.selectPost=function(e,t,n,i,o){return U(e,w.J(t,n,i,w.c.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,i,o){void 0===o&&(o=!1);var a=void 0;o?a=new re.a(_.e(this.commentStore.getState()),-1,o).next().value:a=_.e(this.commentStore.getState())[0];if(a)return this.selectThreadInCurrentContext(e,{renderContextType:i,trackback:r.h.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},a.commentId,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,i,o){void 0===o&&(o=!1);var a=_.e(this.commentStore.getState());if(Object(x.b)(a,o)){var s=new re.a(a,a.length,o).previous().value;if(s)return this.selectThreadInCurrentContext(e,{renderContextType:i,trackback:r.h.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},s.commentId,t,n);Object(r.i)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.selectAndCollapseFocusedThread=function(e,t,n){var i=_.j(this.commentStore.getState());if(i){var o=i.focusDetails;if(!Object(k.c)(o)||Object(k.c)(o)&&o.expanded)return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:r.h.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},i.selectedCardId,!0,t)}},e.prototype.selectNextOrPreviousThread=function(e,t,n,i,o){var a=this.commentStore.getState(),s=_.e(a),d=_.j(a),u=_.f(a).nextPopulatedContextDetails;if(void 0!==d){if(D.xb()&&n===b.a.DiscreteIntegrated)return U(e,w.K({renderContextType:n,trackback:r.h.reserveTag(593278815),telemetryVisitor:this.telemetryVisitor},t.direction,{contentId:d.selectedCardId,contentType:c.b.CommentThread},j.a.SharedComments));var l=new re.a(s,this.getFocusedIndex(),o),m=t.direction===I.d.Next?l.next():l.previous();if(!m.done)return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:r.h.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},m.value.commentId,!!t.collapseCard,t.source);if(!t.forceCurrentContext)return this.selectAcrossContexts(e,t.direction,n,i)}else{if(Object(x.b)(s,o))return this.selectFirstThreadInCurrentContext(e,!!t.collapseCard,t.source,n,o);if(!t.forceCurrentContext&&u!==ne.a.NoComments)return this.selectAcrossContexts(e,t.direction,n,i)}},e.prototype.selectAcrossContexts=function(e,t,n,i){return q(e,void this.telemetryVisitor,t===I.d.Next?U(e,w.L({renderContextType:n,trackback:r.h.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):U(e,w.M({renderContextType:n,trackback:r.h.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor})))},e.prototype.selectNextPost=function(e,t,n){var i;if(D.b()){if(n){var o=new ue(n,this.getFocusedIndexFromRenderableItems(n),t===b.a.DiscreteIntegrated).next();if(!o.done)return this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278850),telemetryVisitor:this.telemetryVisitor},se.i(o.value),se.e(o.value),j.a.SharedComments);if(D.xb()&&t===b.a.DiscreteIntegrated){var a=_.j(this.commentStore.getState());m=a?{contentId:a.selectedCardId,contentType:c.b.CommentThread}:void 0;return U(e,w.K({renderContextType:t,trackback:r.h.reserveTag(593278851),telemetryVisitor:this.telemetryVisitor},I.d.Next,m,j.a.SharedComments))}var s=new re.a(_.e(this.commentStore.getState()),this.getFocusedThreadIndex(),t===b.a.DiscreteIntegrated).next();return s.done?void 0:this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278852),telemetryVisitor:this.telemetryVisitor},Object(oe.b)(s.value),s.value.commentId,j.a.SharedComments)}Object(r.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278849)}else{var d=new ae(_.e(this.commentStore.getState()),this.getFocusedIndex(),t===b.a.DiscreteIntegrated).next();if(!d.done){var u=null===(i=_.j(this.commentStore.getState()))||void 0===i?void 0:i.selectedCardId,l=Object(oe.b)(d.value);if(D.xb()&&t===b.a.DiscreteIntegrated&&u!==l){var m=u?{contentId:u,contentType:c.b.CommentThread}:void 0;return U(e,w.K({renderContextType:t,trackback:r.h.reserveTag(593278819),telemetryVisitor:this.telemetryVisitor},I.d.Next,m,j.a.SharedComments))}return this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278848),telemetryVisitor:this.telemetryVisitor},l,d.value.commentId,j.a.SharedComments)}}},e.prototype.selectNextPostWithinCard=function(e,t,n){if(void 0!==_.j(this.commentStore.getState())){if(!D.b()){var i=_.e(this.commentStore.getState()),o=this.getFocusedIndex(),a=new ae(i,o).next(),s=i[o];return!a.done&&a.value.parentId&&a.value.parentId===Object(oe.b)(s)?this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},a.value.parentId,a.value.commentId,j.a.SharedComments):void 0}if(n){var c=this.getFocusedIndexFromRenderableItems(n),d=new ue(n,c).next(),u=n[c],l=se.i(u);return d.done||se.i(d.value)!==l?void 0:this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},se.i(d.value),se.e(d.value),j.a.SharedComments)}Object(r.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(r.i)().assertConditionTag(!1,"Expected focusedCommentIndex",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){if(void 0!==_.j(this.commentStore.getState()))if(D.b())if(n){var i=this.getFocusedIndexFromRenderableItems(n),o=n[i],a=se.g(o);if(a)if(!(s=new ue(n,i).previous()).done&&se.i(s.value)===a)return this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},se.i(s.value),se.e(s.value),j.a.SharedComments)}else Object(r.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);else{var s,c=_.e(this.commentStore.getState()),d=this.getFocusedIndex(),u=c[d];if(u.parentId&&!(s=new ae(c,d).previous()).done&&Object(oe.b)(s.value)===u.parentId)return this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},Object(oe.b)(s.value),s.value.commentId,j.a.SharedComments)}else Object(r.i)().assertConditionTag(!1,"Expected focusedCommentIndex",593278857)},e.prototype.selectRootPostOfFocusedThread=function(e,t){var n=_.j(this.commentStore.getState());if(n){var i=this.getFocusedIndex();if(Object(k.c)(n.focusDetails)){var o=_.e(this.commentStore.getState())[i];return this.selectPost(e,{renderContextType:t,trackback:r.h.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},o.commentId,o.commentId,j.a.SharedComments)}}},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n,i=_.e(this.commentStore.getState()).filter((function(e){return!e.parentId}));if(0!==i.length)if(!(t-1<0&&t+1>=i.length))return n=t-1>=0?t-1:t+1,q(void 0,z(void 0,{componentType:G.a.Card,id:i[n].commentId,renderContextType:e}),U(void 0,w.J({renderContextType:e,trackback:r.h.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},i[n].commentId,void 0,w.c.CollapseCard,j.a.SharedComments)))}},e.prototype.getFocusedIndex=function(){return Object(x.s)(_.e(this.commentStore.getState()),_.j(this.commentStore.getState()))},e.prototype.getFocusedThreadIndex=function(){var e=this.commentStore.getState(),t=_.j(e);return t?_.e(e).findIndex((function(e){return e.commentId===t.selectedCardId})):-1},e.prototype.getFocusedIndexFromRenderableItems=function(e){var t=_.j(this.commentStore.getState());if(!t)return-1;var n=Object(k.b)(t);return e.findIndex((function(e){return Object(de.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),me=function(e){function t(t,n,i){return e.call(this,t,new le(t,i),n,i)||this}return Object(o.__extends)(t,e),t.prototype.focusActiveEditor=function(e,t){return this.focusActiveEditorCommand(t,e)},t}(te),fe=function(){function e(e,t){this.commentStore=e,this.commandFactory=new le(this.commentStore,t)}return e.prototype.selectNextOrPreviousThread=function(e,t){var n;n=D.O()?D.t()&&!R.a(this.commentStore.getState()):D.t()&&!R.b(this.commentStore.getState());var o=R.c(this.commentStore.getState());return K(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,o,n),o,this.commentStore)===i.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=R.c(this.commentStore.getState());K(this.commandFactory.selectAcrossContexts(void 0,e,t,n),n,this.commentStore)},e}(),pe=n(669),he=n(537),Ce={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskHeader:29};function ge(e){var t=e.itemCount,n=e.readOnly,i=e.isTask,o=Ce.PostHeight;return t>1&&(o+=Ce.PostHeight+0),t>2&&(o+=Ce.ExpandButtonHeight+0),n||(o+=Ce.ReplyDraftHeight+0),i&&(o+=Ce.TaskHeader),o}var ve=n(1);function ye(e,t){return function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return Object(o.__extends)(i,n),i.prototype.render=function(){var n=Object(o.__assign)(Object(o.__assign)({},t),this.props);return ve.createElement(e,n)},i}(ve.PureComponent)}var be=n(121);function Te(e,t){return function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return Object(o.__extends)(i,n),i.prototype.render=function(){return ve.createElement(be.Provider,{store:t},ve.createElement(e,Object(o.__assign)({},this.props)))},i}(ve.PureComponent)}var Ie=n(156),Se=n(93),Oe=n(363),De=n(124),we=n(159),je=n(302),Pe=n(671),xe=n(20),Ee=n(142),Ae=n(300),ke=n(374),_e=n(602),Re=n(115),Me=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),Ve={focus:function(){},blur:function(){}},Fe={isFocusOn:function(){return!1},isFocusWithin:function(){return!1},isEventTarget:function(){return!1},isFocusWithinAny:function(){return!1},isFocusWithinPane:function(){return!1},getComponent:function(){return Ve},getComponentById:function(){return Ve},getCurrentlyFocused:function(){return[Ve]},renderContextType:b.a.FullPane,contextIdentifier:Ie.a},Le=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Re.a.None,this.pendingAction=void 0,this.getActiveComponentTree=function(){var e=n.commentStore.getState();return!D.O()&&R.b(e)?Fe:(R.a(e),n.viewManager.getComponentTreeForRenderMode(c.d.Integrated))},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(o.__assign)(Object(o.__assign)({},n.viewManager.getHostableCommentCardRendererProps(c.d.Integrated)),{resource:{id:e}})},this.getCompletePaneOwnProps=function(){return Object(o.__assign)(Object(o.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),i=n.commentStore.dispatch;return!D.O()&&R.b(t)||R.a(t)?Object(Oe.b)(i,n.getCompletePaneOwnProps()):Object(Oe.a)(i,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){var e=_.h(n.commentStore.getState());return Object(je.b)(e)},this.getParentId=function(e){var t=n.commentStore.getState(),i=_.e(t),o=i.findIndex((function(t){return t.commentId===e}));return Object(O.getThreadId)(i[o])},this.isNewCommentButtonFocusable=function(){return R.b(n.commentStore.getState())},this.invokeModalDialog=function(e,t,i){var o={renderContextType:n.getActiveComponentTree().renderContextType,trackback:r.h.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},a=n.commentStore.dispatch,s=n.getCompletePaneOwnProps(),c=Object(Oe.b)(a,s),d=n.commentStore.getState(),u=_.j(d),l=_.i(d),m=_.h(d);switch(e){case De.a.CancelNewDraft:case De.a.CancelReplyDraft:return c.discardDraftAsync(o,j.a.SharedComments,!1);case De.a.DeleteThread:return u&&c.requestDeleteThread(o,u.selectedCardId),Promise.resolve(p.a.Handled);case De.a.ClosePaneDraft:return we.r({ownProps:s,dispatchProps:c,componentTree:n.getActiveComponentTree(),draftState:l,focusedComment:u,createdCommentLie:m,invokeModalDialog:n.invokeModalDialog}),Promise.resolve(p.a.Handled);default:return Object(r.i)().assertConditionTag(!1,"Unknown ModalDialogMode",592269457),Promise.resolve(p.a.Unhandled)}},this.shouldCheckForLowFidelityOnCardDelete=function(){return D.x()},this.handleStoreUpdate=function(){var e,t,i=n.commentStore.getState(),o=_.j(i),a=_.j(n.previousStoreState);!(o&&Object(k.i)(o.focusDetails))&&n.pendingActionReason===Re.a.NeedNotDrafting&&n.pendingAction&&(Object(r.i)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),r.a.None).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Re.a.None);var s=(null===(e=o)||void 0===e?void 0:e.focusDetails.editingSession)===k.a.Active,c=(null===(t=a)||void 0===t?void 0:t.focusDetails.editingSession)===k.a.Active;s&&!c&&n.pendingActionReason===Re.a.NeedDrafting&&n.pendingAction&&(Object(r.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),r.a.None).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Re.a.None),n.previousStoreState=i},this.onDrafting=function(e){var t,i=Object(r.i)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),r.a.None);(null===(t=_.j(n.commentStore.getState()))||void 0===t?void 0:t.focusDetails.editingSession)===k.a.Active?(i.addDataField("ActionDeferred",!1,r.c.SystemMetadata),e(),i.successTag(592269460)):(i.addDataField("ActionDeferred",!0,r.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Re.a.NeedDrafting,i.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(r.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),r.a.None),i=_.j(n.commentStore.getState());i&&Object(k.i)(i.focusDetails)?(t.addDataField("ActionDeferred",!0,r.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Re.a.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,r.c.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Re.a.NeedDrafting:return n.onDrafting(t);case Re.a.NeedNotDrafting:return n.onNotDrafting(t);case Re.a.None:return t()}},this.onMockUIAction=function(e){var t=Object(r.i)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),r.a.None);t.addDataField("MockUIActionType",e.actionType,r.c.SystemMetadata);try{switch(e.actionType){case Se.a.CreateThread:Se.g(e)?n.runAction(Re.a.NeedDrafting,(function(){return n.onCreateOrReply(new ke.a(n.getNewThreadDraftId(),e.content))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case Se.a.CancelCreateThread:Se.b(e)?n.runAction(Re.a.NeedDrafting,(function(){return n.onCancelCreateThread(new ke.a(n.getNewThreadDraftId()))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case Se.a.StartReplySession:Se.p(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onStartReplySession(new ke.a(e.threadId))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case Se.a.CancelReplySession:Se.d(e)?n.runAction(Re.a.NeedDrafting,(function(){return n.onCancelReplySession(new ke.a(e.threadId))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case Se.a.PostReply:Se.k(e)?n.runAction(Re.a.NeedDrafting,(function(){return n.onCreateOrReply(new ke.a(e.threadId,e.content))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case Se.a.DeleteComment:Se.h(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case Se.a.DeleteThread:Se.i(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case Se.a.ResolveThread:Se.m(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case Se.a.ReopenThread:Se.l(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case Se.a.StartEditSession:Se.o(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case Se.a.CancelEditSession:Se.c(e)?n.runAction(Re.a.NeedDrafting,(function(){return n.onCancelEditSession(new _e.a(e.commentId))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case Se.a.PostEdit:if(Se.j(e)){var i=new _e.a(e.commentId);i.setContents(e.content),n.runAction(Re.a.NeedDrafting,(function(){return n.onPostEdit(i)}))}else Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Se.a.SelectComment:Se.n(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onSelectComment(new Me(e.commentId))})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case Se.a.ClosePane:n.onClosePane();break;case Se.a.ClickGhostCard:Se.e(e)?n.runAction(Re.a.NeedNotDrafting,(function(){return n.onGhostCommentClicked()})):Object(r.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Object(r.i)().assertConditionTag(!1,"Received unknown MockUIAction: "+e,592269506)}}catch(e){return void t.failTag(592269507,Object(Ee.a)(e))}t.successTag(592269508)},this.onStartEditSession=function(e){var t=n.commentStore.getState();we.G({trackback:r.h.reserveTag(592269509),id:e,data:n.getRenderableItems(t),focusedComment:_.j(t),renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){we.n({trackback:r.h.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(R.b(e)){var t=n.commentStore.dispatch;Object(Oe.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:b.a.None,trackback:r.h.reserveTag(592269511)})}else D.X()&&Object(r.i)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t,i=e.getId(),o=n.commentStore.getState(),a=_.r(o),s=_.j(o),c=(null===(t=_.g(o))||void 0===t?void 0:t.newComment.commentId)===i?{type:"CREATE"}:{type:"REPLY",parentId:i};we.b({trackback:r.h.reserveTag(592269513),commentCardRef:e,focusedComment:s,areMentionsEnabled:Object(x.e)(_.n(o),_.a(o))===O.AtMentionCapabilityState.Enabled,session:c,componentTree:n.getActiveComponentTree(),dispatchProps:n.getDispatchProps(i),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,selectedTaskAssignee:a&&a.selectedTaskAssignee}).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,592269514):Object(r.i)().assertConditionTag(!1,"Unknown error thrown from cardOnCommit: "+e,592269515)}))},this.onCancelCreateThread=function(e){var t,i=e.getId(),o=n.getDispatchProps(i),a=n.commentStore.getState(),s=_.h(a),c=(null===(t=s)||void 0===t?void 0:t.newComment.commentId)===e.getId(),d=_.j(a),u=_.i(a),l=R.b(a),m=n.getActiveComponentTree().renderContextType,f=_.k(a),p=c&&Object(je.c)(l,m,d,s,f),h=d?u.cardIdToDraftIdMap[d.selectedCardId]:void 0,C=se.f(n.getRenderableItemThreads(a,n.getActiveComponentTree()),i);we.e({trackback:r.h.reserveTag(592269516),focusedComment:d,showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:o,closeOnDiscard:p,draftId:h,draftState:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),lieIndex:C,createdCommentLie:s})},this.onGhostCommentClicked=function(){R.b(n.commentStore.getState())||Object(r.i)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(I.d.Next,n.getActiveComponentTree().renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),i=n.getRenderableItems(t),o=_.j(t),a=n.getParentId(e.getId()),s=n.getDispatchProps(a),c=_.a(t),d=_.n(t);we.E({trackback:r.h.reserveTag(592269518),id:e.getId(),data:i,focusedComment:o,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(x.e)(d,c)===O.AtMentionCapabilityState.Enabled,componentTree:n.getActiveComponentTree(),actionDispatchers:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI}).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,592269519):Object(r.i)().assertConditionTag(!1,"Unknown error thrown from onPostEdit: "+e,592269520)}))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),i=_.j(t),o=R.b(t),a=_.h(t),s=_.k(t),c=Object(je.c)(o,n.getActiveComponentTree().renderContextType,i,a,s),d=n.getRenderableItems(t),u=n.getParentId(e.getId()),l=n.getDispatchProps(u);we.C({trackback:r.h.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:d,focusedComment:i,shouldClosePaneAfterDiscardDraft:c,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onCancelReplySession=function(e){var t,i=n.commentStore.getState(),o=_.h(i),a=(null===(t=o)||void 0===t?void 0:t.newComment.commentId)===e.getId(),s=_.j(i),c=_.i(i),d=e.getId(),u=n.getDispatchProps(d),l=R.b(i),m=n.getActiveComponentTree().renderContextType,f=_.k(n.commentStore.getState()),p=a&&Object(je.c)(l,m,s,o,f),h=s?c.cardIdToDraftIdMap[s.selectedCardId]:void 0,C=se.f(n.getRenderableItemThreads(i,n.getActiveComponentTree()),d);we.e({trackback:r.h.reserveTag(592269522),focusedComment:s,showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:u,closeOnDiscard:p,draftId:h,draftState:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),lieIndex:C,createdCommentLie:o})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),i=_.j(t),o=n.getDispatchProps(e),a=Ae.a(t);we.c({trackback:r.h.reserveTag(592269523),id:e,data:n.getRenderableItems(t),focusedComment:i,componentTree:n.getActiveComponentTree(),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isTask:!!a.tasks[e],isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),threadIndex:se.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),e),shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),i=_.j(t),o="string"==typeof e?e:Object(Pe.a)(e)?e.getId():"",a=n.getParentId(o),s=n.getDispatchProps(a);we.F({trackback:r.h.reserveTag(592269524),id:o,data:n.getRenderableItems(t),focusedComment:i,renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onSelectComment=function(e){var t,i=n.commentStore.getState(),o=_.h(i),a=n.getRenderableItems(i),s=e.getId(),c=s===(null===(t=o)||void 0===t?void 0:t.draftId)?o&&{commentModel:o.newComment}:a.find((function(e){return se.e(e)===s}));if(c&&Object(de.a)(c)){var d=c,u=d.commentModel.parentId,l=n.getDispatchProps(u?d.commentModel.commentId:d.commentModel.parentId);we.J({trackback:r.h.reserveTag(592269526),renderableItem:c,focusedComment:_.j(i),renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor()})}else Object(r.i)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){we.a({trackback:r.h.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=_.z(),this.getRenderableItemThreads=_.y(this.getRenderableItems)}return e.prototype.initialize=function(){this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction)},e.prototype.teardown=function(){this.registrationToken.unsubscribe(),this.unsubscribeStoreListener()},e.prototype.onReopenThread=function(e,t){we.m({trackback:r.h.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree().renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),Ne=n(488);var Ue=n(490);var Be=n(472);function ze(e,t,n,i){return function(o){return Object(c.e)().registerExtension(t,n,i).then((function(t){return o(Object(Be.a)(e,t)),t}))}}var He,We=n(23),Ge=n(325);!function(e){e[e.HasToken=0]="HasToken",e[e.EmptyToken=1]="EmptyToken",e[e.TokenFailed=2]="TokenFailed",e[e.MentionsDisabled=3]="MentionsDisabled"}(He||(He={}));var qe=n(317),Ye=n(338),Ke=n(649),Je=n(221),Qe=n(176),Ze=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var i=this.hostableComponentRegistry.get(e);n?i.set(t,n):i.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),Xe=function(){function e(e){var t=this,n=e.apiContext,i=e.viewProvider,o=e.commentAPI,s=e.peopleAPI,u=e.localizationAPI,l=e.themeAPI,m=e.initializationReason,f=e.commentStore,p=e.viewStrategyFactory,h=e.mockUIDriver;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(w.w({renderContextType:b.a.None,trackback:r.h.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e})),t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(Ke.a)((function(){d.a.sendCodeMarker({context:t.apiContext,type:d.b.DataReceived,assertTag:r.h.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case b.a.None:case b.a.ModalDraft:Object(a.i)(!1,"Unexpected render context type:"+e);case b.a.FullPane:case b.a.HalfPane:return R.c(t.getCommentStore().getState());case b.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(c.d.Integrated);case b.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(c.d.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor}},this.setComponentRef=function(e,n,i){t.viewManagerRefRegistry.registerComponent(e,n,i)},this.onSuggestionsDetailsChange=function(e){D.db()&&t.commentStore.dispatch(w.Y({renderContextType:b.a.None,trackback:r.h.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.apiContext=n,this.viewProvider=i,this.commentAPI=o,this.peopleAPI=s,this.localizationAPI=u,this.themeAPI=l,this.lastInitializationReason=m,this.viewStrategyFactory=p,this.mockUIDriver=h,this.telemetryVisitor=Qe.a.getTelemetryVisitor(this.apiContext),this.correlationId=Qe.a.getCorrelationId(this.apiContext)||Object(Ye.a)(),this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.refreshAtMentionAuthToken=this.refreshAtMentionAuthToken.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.processInitialPendingActions=this.processInitialPendingActions.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new fe(f,this.telemetryVisitor),this.focusManager=new me(f,this.localizationAPI.getLocaleInfo().isRightToLeft,this.telemetryVisitor);var C=f.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(C.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor,this.getComponentTree),this.commentStore=f,this.discreteIntegratedComponentTree=new T.a(b.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new T.a(b.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Ze,D.t()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new Le(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t,n;(0,this.commentStore.dispatch)((e={renderContextType:b.a.None,trackback:r.h.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,n=this.getAtMentionAuthToken,function(i){var o=Object(r.i)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,r.a.None);return t.checkAtMentionCapability().then((function(t){var i=t?u.b.Enabled:u.b.Disabled;return t?n().then((function(t){return o.addDataField(We.a.MentionTokenState,void 0!==t?He.HasToken:He.EmptyToken,r.c.SystemMetadata),Object(Ge.a)(e,i,t)}),(function(t){return o.addDataField(We.a.MentionTokenState,He.TokenFailed,r.c.SystemMetadata),Object(Ge.a)(e,i,void 0)})):(o.addDataField(We.a.MentionTokenState,He.MentionsDisabled,r.c.SystemMetadata),Object(Ge.a)(e,i,void 0))})).then((function(e){o.addDataField(We.a.AtMentionsEnabled,e.payload.capability===u.b.Enabled,r.c.SystemMetadata),o.successTag(595903522),i(e)})).catch((function(t){o.failTag(595903523,Object(Ee.a)(t,-2130957528)),i(Object(Ge.a)(e,u.b.Disabled,void 0))}))})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595152915):Object(r.i)().assertConditionTag(!1,"Unknown error when dispatching requestAtMentionCapabilityThunk "+e,595152916)}))},e.prototype.refreshAtMentionAuthToken=function(){var e,t,n=this.commentStore.getState();Object(x.e)(_.n(n),_.a(n))===u.b.Enabled&&(0,this.commentStore.dispatch)((e={renderContextType:b.a.None,trackback:r.h.reserveTag(595899736),telemetryVisitor:this.telemetryVisitor},t=this.getAtMentionAuthToken,function(n){var i=Object(r.i)().createActivityObject("RefreshAtMentionAuthToken",e.telemetryVisitor,r.a.OnSuccess);return t().then((function(t){i.successTag(595899734),n(Object(Ne.a)(e,t))}),(function(e){i.failTag(595899735,-2130957528)}))})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595632139):Object(r.i)().assertConditionTag(!1,"Unknown error in refreshAtMentionAuthToken "+e,595632140)}))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t;this.initialized||(this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),D.t()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),D.t()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),D.M()||this.commentStore.dispatch(w.P({renderContextType:b.a.None,trackback:r.h.reserveTag(595732560),telemetryVisitor:this.telemetryVisitor},{resolve:this.commentAPI.resolveSupported()})),D.M()&&this.commentStore.dispatch(w.W({renderContextType:b.a.None,trackback:r.h.reserveTag(595685378),telemetryVisitor:this.telemetryVisitor},this.commentAPI.resolveSupported()?g.a.Resolve:g.a.None)),D.db()&&this.peopleAPI.capabilities&v.a.GetSuggestionsDetails&&(this.commentStore.dispatch((e={renderContextType:b.a.None,trackback:r.h.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},t=this.peopleAPI,function(n){if(!(t.capabilities&v.a.GetSuggestionsDetails))return Promise.resolve();var i=Object(r.i)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,r.a.OnSuccess);return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){i.successTag(592492760),n(Object(Ue.a)(e,t))}),(function(e){i.failTag(592492761,-2130957495)})):(i.failTag(592492759,-2130957494),Promise.resolve())})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,592492754):Object(r.i)().assertConditionTag(!1,"Unknown error when dispatching refreshSuggestionsDetailsThunk "+e,592492755)})),Object(r.i)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===_.o(e)&&_.e(e).length>0&&this.processInitialPendingActions()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var i=e.getState();if(D.t()){var o=_.o(i);o!==t&&(t=o,n.onChange(i))}}))},e.prototype.processInitialPendingActions=function(){var e=this;this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[]},e.prototype.registerActions=function(){this.commentAPI.registerForAction(f.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(f.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(f.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(f.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(f.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(f.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case c.d.Integrated:return this.discreteIntegratedComponentTree;case c.d.Isolated:return this.discreteIsolatedComponentTree}},e.prototype.getPaneOwnProps=function(){return Object(o.__assign)(Object(o.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,refreshAtMentionAuthToken:this.refreshAtMentionAuthToken,correlationId:this.correlationId,onInitialRender:this.onInitialRender})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(o.__assign)(Object(o.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,i){t.setComponentRef(e,n,i)},correlationId:this.correlationId,onInitialRender:this.onInitialRender,themeAPI:this.themeAPI})},e.prototype.initializeContentExtensions=function(){var e,t=this;Object(qe.c)("CommentPaneContainer").then((function(n){if(void 0!==(e=n)){var i=Te(ye(e.CommentPaneContainer,Object(o.__assign)({},t.getPaneOwnProps())),t.commentStore),a=Object(Je.d)(Je.a,t.apiContext);Object(s.b)().registerComponent(a,i)}var d;Object(qe.c)("HostableCommentCardRendererContainer").then((function(e){if(void 0!==(d=e)){var n=Te(ye(d.HostableCommentCardRendererContainer,Object(o.__assign)({},t.getHostableCommentCardRendererProps(c.d.Integrated))),t.commentStore),i=Object(Je.d)(Je.b,t.apiContext);t.discreteIntegratedComponentController=Object(s.b)().registerComponent(i,n),t.discreteIntegratedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,c.d.Integrated)}));var a=Te(ye(d.HostableCommentCardRendererContainer,Object(o.__assign)({},t.getHostableCommentCardRendererProps(c.d.Isolated))),t.commentStore),u=Object(Je.d)(Je.c,t.apiContext);t.discreteIsolatedComponentController=Object(s.b)().registerComponent(u,a),t.discreteIsolatedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,c.d.Isolated)})),t.commentStore.dispatch(ze({renderContextType:b.a.None,trackback:r.h.reserveTag(595616915),telemetryVisitor:t.telemetryVisitor},c.b.CommentThread,i,{renderMode:c.d.Integrated,priority:c.c.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595645980):Object(r.i)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645981)})),t.commentStore.dispatch(ze({renderContextType:b.a.None,trackback:r.h.reserveTag(595616916),telemetryVisitor:t.telemetryVisitor},c.b.CommentThread,u,{renderMode:c.d.Isolated,priority:c.c.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize(),isContentAvailable:function(e){var n=t.commentStore.getState(),i=Object(he.c)(e,_.e(n),_.d(n)),o=_.j(n),a=_.i(n);return Object(he.a)(Object(he.b)(e,_.e(n),i,_.h(n),a.drafts[e]),o,b.a.DiscreteIsolated,Object(pe.a)(e,b.a.DiscreteIsolated,o,a))}})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595645982):Object(r.i)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645983)}))}})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595645984):Object(r.i)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645985)}))})).catch((function(e){Object(xe.b)(e)?Object(r.i)().assertConditionTag(!1,e.message,595645986):Object(r.i)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645987)}))},e.prototype.getAverageCardSize=function(){return{width:259,height:ge({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n;switch(e.command){case"Focus":return void(null===(n=this.viewManagerRefRegistry.getComponent(t,e.payload.resourceId))||void 0===n||n.focus());default:return void Object(r.i)().assertConditionTag(!1,"Unexpected ComponentCommandType",593786644)}},e.prototype.teardownContentExtensions=function(){this.commentStore.dispatch(w.A({renderContextType:b.a.None,trackback:r.h.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor},c.d.Integrated,c.d.Isolated));var e=Object(Je.d)(Je.a,this.apiContext);Object(s.b)().unregisterComponent(e)},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(f.a.AddComment),this.commentAPI.unregisterForAction(f.a.NextThread),this.commentAPI.unregisterForAction(f.a.PreviousThread),this.commentAPI.unregisterForAction(f.a.DeleteThread),this.commentAPI.unregisterForAction(f.a.BackKeyPressed),this.commentAPI.unregisterForAction(f.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),D.db()&&this.peopleAPI.capabilities&v.a.GetSuggestionsDetails&&(Object(r.i)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),D.t()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(D.t()&&e.actionBehavior===l.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var i=Object(o.__values)(this.commentUIActionListeners),a=i.next();!a.done;a=i.next()){var r=(0,a.value)(e);if(r!==h.a.NotHandled)return r===h.a.Success}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===h.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n,i=Object(a.g)(a.b.Comments,m.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null===(n=i)||void 0===n||n.end(),D.t()&&!this.initialLoadComplete&&e===m.a.CommentContextChanged&&C.b(t)&&0===t.numberOfComments&&this.processInitialPendingActions()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(p.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==p.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case y.a.VisibilityChanged:return void n(w.bb({renderContextType:b.a.None,trackback:r.h.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case y.a.VisibilityChanged_deprecated:return void n(w.cb({renderContextType:b.a.None,trackback:r.h.reserveTag(595616918),telemetryVisitor:this.telemetryVisitor},e.visible));case y.a.ViewContainerChanged:return n(w.Z({renderContextType:b.a.None,trackback:r.h.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor,this.getComponentTree));case y.a.FocusTriggered:return void setTimeout((function(){return t.focusManager.focusCommentPaneCommand(R.c(t.commentStore.getState()))}));case y.a.FoldableLayoutStateChanged:n(w.ab({renderContextType:b.a.None,trackback:r.h.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}();n.d(t,"a",(function(){return $e}));var $e=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(o.__extends)(t,e),t}(Xe)},function(e,t,n){"use strict";var i,o=n(165),a=n(3),r=n(102),s=n(123),c=n(109),d=n(129),u=n(66),l=n(76);!function(e){e[e.HostCanvas=1]="HostCanvas",e[e.ContentNavigation=2]="ContentNavigation"}(i||(i={}));var m=n(122),f=n(16),p=n(159),h=n(67),C=n(14),g=n(30),v=n(212),y=n(539),b=n(301),T=n(373),I=n(135),S=n(134),O=n(12),D=n(10),w=n(44),j=n(20),P=n(154),x=n(8),E=n(423),A=function(){function e(e,t,n,i,o,a){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=i,this.telemetryVisitor=o,this.getComponentTree_deprecated=a,this.getDraftRenderContextType=D.w(),this.getRenderableItems=D.z()}return e.prototype.processCommentEvent=function(e,t,n,o){var r=o();switch(e){case c.a.CommentContextChanged:if(!l.b(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(C.o({renderContextType:f.a.None,trackback:a.h.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case c.a.CommentsChanged:if(!l.i(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case c.a.LoadComments:if(!l.j(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case c.a.CommentSelected:if(!l.h(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId)if(void 0!==D.d(r)[t.commentId]){var s=t.selectionReason===i.ContentNavigation?C.c.CollapseCard:C.c.ExpandCard;n(C.J({renderContextType:f.a.None,trackback:a.h.reserveTag(595912093),telemetryVisitor:this.telemetryVisitor},t.commentId,void 0,s,g.a.Canvas))}else{var d=D.e(r).find((function(e){return e.commentId===t.commentId}));void 0!==d&&n(C.J({renderContextType:f.a.None,trackback:a.h.reserveTag(595912094),telemetryVisitor:this.telemetryVisitor},d.parentId,t.commentId,C.c.SelectPost,g.a.Canvas))}else n(C.l({renderContextType:f.a.None,trackback:a.h.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case c.a.CommentContextReload:if(!l.d(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case c.a.CommentHighlighted:if(!l.f(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(C.t({renderContextType:f.a.None,trackback:a.h.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,g.a.Canvas)):n(C.k({renderContextType:f.a.None,trackback:a.h.reserveTag(595912099),telemetryVisitor:this.telemetryVisitor},g.a.Canvas));break;case c.a.NextPopulatedContextDetailsUpdated:if(!l.l(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(C.v({renderContextType:f.a.None,trackback:a.h.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case c.a.CommentHostCapabilitiesChanged:l.g(t)?n(C.P({renderContextType:f.a.None,trackback:a.h.reserveTag(595732558),telemetryVisitor:this.telemetryVisitor},t.capabilities)):Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595732559);break;case c.a.ModelCapabilitiesChanged:l.k(t)?n(C.W({renderContextType:f.a.None,trackback:a.h.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags)):Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case c.a.CommentError:if(!l.e(t))return void Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case c.a.ReturnToDraftRequested:l.m(t)&&n(C.r({draftWarningType:S.a.ReturnToDraft,draftWarningReason:I.a.HostRequest},{renderContextType:f.a.None,trackback:a.h.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case c.a.UpdateDraftThread:l.n(t)?n(C.S({renderContextType:f.a.None,trackback:a.h.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(a.i)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;default:return void Object(a.i)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,i){var o=this,s=n();switch(e.actionType){case d.a.ShowHideCommentPane:return u.c(e.actionBehavior)?w.b(s)?u.a.Success:u.a.Fail:(u.d(e.actionBehavior)&&(w.b(s)?t(C.B({renderContextType:f.a.None,trackback:a.h.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(C.G({renderContextType:f.a.None,trackback:a.h.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),u.a.Success);case d.a.AddComment:if(u.b(e.actionBehavior)){if(!Object(E.a)(D.j(s),D.g(s)))return u.a.Fail}else if(u.d(e.actionBehavior)){var c={renderContextType:f.a.None,trackback:a.h.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};if(x.Z()){var l=this.getDraftRenderContextType(n()),m=!x.ub()&&l?this.getComponentTree_deprecated(l):void 0;t(Object(v.a)(c,this.commentAPI,{sessionType:"CREATE"},!(!i||!i.retainFocusOnAddComment),this.peopleAPI,void 0,m)).catch((function(e){Object(P.a)(e,a.h.reserveTag(592314376))}))}else t(Object(y.a)(c,g.a.Canvas,this.commentAPI,{sessionType:"CREATE"},!(!i||!i.retainFocusOnAddComment),this.peopleAPI,this.getComponentTree_deprecated)).catch((function(e){Object(P.a)(e,a.h.reserveTag(594921090))}));return u.a.Success}return u.a.Success;case d.a.NextThread:if(Object(a.i)().assertConditionTag(!u.c(e.actionBehavior),"This action type does not support toggled status",595899713),u.d(e.actionBehavior))if(x.ob())this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:r.d.Next,source:g.a.SharedComments},f.a.None)}),t,I.a.NextThread,a.h.reserveTag(591729749));else{if(this.tryHandleActiveDraftWarning_deprecated(t,s,I.a.NextThread))return u.a.Success;this.selectionManager.selectNextOrPreviousThread({direction:r.d.Next,source:g.a.SharedComments},f.a.None)}else if(u.b(e.actionBehavior))return Object(E.c)(s)?u.a.Success:u.a.Fail;return u.a.Success;case d.a.PreviousThread:if(Object(a.i)().assertConditionTag(!u.c(e.actionBehavior),"This action type does not support toggled status",595899714),u.d(e.actionBehavior))if(x.ob())this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:r.d.Previous,source:g.a.SharedComments},f.a.None)}),t,I.a.PreviousThread,a.h.reserveTag(591729750));else{if(this.tryHandleActiveDraftWarning_deprecated(t,s,I.a.PreviousThread))return u.a.Success;this.selectionManager.selectNextOrPreviousThread({direction:r.d.Previous,source:g.a.SharedComments},f.a.None)}else if(u.b(e.actionBehavior))return Object(E.c)(s)?u.a.Success:u.a.Fail;return u.a.Success;case d.a.DeleteThread:if(Object(a.i)().assertConditionTag(!u.c(e.actionBehavior),"This action type does not support toggled status",595899715),u.b(e.actionBehavior)){if(!Object(E.b)(s.commentState))return u.a.Fail}else if(u.d(e.actionBehavior))if(x.ob())this.handleActionOrReturnToDraft((function(){var e=D.j(s);e&&t(C.D({renderContextType:f.a.None,trackback:a.h.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,I.a.DeleteThread,a.h.reserveTag(591729751));else{if(this.tryHandleActiveDraftWarning_deprecated(t,s,I.a.DeleteThread))return u.a.Success;var p=D.j(s);p&&!Object(O.i)(p.focusDetails)&&t(C.D({renderContextType:f.a.None,trackback:a.h.reserveTag(595899716),telemetryVisitor:this.telemetryVisitor},p.selectedCardId))}return u.a.Success}return u.a.NotHandled},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"EditComment":var i=n(),o=this.getRenderableItems(i),r=D.j(i),c=this.getDraftRenderContextType(i),d=!x.ub()&&c?this.getComponentTree_deprecated(c):void 0,u=Object(h.a)(o,e.commentId);return u?Object(p.K)({comment:u,threads:o,focusedComment:r,warningType:O.a.LowFidelityWarningOnEdit})?(t(C.N({renderContextType:f.a.None,telemetryVisitor:this.telemetryVisitor,trackback:a.h.reserveTag(593000206)},e.commentId,O.a.LowFidelityWarningOnEdit)),Promise.resolve(s.InterruptableCommandResult.Handled)):(Object(T.a)(this.commentAPI,this.peopleAPI,t,{sessionType:"EDIT",commentId:e.commentId},!1,{renderContextType:f.a.None,telemetryVisitor:this.telemetryVisitor,trackback:a.h.reserveTag(593000207)},{renderContextType:f.a.None,telemetryVisitor:this.telemetryVisitor,trackback:a.h.reserveTag(593000208)},d),Promise.resolve(s.InterruptableCommandResult.Handled)):(Object(a.i)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(s.InterruptableCommandResult.Handled));case"ReplyComment":i=n(),c=this.getDraftRenderContextType(i);return t(Object(v.a)({renderContextType:f.a.None,trackback:a.h.reserveTag(593000209),telemetryVisitor:this.telemetryVisitor},this.commentAPI,{sessionType:"REPLY",threadId:e.threadId},!1,this.peopleAPI,void 0,!x.ub()&&c?this.getComponentTree_deprecated(c):void 0)).catch((function(e){return Object(P.a)(e,a.h.reserveTag(593000210))})),Promise.resolve(s.InterruptableCommandResult.Handled);default:return Promise.resolve(s.InterruptableCommandResult.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,i){t(Object(b.a)({renderContextType:f.a.None,trackback:i,telemetryVisitor:this.telemetryVisitor},g.a.SharedComments,n)).then((function(t){t.draftDiscardBehavior!==m.a.NoDraft&&t.draftDiscardResult!==s.InterruptableCommandResult.Handled||e()})).catch((function(e){Object(j.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,591738704):Object(a.i)().assertConditionTag(!1,"Unknown error in execute action "+e,591738705)}))},e.prototype.tryHandleActiveDraftWarning_deprecated=function(e,t,n){var i=D.j(t);return!!(x.K()&&i&&Object(O.i)(i.focusDetails))&&(e(C.r({draftWarningType:S.a.ReturnToDraft,draftWarningReason:n},{renderContextType:f.a.None,trackback:a.h.reserveTag(595859008),telemetryVisitor:this.telemetryVisitor})),!0)},e}(),k=n(168),_=n(534),R=n(477),M=n(478),V=n(480),F=n(97),L=n(487),N=n(489);function U(e,t,n,i){return function(o,r){var s=r();i&&o(i);var c=i?i.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(L.a)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId)if(n.selectedCommentId){var d=D.j(s);if(d&&d.selectedCardId===n.selectedCommentId)if(Object(O.c)(d.focusDetails))o(Object(F.b)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953697)},n.selectedCommentId,void 0,d.focusDetails.expanded?F.a.ExpandCard:F.a.CollapseCard,g.a.Canvas));else{var u=d.focusDetails.selectedPostId,l=r();D.e(l).find((function(e){return e.commentId===u}))?o(Object(F.b)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953698)},n.selectedCommentId,u,F.a.SelectPost,g.a.Canvas)):o(Object(F.b)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953699)},n.selectedCommentId,void 0,F.a.ExpandCard,g.a.Canvas))}else o(Object(F.b)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953728)},n.selectedCommentId,void 0,F.a.ExpandCard,g.a.Canvas))}else o(Object(M.a)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953729)}));void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(V.a)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953730)},n.highlightedCommentId,g.a.Canvas)):o(Object(R.a)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953731)},g.a.Canvas)));var m=Object(_.a)(n);m&&o(Object(N.a)({renderContextType:e,telemetryVisitor:c,trackback:a.h.reserveTag(595953732)},m))}}}var B=n(366),z=n(19),H=n(15),W=n(305);var G=n(481),q=n(482);function Y(e,t,n){return function(i){l.o(t)?i(Object(q.a)(Object(H.a)(e,a.h.reserveTag(595137280)),t.threads)):(x.S()&&i(Object(W.a)(Object(H.a)(e,a.h.reserveTag(595137282)),t.comments,t.tasks,n)),i(Object(G.a)(Object(H.a)(e,a.h.reserveTag(595137283)),t.comments,t.tasks)))}}var K=function(){function e(e,t,n,i){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=i}return e.prototype.processCommentEvent=function(e,t,n,i){switch(e){case c.a.CommentsChanged:l.i(t)&&n(U(f.a.None,this.telemetryVisitor,t.contextDetails,Object(C.e)({renderContextType:f.a.None,trackback:a.h.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case c.a.LoadComments:l.j(t)&&n(Y({renderContextType:f.a.None,trackback:a.h.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case c.a.CommentContextReload:l.d(t)&&n((o={renderContextType:f.a.None,trackback:a.h.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},r=t,s=this.peopleAPI,d=this.telemetryVisitor,function(e,t){var n=[];Object(l.c)(r)?(Object(a.i)().assertConditionTag(!t||Object(z.D)(D.n(t()),D.u(t())),"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=Object(B.a)(r.commentIds,(function(){return t().commentState}))):n=r.comments;var i=Object(l.c)(r)?[]:r.tasks;e(U(o.renderContextType,d,r.contextDetails,Object(C.z)(Object(H.a)(o,a.h.reserveTag(595953694)),{comments:n,numberOfThreads:r.numberOfThreads,tasks:i}))),x.S()&&e(Object(W.a)(Object(H.a)(o,a.h.reserveTag(595932895)),n,i,s)).catch((function(e){Object(j.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,595645974):Object(a.i)().assertConditionTag(!1,"Unknown error in contextReloadThunk "+e,595645975)}))}))}var o,r,s,d;this.commonViewStrategy.processCommentEvent(e,t,n,i)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===s.CommentUIAction.AddComment&&e.actionBehavior!==s.ActionBehavior.CheckEnabled){var i=n();w.b(i)&&this.focusManager.onUserAction(i.paneState.componentTree,k.a.RequestNewCommentFromHost)}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),J=n(253),Q=n(255),Z=n(0),X=n(80),$=n(75),ee=n(78);var te=n(345);var ne=n(483);var ie=function(){function e(e,t,n,i){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=i}return e.prototype.processCommentEvent=function(e,t,n,i){switch(e){case c.a.CommentsChanged:l.i(t)&&n((o=t,r=this.telemetryVisitor,function(e,t){var n,i,s,c,d=t(),u=!1,l=o.contextDetails;if(x.sb()&&""===(null===(s=l)||void 0===s?void 0:s.selectedCommentId)&&(l=Object(Z.__assign)(Object(Z.__assign)({},l),{selectedCommentId:void 0})),e(U(f.a.None,r,l,Object(C.e)({renderContextType:f.a.None,trackback:a.h.reserveTag(595953743),telemetryVisitor:r},o.changes))),!o.contextDetails||!o.contextDetails.selectedCommentId){var m=D.j(d),p=m?m.selectedCardId:void 0,h=t(),v=D.j(h),y=D.e(d),b=D.e(h);if(p){if(p&&o.changes.some((function(e){return e.type===X.a.Delete&&e.model.commentId===p}))){var T=y.findIndex((function(e){return e.commentId===p}));try{for(var I=Object(Z.__values)(o.changes),S=I.next();!S.done;S=I.next()){var O=S.value;switch(O.type){case X.a.Insert:O.index<=T&&++T;break;case X.a.Delete:O.index<T&&--T;break;case X.a.Modify:case X.a.Unknown:}}}catch(e){n={error:e}}finally{try{S&&!S.done&&(i=I.return)&&i.call(I)}finally{if(n)throw n.error}}if(v)throw new j.a(ee.n,-2130957551);if(b.length){var w=T;w===b.length&&(w=b.length-1);var P=b[w],E=Object($.b)(P);e(Object(C.J)({renderContextType:f.a.None,trackback:a.h.reserveTag(595953744),telemetryVisitor:r},E,void 0,F.a.ExpandCard,g.a.SharedComments)),u=!0}}}else!y.length&&b.length&&(e(Object(C.J)({renderContextType:f.a.None,trackback:a.h.reserveTag(595947723),telemetryVisitor:r},b[0].commentId,void 0,F.a.ExpandCard,g.a.SharedComments)),u=!0);x.sb()&&Object(a.i)().assertConditionTag(u||0===b.length||""!==(null===(c=o.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case c.a.LoadComments:l.j(t)&&(i().paneState.initializationStatus===Q.a.Initialized||this.lastInitializationReason!==J.a.NewThread?n(function(e,t,n,i){return function(o,r){o(Y({renderContextType:e,trackback:a.h.reserveTag(595899530),telemetryVisitor:i},t,n));var s=r(),c=Object(z.D)(D.n(s),D.u(s)),d=D.e(s);Object(te.a)({commentData:d,pendingCommentLoad:D.o(s),virtualized:c})&&d.length&&!D.j(s)&&o(Object(C.J)({renderContextType:e,trackback:a.h.reserveTag(595953680),telemetryVisitor:i},d[0].commentId,void 0,F.a.ExpandCard,g.a.SharedComments))}}(f.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(Y({renderContextType:f.a.None,trackback:a.h.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case c.a.CommentContextReload:l.d(t)&&n(function(e,t,n,i){return function(o,r){var s,c,d,u=r(),m=!1,f=[];Object(l.c)(t)?(Object(a.i)().assertConditionTag(Object(z.D)(D.n(u),D.u(u)),"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),f=Object(B.a)(t.commentIds)):f=t.comments;var p=t.contextDetails;x.sb()&&""===(null===(s=p)||void 0===s?void 0:s.selectedCommentId)&&(p=Object(Z.__assign)(Object(Z.__assign)({},p),{selectedCommentId:void 0}));var h=Object(l.c)(t)?[]:t.tasks;o(U(e,i,p,Object(ne.a)({renderContextType:e,telemetryVisitor:i,trackback:a.h.reserveTag(595953677)},{comments:f,numberOfThreads:t.numberOfThreads,tasks:h}))),x.S()&&o(Object(W.a)({renderContextType:e,telemetryVisitor:i,trackback:a.h.reserveTag(595162892)},f,h,n)).catch((function(e){Object(j.b)(e)?Object(a.i)().assertConditionTag(!1,e.message,595645962):Object(a.i)().assertConditionTag(!1,"Unknown error in reloadCommentsAndPreserveSelectionPositionThunk "+e,595645963)}));var v=null===(c=D.j(u))||void 0===c?void 0:c.selectedCardId,y=D.e(u),b=r(),T=D.e(b);if(v){if(!D.j(b)){var I=y.findIndex((function(e){return e.commentId===v}));if(I<0)return;if(T.length){var S=I;S===T.length&&(S=T.length-1);var O=Object($.b)(T[S]);o(Object(C.J)({renderContextType:e,telemetryVisitor:i,trackback:a.h.reserveTag(595953678)},O,void 0,F.a.ExpandCard,g.a.SharedComments)),m=!0}}}else!y.length&&T.length&&(o(Object(C.J)({renderContextType:e,telemetryVisitor:i,trackback:a.h.reserveTag(595947722)},T[0].commentId,void 0,F.a.ExpandCard,g.a.SharedComments)),m=!0);x.sb()&&Object(a.i)().assertConditionTag(m||0===T.length||""!==(null===(d=t.contextDetails)||void 0===d?void 0:d.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(f.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var o,r;this.commonViewStrategy.processCommentEvent(e,t,n,i)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainFocusOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();n.d(t,"a",(function(){return oe}));var oe=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,i,a,r,s,c,d){var u=new A(t,n,i,a,c,d);switch(e.containerType){case o.a.HalfPane:return new ie(u,n,s,c);case o.a.FullPane:return new K(u,n,r,c)}},e}()},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i=n(971),o=n(582),a=o;a.v1=i,a.v4=o,e.exports=a},,,,,,function(e,t,n){"use strict";n(920),n(933);function i(){Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,i=new Array(n);n--;)i[n]=[t[n],e[t[n]]];return i}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)})}n.d(t,"a",(function(){return i}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){n(921),e.exports=n(311).Array.includes},function(e,t,n){"use strict";var i=n(450),o=n(750)(!0);i(i.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(755)("includes")},function(e,t,n){var i=n(923),o=n(924),a=n(926),r=Object.defineProperty;t.f=n(452)?Object.defineProperty:function(e,t,n){if(i(e),t=a(t,!0),i(n),o)try{return r(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(451);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(452)&&!n(453)((function(){return 7!=Object.defineProperty(n(925)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var i=n(451),o=n(388).document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var i=n(451);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(388),o=n(574),a=n(748),r=n(575)("src"),s=n(929),c=(""+s).split("toString");n(311).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(a(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(a(n,r)||o(n,r,e[t]?""+e[t]:c.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[r]||s.call(this)}))},function(e,t,n){e.exports=n(576)("native-function-to-string",Function.toString)},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var i=n(754),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=i(e))<0?o(e+t,0):a(e,t)}},function(e,t,n){n(934),e.exports=n(311).String.trimRight},function(e,t,n){"use strict";n(935)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){var i=n(450),o=n(578),a=n(453),r=n(936),s="["+r+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,n){var o={},s=a((function(){return!!r[e]()||""!=""[e]()})),c=o[e]=s?t(l):r[e];n&&(o[n]=c),i(i.P+i.F*s,"String",o)},l=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(e,t,n){"use strict";var i=n(450),o=n(938)(6),a="findIndex",r=!0;a in[]&&Array(1)[a]((function(){r=!1})),i(i.P+i.F*r,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(755)(a)},function(e,t,n){var i=n(749),o=n(577),a=n(766),r=n(753),s=n(939);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,u=4==e,l=6==e,m=5==e||l,f=t||s;return function(t,s,p){for(var h,C,g=a(t),v=o(g),y=i(s,p,3),b=r(v.length),T=0,I=n?f(t,b):c?f(t,0):void 0;b>T;T++)if((m||T in v)&&(C=y(h=v[T],T,g),e))if(n)I[T]=C;else if(C)switch(e){case 3:return!0;case 5:return h;case 6:return T;case 2:I.push(h)}else if(u)return!1;return l?-1:d||u?u:I}}},function(e,t,n){var i=n(940);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){var i=n(451),o=n(941),a=n(756)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),i(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var i=n(752);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(450);i(i.S+i.F,"Object",{assign:n(943)})},function(e,t,n){"use strict";var i=n(452),o=n(944),a=n(948),r=n(949),s=n(766),c=n(577),d=Object.assign;e.exports=!d||n(453)((function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=i}))?function(e,t){for(var n=s(e),d=arguments.length,u=1,l=a.f,m=r.f;d>u;)for(var f,p=c(arguments[u++]),h=l?o(p).concat(l(p)):o(p),C=h.length,g=0;C>g;)f=h[g++],i&&!m.call(p,f)||(n[f]=p[f]);return n}:d},function(e,t,n){var i=n(945),o=n(947);e.exports=Object.keys||function(e){return i(e,o)}},function(e,t,n){var i=n(748),o=n(751),a=n(750)(!1),r=n(946)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,d=[];for(n in s)n!=r&&i(s,n)&&d.push(n);for(;t.length>c;)i(s,n=t[c++])&&(~a(d,n)||d.push(n));return d}},function(e,t,n){var i=n(576)("keys"),o=n(575);e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyType=void 0;var i=n(951),o=n(581);function a(e){e&&o.CustomTypeRegistry.handleError("Type of property does not match type in CustomTypes definition.")}function r(e,t,n){for(var a=0,r=Object.keys(e);a<r.length;a++){var s=r[a],c=t[s];if(c){var d=i.readPropertyInfo(c)[1];e[s]=u(e[s],d,n)}else s.startsWith("$")||o.CustomTypeRegistry.handleError('Property "'+s+'" does not exist in CustomType definition.')}return e}function s(e,t){for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];e[o]=u(e[o],t)}return e}function c(e,t,n){for(var o=0,a=Object.keys(t);o<a.length;o++){var r=a[o],s=i.readPropertyInfo(t[r]),c=s[0],u=s[1];if((e.hasOwnProperty(r)||!c)&&void 0===e[r]){var l=d(void 0,u,n);void 0!==l&&(e[r]=l)}}return e}function d(e,t,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),!n&&!i&&null==e)if("string"==typeof t)switch(t){case"$string":return"";case"$number":return 0;case"$boolean":return!1;case"$any":return;default:return c(e={},o.CustomTypeRegistry.getTypeInfo(t),n)}else{var a=t[0],r=t[1];switch(a){case"$array":return[];case"$indexer":return{};case"$union":return c(e={},o.CustomTypeRegistry.getTypeInfo(r[0]),n)}}return null!=e?e:void 0}function u(e,t,n){if(void 0===n&&(n=!1),null!=e)if("string"==typeof t)switch(t){case"$string":a("string"!=typeof e);break;case"$number":a("number"!=typeof e);break;case"$boolean":a("boolean"!=typeof e);break;case"$any":if("object"==typeof e)for(var i=0,l=Object.keys(e);i<l.length;i++){var m=l[i];e[m]=u(e[m],t,n)}break;default:var f=o.CustomTypeRegistry.getTypeInfo(t);return f?(r(e,f,n),c(e,f,n)):e}else{var p=t[0],h=t[1];switch(p){case"$array":var C=Array.isArray(e);return a(!C),C?s(e,h):e;case"$indexer":var g=!("object"==typeof e&&Array.isArray(e)||"object"!=typeof e);return a(!g),g?s(e,h):e;case"$union":var v=function(e,t,n){for(var i=0,a=Object.keys(t);i<a.length;i++){for(var r=a[i],s=!0,c=o.CustomTypeRegistry.getTypeInfo(t[r]),d=0,u=Object.keys(e);d<u.length;d++){if(!c[u[d]]){s=!1;break}}if(s)return c}}(e,h);return v?(r(e,v,n),c(e,v,n)):(o.CustomTypeRegistry.handleError("Json object is not assignable to any custom type in union."),e);case"$optional":return u(e,h),d(e,t,n,!0);case"$external":if("object"==typeof e){e=u(e,"$any",n);var y=o.CustomTypeRegistry.getExternalType(h);if(y&&y.parse)return y.parse(e)}}}else e=d(e,t,n);return e}t.verifyType=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readPropertyInfo=void 0,t.readPropertyInfo=function(e){return Array.isArray(e)&&2===e.length&&"opt-field"===e[0]?[!0,e[1]]:[!1,e]}},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850"}))}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),i.createElement("path",{type:"path",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("defs",{key:0},i.createElement("style",null,".cls-1{fill:currentColor;}")),i.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},i.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},i.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("defs",{key:0},i.createElement("style",null,".cls-1{fill:currentColor;}")),i.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},i.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},i.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("defs",{key:0},i.createElement("style",null,".cls-1{fill:currentColor;}")),i.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},i.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},i.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),i.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),i.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),i.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("defs",{key:0},i.createElement("style",null,".cls-1{fill:currentColor;}")),i.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},i.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},i.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},i.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},i.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},i.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,i.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},function(e,t,n){var i=n(1);function o(e){return i.createElement("svg",e,[i.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),i.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e){e.exports={SharedCommentsVersion:"2.48.24"}},function(e,t,n){var i,o,a=n(770),r=n(771),s=0,c=0;e.exports=function(e,t,n){var d=t&&n||0,u=t||[],l=(e=e||{}).node||i,m=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==m){var f=a();null==l&&(l=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==m&&(m=o=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:c+1,C=p-s+(h-c)/1e4;if(C<0&&void 0===e.clockseq&&(m=m+1&16383),(C<0||p>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,c=h,o=m;var g=(1e4*(268435455&(p+=122192928e5))+h)%4294967296;u[d++]=g>>>24&255,u[d++]=g>>>16&255,u[d++]=g>>>8&255,u[d++]=255&g;var v=p/4294967296*1e4&268435455;u[d++]=v>>>8&255,u[d++]=255&v,u[d++]=v>>>24&15|16,u[d++]=v>>>16&255,u[d++]=m>>>8|128,u[d++]=255&m;for(var y=0;y<6;++y)u[d+y]=l[y];return t||r(u)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"isChangeGateEnabledSample",(function(){return G})),n.d(i,"isAnimationFrameForResizeObserverEnabled",(function(){return q}));var o,a,r,s=n(0),c=n(530),d=n(246),u=n(186),l=n(150),m=n(25);function f(e){switch(e){case 0:default:return m.b.CommentThread}}!function(e){e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(o||(o={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(a||(a={})),function(e){e[e.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(r||(r={}));var p,h=function(){function e(e,t,n){void 0===n&&(n=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.possibleTopForNextContainer=0,this.renderMode=m.d.Integrated,this.constructContainerId=e,this.ulsLogger=t,this.activeContainerAnchorLeft=n}return e.prototype.getAggregateHeight=function(){return this.aggregateHeight},e.prototype.calculateNewPositions=function(e,t,n){this.disableRepositioningAnimation=!!n&&!!n.disableRepositioningAnimation,this.positionFixed=!!n&&!!n.positionFixed,this.shouldUpdatePositions=!n||!1!==n.shouldUpdatePositions;var i=e[0];if(this.anchorLeft=i&&i.anchorLeft?i.anchorLeft:0,n&&n.activeContainerInfo){var o=n.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(e,t,o)}else{var a=n?n.topOfFirstContainer:void 0;this.setRestPositionOfContainers(e,t,a)}},e.prototype.updateContainersPositions=function(e,t,n){this.calculateNewPositions(e,t,n)},e.prototype.updateContainerPositionsAroundActiveContainer=function(e,t,n){var i=t[n.containerId];if(i){var r=i.floatingContainerRef,c=this.shouldUpdatePositions&&r?r.height():i.position.height;this.shouldUpdatePositions&&r&&(r.anchorPoint().y!==i.anchorTop||r.anchorPoint().x!==this.activeContainerAnchorLeft)&&r.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:i.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,n.containerId,Object(s.__assign)(Object(s.__assign)({},i.position),{x:this.activeContainerAnchorLeft,y:i.anchorTop})),this.updateContainerPositionsAboveActiveContainer(e,t,i.anchorTop,n.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(i,i.anchorTop,c),this.updateContainerPositionsDownwards(e,t,n.containerPositionIndex+1),this.aggregateHeight=n.containerPositionIndex===e.length-1?c+i.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,o.msoulscat_Wac_Telemetry,a.Error,"Floating container info does not exist for the active container Id: "+n.containerId)},e.prototype.updateContainerPositionsDownwards=function(e,t,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);for(var o={},a=n;a<e.length;a+=1){if((r=e[a])&&r.contentId){if(!(s=this.getFloatingContainerInfo(r,t)))continue;o[r.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}}for(a=n;a<e.length;a+=1){var r,s=this.getFloatingContainerInfo(e[a],t),c=(r=e[a])&&r.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(e[a],t,o[c]);if(a===e.length-1&&s&&(this.aggregateHeight=o[c]+s.position.y),i&&d)return}},e.prototype.updateContainerPositionsAboveActiveContainer=function(e,t,n,i){var o=e[0]?e[0].anchorTop:void 0;this.setRestPositionOfContainers(e.slice(0,i+1),t,o);for(var a=n,r=i;r>=0;r-=1){var c=this.getFloatingContainerInfo(e[r],t);if(void 0===c||this.getBottomPositionOfContainer(c)<=a)return;var d=c.floatingContainerRef,u=a-(this.shouldUpdatePositions&&d?d.height():c.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:u},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,this.getContainerId(e[r]),Object(s.__assign)(Object(s.__assign)({},c.position),{x:this.anchorLeft,y:u})),a=u}},e.prototype.setRestPositionOfContainers=function(e,t,n){var i;if(e.length>0){var o=this.getFloatingContainerInfo(e[0],t);if(void 0===o)return;var a=null===(i=o.floatingContainerRef)||void 0===i?void 0:i.anchorPoint().y,r=this.shouldUpdatePositions&&void 0!==a&&!this.positionFixed?a:o.position.y;this.possibleTopForNextContainer=null!=n?n:Math.max(o.anchorTop,r),this.updateContainerPositionsDownwards(e,t,0)}},e.prototype.getFloatingContainerInfo=function(e,t){return t[this.getContainerId(e)]},e.prototype.getContainerId=function(e){var t=e.contentId;return this.constructContainerId({contentId:t,contentType:f(e.containerContentType),renderMode:this.renderMode})},e.prototype.updateFloatingContainerPosition=function(e,t,n){var i=this.getFloatingContainerInfo(e,t);if(void 0===i)return!1;var o=this.shouldUpdatePositions&&i.floatingContainerRef?i.floatingContainerRef.anchorPoint().y:i.position.y,a=Math.max(this.possibleTopForNextContainer,i.anchorTop);return a!==o&&(this.shouldUpdatePositions&&i.floatingContainerRef&&i.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:a},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,this.getContainerId(e),Object(s.__assign)(Object(s.__assign)({},i.position),{x:this.anchorLeft,y:a}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(i,a,n),a===o},e.prototype.getBottomPositionOfContainer=function(e,t,n){var i;void 0===t&&(t=void 0),void 0===n&&(n=void 0);var o,a,r=e.floatingContainerRef,s=null===(i=r)||void 0===i?void 0:i.anchorPoint().y;return this.shouldUpdatePositions&&r&&void 0!==s?(o=s,a=r.height()):(o=e.position.y,a=e.position.height),(void 0!==t?t:o)+(void 0!==n?n:a)+10},e.prototype.updateFloatingContainerPositionInCache=function(e,t,n){e[t].position=n},e}(),C=n(308),g=function(){function e(e){this.eventSink=e}return e.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},e}(),v=function(){function e(){this.handlers=[]}return e.prototype.subscribe=function(e){var t=new g(this);return this.handlers.push({subscription:t,handler:e}),t},e.prototype.unsubscribe=function(e){this.handlers=this.handlers.filter((function(t){return t.subscription!==e}))},e.prototype.trigger=function(e){this.handlers.forEach((function(t){return t.handler(e,t.subscription)}))},e}(),y=function(){function e(e){this.onContainerShouldBeCreated=new v,this.motionDuration=C.a.duration4,this.containerVirtualizationEnabled=!1,e&&(this.containerVirtualizationEnabled=!!e.containerVirtualizationEnabled)}return e.prototype.updateContainersVisibility=function(e,t,n,i,o){var a=this;if(void 0===n&&(n=!1),void 0===o&&(o=!1),t.height>0){var r={viewportTop:t.y-t.height/2,viewportBottom:t.y+1.5*t.height,containerIdToInfoMap:e,activeContainerId:i};if(!o&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(n,r);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(r),setTimeout((function(){a.updatePositions(r,n),window.clearTimeout(a.hideContainersTimeout),a.hideContainersTimeout=window.setTimeout((function(){a.hideContainersOutsideViewport(r),a.posUpdateAnimationsInProgress=!1}),parseInt(a.motionDuration,10))}),0)}},e.prototype.handleContainerVirtualization=function(e,t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(i){var o=n.extractContainerInfo(i,t);n.updateContainerVisibility(o,t.activeContainerId===i),n.updateContainerPosition(o,e)}))},e.prototype.showContainersComingIntoViewport=function(e){var t=this;Object.keys(e.containerIdToInfoMap).forEach((function(n){var i=t.extractContainerInfo(n,e);t.updateContainerVisibility(i,e.activeContainerId===n)}))},e.prototype.hideContainersOutsideViewport=function(e){var t=this;Object.keys(e.containerIdToInfoMap).forEach((function(n){var i=t.extractContainerInfo(n,e);t.updateContainerVisibility(i,e.activeContainerId===n)}))},e.prototype.updatePositions=function(e,t){var n=this;Object.keys(e.containerIdToInfoMap).forEach((function(i){var o=n.extractContainerInfo(i,e);n.updateContainerPosition(o,t)}))},e.prototype.updateContainerVisibility=function(e,t){e.containerRef&&e.containerElement&&(e.isContainerInViewport||t?"block"!==e.containerElement.style.display&&(e.containerElement.style.display="block",this.containerVirtualizationEnabled&&e.containerRef.updateContainerVirtualization(!1),t&&e.containerRef.setFocus()):!1===e.isContainerInViewport&&"none"!==e.containerElement.style.display&&(e.containerElement.style.display="none",this.containerVirtualizationEnabled&&e.containerRef.updateContainerVirtualization(!0)))},e.prototype.updateContainerPosition=function(e,t){var n=e.containerElement;n&&(n.style.top=e.containerPosition.y+"px",n.style.left=e.containerPosition.x+"px",n.style.transitionDuration=t?"0ms":this.motionDuration)},e.prototype.extractContainerInfo=function(e,t){var n,i=t.containerIdToInfoMap[e],o=i.floatingContainerRef,a=i.position,r={containerElement:void 0,isContainerInViewport:a.y+a.height>=t.viewportTop&&a.y<=t.viewportBottom,containerRef:void 0,containerPosition:a};return o&&(r.containerRef=o,r.containerElement=null===(n=document.getElementById(o.parentDivId()))||void 0===n?void 0:n.firstChild),r},e}(),b=n(3),T=n(231),I=n(120),S=n(1),O=n(42),D=n(121);!function(e){e[e.Enablement=0]="Enablement",e[e.Focus=1]="Focus",e[e.Hover=2]="Hover",e[e.Resize=3]="Resize",e[e.Visibility=4]="Visibility"}(p||(p={}));var w,j=n(133);function P(e,t){return{type:e,payload:t}}!function(e){e.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",e.EmptyActionType="",e.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",e.RepositionType="REPOSITION_FLOATING_CONTAINER",e.SetContentType="SET_CONTENT",e.UpdateContainerDirectionType="UPDATE_FLOATING_CONTAINER_DIRECTION",e.UpdateContainerWidthType="UPDATE_FLOATING_CONTAINER_WIDTH",e.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",e.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",e.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION"}(w||(w={}));var x={anchorPoint:new function(e,t){this.x=e,this.y=t}(0,0),isAnchorPointOnRight:!1};function E(e,t){return void 0===t&&(t=x),{anchorPoint:t.anchorPoint,contentIdentifier:e,disableRepositioningAnimation:!1,horizontalOffset:0,isAnchorPointOnRight:t.isAnchorPointOnRight,isVisible:!1,isVirtualized:!1,maxDimensions:t.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1}}var A={contentId:"",contentType:m.b.Empty};function k(e,t){switch(void 0===e&&(e=E(A)),void 0===t&&(t=P(w.EmptyActionType,{})),t.type){case w.ChangeRenderedContentIdentifierType:return function(e,t){if(e.contentIdentifier.contentId===t.payload.newContentIdentifier.contentId&&e.contentIdentifier.contentType===t.payload.newContentIdentifier.contentType)return e;return Object(s.__assign)(Object(s.__assign)({},e),{contentIdentifier:t.payload.newContentIdentifier})}(e,t);case w.RemoveVisibilityAnimationType:return function(e){return Object(s.__assign)(Object(s.__assign)({},e),{useVisibilityAnimation:!1})}(e);case w.RepositionType:return function(e,t){if(e.anchorPoint.x===t.payload.anchorPoint.x&&e.anchorPoint.y===t.payload.anchorPoint.y&&e.disableRepositioningAnimation===t.payload.disableRepositioningAnimation&&e.positionFixed===t.payload.positionFixed)return e;return Object(s.__assign)(Object(s.__assign)({},e),{anchorPoint:t.payload.anchorPoint,disableRepositioningAnimation:t.payload.disableRepositioningAnimation,positionFixed:t.payload.positionFixed})}(e,t);case w.SetContentType:return function(e,t){return Object(s.__assign)(Object(s.__assign)({},e),{content:t.payload.content,isVisible:!!t.payload.content&&e.isVisible})}(e,t);case w.UpdateContainerDirectionType:return function(e,t){return Object(s.__assign)(Object(s.__assign)({},e),{isAnchorPointOnRight:t.payload.isAnchorPointOnRight,horizontalOffset:t.payload.isAnchorPointOnRight?t.payload.currentWidth:0})}(e,t);case w.UpdateContainerWidthType:return function(e,t){return Object(s.__assign)(Object(s.__assign)({},e),{horizontalOffset:e.isAnchorPointOnRight?t.payload.width:0})}(e,t);case w.UpdateContentMaxDimensionsType:return function(e,t){if(e.maxDimensions.height===t.payload.maxDimensions.height&&e.maxDimensions.width===t.payload.maxDimensions.width)return e;return Object(s.__assign)(Object(s.__assign)({},e),{maxDimensions:t.payload.maxDimensions})}(e,t);case w.UpdateContainerVisibilityType:return function(e,t){return Object(s.__assign)(Object(s.__assign)({},e),{isVisible:t.payload.isVisible,useVisibilityAnimation:t.payload.useVisibilityAnimation})}(e,t);case w.UpdateContainerVirtualizationType:return function(e,t){return Object(s.__assign)(Object(s.__assign)({},e),{isVirtualized:t.payload.isVirtualized})}(e,t);default:return e}}function _(e){return P(w.SetContentType,{content:e})}var R=function(e){return e.isVirtualized},M=n(182),V=n(5),F=n(11),L=Object(M.a)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),N=Object(M.a)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),U=Object(F.c)((function(e,t,n,i){return{floatingContainerView:Object(V.db)({animationName:t?e?L:N:void 0,animationDuration:"300ms",animationTimingFunction:C.b.decelerate,background:"transparent",position:i?"fixed":"absolute",transitionDuration:e&&!n?C.a.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:C.b.decelerate,visibility:e?"visible":"hidden"})}}));var B,z=n(672),H=n(29);function W(){return B||(B=Object(H.a)())}function G(){return W().isChangeGateEnabled("SampleChangeGate",Object(H.c)(1234567))}function q(){return W().isChangeGateEnabled("AnimationFrameForResizeObserver",Object(H.c)(4249231))}function Y(e){return"floatingContainerView"+e.contentId+"Type"+e.contentType}var K=function(e){function t(t){var n,o,a,r=e.call(this,t)||this;return r.handleResizeUpdates=function(e){e.forEach((function(e){r.props.updateHorizontalOffset(e.contentRect.width),r.props.onContainerStateChanged.trigger({stateChangeType:p.Resize,contentIdentifier:r.props.contentIdentifier,contentRect:e.contentRect})}))},r.triggerVisibilityUpdateNotification=function(){r.props.onContainerStateChanged.trigger({stateChangeType:p.Visibility,contentIdentifier:r.props.contentIdentifier,isVisible:r.props.isVisible})},r.getHostedResource=function(e){return{id:e}},r.onFocusChange=function(e,t){var n=e.relatedTarget||document.activeElement;r.parentDivRef&&n instanceof HTMLElement&&r.parentDivRef.contains(n)||r.props.onContainerStateChanged.trigger({stateChangeType:p.Focus,contentIdentifier:r.props.contentIdentifier,isFocused:t})},r.onFocusOut=function(e){r.onFocusChange(e,!1)},r.onFocusIn=function(e){r.onFocusChange(e,!0)},r.onMouseEnter=function(){r.props.onContainerStateChanged.trigger({stateChangeType:p.Hover,contentIdentifier:r.props.contentIdentifier,isHovered:!0})},r.onMouseLeave=function(){r.props.onContainerStateChanged.trigger({stateChangeType:p.Hover,contentIdentifier:r.props.contentIdentifier,isHovered:!1})},r.setContentRef=function(e){r.contentRef=e},r.setParentDivRef=function(e){e!==r.parentDivRef&&(r.parentDivRef&&(r.resizeObserver.unobserve(r.parentDivRef),r.parentDivRef.removeEventListener("focusin",r.onFocusIn,!0),r.parentDivRef.removeEventListener("focusout",r.onFocusOut,!0)),e&&(r.resizeObserver.observe(e),e.addEventListener("focusin",r.onFocusIn,!0),e.addEventListener("focusout",r.onFocusOut,!0))),r.parentDivRef=e},r.contentRef=void 0,r.parentDivRef=void 0,r.resizeObserver=new z.a((function(e){i.isAnimationFrameForResizeObserverEnabled()?window.requestAnimationFrame((function(){r.handleResizeUpdates(e)})):r.handleResizeUpdates(e)})),r.setContentRef=r.setContentRef.bind(r),r.setParentDivRef=r.setParentDivRef.bind(r),r.getHostedResource=(n=r.getHostedResource.bind(r),a=[{}],function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.every((function(t,n){return t===e[n]}))?o:(a=e,o=n.apply(void 0,Object(s.__spread)(e)))}),r}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},t.prototype.componentDidUpdate=function(e){var t=this,n=!1;e.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?n=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){n&&t.triggerVisibilityUpdateNotification(),t.props.removeVisibilityAnimation()}),300)},t.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},t.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},t.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},t.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var e=U(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),t=this.props.content;return S.createElement("div",{key:Y(this.props.contentIdentifier),id:Y(this.props.contentIdentifier),ref:this.setParentDivRef,className:e.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x-this.props.horizontalOffset,top:this.props.anchorPoint.y}},S.createElement(t,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized}))},t}(S.Component);var J=Object(D.connect)((function(e){return{anchorPoint:e.anchorPoint,content:e.content,contentIdentifier:e.contentIdentifier,disableRepositioningAnimation:e.disableRepositioningAnimation,horizontalOffset:e.horizontalOffset,isVisible:e.isVisible,isVirtualized:e.isVirtualized,maxDimensions:e.maxDimensions,positionFixed:e.positionFixed,useVisibilityAnimation:e.useVisibilityAnimation}}),(function(e,t){return{removeVisibilityAnimation:function(){e(P(w.RemoveVisibilityAnimationType,{}))},updateHorizontalOffset:function(t){e(function(e){return P(w.UpdateContainerWidthType,{width:e})}(t))}}}),void 0,{withRef:!0})(K),Q=function(){function e(e,t,n,i){var o;this.onContainerStateChanged=new v,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===i.isDraftContainer&&(this.floatingContainerCreationActivity=Object(b.i)().createActivityObject("FloatingContainerCreation",Object(b.j)(b.g.GlobalAPI),b.a.None)),this.store=(o=E(n,i))?Object(j.createStore)(k,o):Object(j.createStore)(k),this.extensionProvider=t,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=i.containerId||Object(I.a)(),e.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(n),this.render()}return e.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},e.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},e.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},e.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},e.prototype.isAnchorPointOnRight=function(){return this.store.getState().isAnchorPointOnRight},e.prototype.parentDivId=function(){return this.parentDiv.id},e.prototype.observeStore=function(e){var t=this;if(Object(m.g)(this.extensionProvider)){var n=e;this.unsubscribeStoreListener=this.store.subscribe((function(){var e=t.contentIdentifier();n.contentId===e.contentId&&n.contentType===e.contentType||(n=e,t.removeExtensionUpdatedEventSubscription(),t.setContentFromExtension())}))}},e.prototype.setContentFromExtension=function(){var e=this,t=void 0;if(Object(m.g)(this.extensionProvider)){if(t=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=t.onUpdated.subscribe((function(t){e.onUpdatedEventHandler()}))),t.priority===m.c.Disabled)return this.canShow=!1,void this.store.dispatch(_(void 0))}else t=this.extensionProvider.getExtension();this.canShow=!0,Object(T.b)().getComponent(t.componentKey).then((function(t){e.store.dispatch(_(t.component)),e.floatingContainerCreationActivity&&(e.floatingContainerCreationActivity.successTag(593872975),e.floatingContainerCreationActivity=void 0)})).catch((function(e){Object(b.i)().assertConditionTag(!1,"Error when registering component in setContentFromExtension "+e,595632583)}))},e.prototype.render=function(){var e={onContainerStateChanged:this.onContainerStateChanged};O.render(S.createElement(D.Provider,{store:this.store},S.createElement(J,Object(s.__assign)({ref:this.setFloatingContainerRef},e))),this.parentDiv)},e.prototype.updateContainerPosition=function(e){var t,n,i;this.store.dispatch((t=e.anchorPoint,n=!!e.disableRepositioningAnimation,i=!!e.positionFixed,P(w.RepositionType,{anchorPoint:t,disableRepositioningAnimation:n,positionFixed:i})))},e.prototype.updateMaximumDimensions=function(e){this.store.dispatch(function(e){return P(w.UpdateContentMaxDimensionsType,{maxDimensions:e})}(e))},e.prototype.updateContainerVirtualization=function(e){e&&!R(this.store.getState())?this.store.dispatch(P(w.UpdateContainerVirtualizationType,{isVirtualized:!0})):R(this.store.getState())&&this.store.dispatch(P(w.UpdateContainerVirtualizationType,{isVirtualized:!1}))},e.prototype.showFloatingContainer=function(e){return!!this.canShow&&(this.store.dispatch(function(e){return P(w.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:e})}(!!e)),!0)},e.prototype.hideFloatingContainer=function(e){this.store.dispatch(function(e){return P(w.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:e})}(!!e))},e.prototype.destroyFloatingContainer=function(e){var t=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(e),e?setTimeout((function(){t.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},e.prototype.cleanupDomOnDestroy=function(){O.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},e.prototype.isShowing=function(){return this.store.getState().isVisible},e.prototype.setDirection=function(e){this.store.dispatch(function(e,t){return P(w.UpdateContainerDirectionType,{isAnchorPointOnRight:e,currentWidth:t})}(e,this.width()||0))},e.prototype.setFocus=function(){this.floatingContainerRef&&this.floatingContainerRef.setFocus()},e.prototype.changeRenderedContentIdentifier=function(e){this.store.dispatch(function(e){return P(w.ChangeRenderedContentIdentifierType,{newContentIdentifier:e})}(e))},e.prototype.onUpdatedEventHandler=function(){var e=this.canShow;this.setContentFromExtension(),e!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:p.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},e.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},e.prototype.setFloatingContainerRef=function(e){this.floatingContainerRef=e?e.getWrappedInstance():void 0},e}(),Z=new(function(){function e(){}return e.prototype.createFloatingContainer=function(e,t,n,i){return new Q(e,t,n,i)},e}()),X=n(2);function $(e){return e.contentId+"_"+e.contentType+"_"+e.renderMode}var ee={width:0,height:0,x:0,y:0};function te(e){return void 0!==e.hasBeenRendered}var ne,ie=function(){function e(e,t,n,i,o,a){var r=this;this.supportedContentTypes=[m.b.CommentThread],this.getContentCardIndex=function(e,t){if(!r.containerIdToInfoMap[e])return r.ULS.sendTraceTag(595883362,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[getContentCardIndex]Container with id "+e+" does not exist."),-1;var n=r.containerIdToInfoMap[e].anchorTop;n=t?Math.max(n,t):n;for(var i=r.getContentCardInsertionPoint(n),o=i;o<r.contentAnchorPositions.length;o+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(e,o))return o;for(o=0;o<i;o+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(e,o))return o;return-1},this.initializeExtensionProviderCollection=function(e){r.extensionProviderCollection=r.contentExtensionHostAPIGetter().getExtensions(r.supportedContentTypes),r.updateContentTypeToExtensionProviderMap(e),r.extensionProviderCollection.onUpdated.subscribe((function(){return r.updateContentTypeToExtensionProviderMap(e)}))},this.getContentCardInsertionPoint=function(e){for(var t,n=0,i=r.contentAnchorPositions.length;n<i;){t=n+Math.floor((i-n)/2),r.contentAnchorPositions[t].anchorTop<e-4?n=t+1:i=t}return n},this.getContainerStateChangedCallback=function(e){return function(t,n){switch(t.stateChangeType){case p.Resize:e(t,n)}}},this.renderFloatingContainerAtAnchorPosition=function(e){var t=r.containerIdToInfoMap[e];t&&t.floatingContainerRef&&t.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=function(e){r.contentTypeToExtensionProviderMap.clear(),void 0!==r.extensionProviderCollection?(r.areCommentExtensionProvidersDefinedOnce||(r.areCommentExtensionProvidersDefinedOnce=0!==r.extensionProviderCollection.providers.filter((function(e){return e.scope.contentType===m.b.CommentThread&&e.scope.renderMode===m.d.Integrated})).length),r.extensionProviderCollection.providers.forEach((function(e){e.scope.renderMode===m.d.Integrated&&r.contentTypeToExtensionProviderMap.set(e.scope.contentType,e)})),e()):r.ULS.sendTraceTag(595886287,X.a.msoulscat_Wac_Telemetry,X.b.Error,"extensionProviderCollection should not be null")},this.featureSettings=a,this.contentExtensionHostAPIGetter=e,this.dhcContainerPanel=t,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=o||ee,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=n,this.ULS=i}return e.prototype.addContentAnchorPosition=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=-1);var i=n>-1?n:this.getContentCardInsertionPoint(e.anchorTop)+t;return this.contentAnchorPositions.splice(i,0,e),i},e.prototype.getContainerIdToInfoMap=function(){return this.containerIdToInfoMap},e.prototype.getContentAnchorPositions=function(){return this.contentAnchorPositions},e.prototype.getContentAnchorPosition=function(e){var t=this.getContentCardIndex(e);if(t>-1)return this.contentAnchorPositions[t]},e.prototype.initializeAndRenderFloatingContainer=function(e,t,n,i,o){void 0===i&&(i=!0),void 0===o&&(o=!1);var a;return a=this.initializeFloatingContainerState(e,n,i,o),this.featureSettings.InteractivePerfImprovementEnabled||this.renderFloatingContainerAtAnchorPosition(t),a},e.prototype.isContainerInViewPort=function(e){return e.anchorTop>this.viewportInfo.y-.5*this.viewportInfo.height&&e.anchorTop<this.viewportInfo.y+1.5*this.viewportInfo.height},e.prototype.removeContentAnchorPosition=function(e){var t=this.getContentCardIndex(e);return-1===t?(this.ULS.sendTraceTag(595736577,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[RemoveContentAnchorPosition]Content anchor position for id "+e+" does not exist."),-1):(this.contentAnchorPositions.splice(t,1),t)},e.prototype.checkIfContainerIdCorrespondsToGivenPosition=function(e,t){return e===this.getContainerIdUsingPositionalIndex(t)},e.prototype.getContainerIdUsingPositionalIndex=function(e){var t=this.contentAnchorPositions[e];return $({contentId:t.contentId,contentType:f(t.containerContentType),renderMode:m.d.Integrated})},e.prototype.createFloatingContainer=function(e,t,n,i){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,e,{contentId:t.contentId,contentType:f(t.containerContentType)},{anchorPoint:{x:0,y:n},isAnchorPointOnRight:!1,isDraftContainer:i});this.ULS.sendTraceTag(595883361,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")},e.prototype.initializeFloatingContainerState=function(e,t,n,i){if(e){var o=this.contentTypeToExtensionProviderMap.get(f(e.containerContentType));if(void 0===o)return this.ULS.sendTraceTag(595883363,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[initializeFCState]ExtensionProvider not found for contentType "+e.containerContentType),!1;var a=e.contentId;if(!a)return this.ULS.sendTraceTag(595883407,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[initializeFCState]ContentId is null or empty."),!1;var r=$({contentId:a,contentType:f(e.containerContentType),renderMode:m.d.Integrated}),c=void 0;if(n){if(!(c=this.createFloatingContainer(o,{contentId:a,containerContentType:e.containerContentType},e.anchorTop,i)))return this.ULS.sendTraceTag(595886286,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[createFloatingContainer] Could not create fc for content id "+a),!1;c.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(t))}if(this.containerIdToInfoMap[r])this.containerIdToInfoMap[r].floatingContainerRef=c;else{var d=Object(s.__assign)(Object(s.__assign)({position:{height:0,width:0,x:0,y:e.anchorTop}},this.containerIdToInfoMap[r]),{anchorTop:e.anchorTop,floatingContainerRef:c,hasBeenRendered:!1});this.containerIdToInfoMap[r]=d}return!0}return!1},e}(),oe=function(){function e(e,t,n,i,o,a){var r=this;this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.timeoutsToCreateContainer={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.emitEvent=function(e,t){if(r.store.isCommentPaneOpen||!r.store.dhcContainerPanel||!r.store.areCommentExtensionProvidersDefinedOnce)return r.store.ULS.sendTraceTag(595886288,X.a.msoulscat_Wac_Telemetry,X.b.Warning,"FCM not handling the event. {\n          isCommentPaneOpen: "+r.store.isCommentPaneOpen+",\n          dhcContainerPanelNotDefined: "+!r.store.dhcContainerPanel+",\n          extensionProvidersNotDefined: "+!r.store.areCommentExtensionProvidersDefinedOnce+"\n        }"),void(t&&t.viewportInfo&&(r.store.viewportInfo=t.viewportInfo));switch(e){case 0:if(t&&t.contentAnchorPosition){var n=t.contentAnchorPosition.contentId,i=t.noOfPrecedingThreadsOnSameLine?t.noOfPrecedingThreadsOnSameLine:0;if(!n)return void r.store.ULS.sendTraceTag(595903774,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[AddContainer]ContentId is null.");var o=$({contentId:n,contentType:f(t.contentAnchorPosition.containerContentType),renderMode:m.d.Integrated});if((C=r.store.getContainerIdToInfoMap()[o])&&C.floatingContainerRef)return void r.store.ULS.sendTraceTag(595097123,X.a.msoulscat_Wac_Telemetry,X.b.Warning,"[AddContainer]Container already exists.");if(r.store.initializeAndRenderFloatingContainer(t.contentAnchorPosition,o,r.onContainerResize,void 0,!0)){r.store.addContentAnchorPosition(t.contentAnchorPosition,i);var a={contentId:n,containerContentType:t.contentAnchorPosition.containerContentType};t.shouldSetFocus&&r.emitEvent(2,{containerContentDescriptor:a})}}break;case 1:if(t&&t.containerContentDescriptor){if(!t.containerContentDescriptor.contentId)return void r.store.ULS.sendTraceTag(595903775,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[DeleteContainer]ContentId is null.");o=$({contentId:t.containerContentDescriptor.contentId,contentType:f(t.containerContentDescriptor.containerContentType),renderMode:m.d.Integrated});if(!(C=r.store.getContainerIdToInfoMap()[o]))return void r.store.ULS.sendTraceTag(595723333,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[DeleteContainer]Container info for id "+o+" does not exist.");var s=C.floatingContainerRef,c=!r.featureSettings.InteractivePerfImprovementEnabled&&s?s.anchorPoint().y:C.position.y,d=r.deleteContainer(o,!!t.animateOutOnDeletion);if(-1===d)return;r.store.activeContainerId&&r.store.activeContainerId!==o?r.positionFloatingContainers(r.store.getContentAnchorPositions(),void 0,r.store.activeContainerId):r.positionFloatingContainers(r.store.getContentAnchorPositions().slice(d),c)}break;case 2:if(t&&t.containerContentDescriptor){if(!t.containerContentDescriptor.contentId)return void r.store.ULS.sendTraceTag(595903777,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[FocusContainer]ContentId is null.");var u=$({contentId:t.containerContentDescriptor.contentId,contentType:f(t.containerContentDescriptor.containerContentType),renderMode:m.d.Integrated});if(!r.store.getContainerIdToInfoMap()[u])return r.store.ULS.sendTraceTag(595903778,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[FocusContainer]Container with id "+u+" does not exist"),void r.setInitialActiveContainerId(t.containerContentDescriptor);r.store.activeContainerId!==u&&(r.clearSelection(!0),r.positionFloatingContainers(r.store.getContentAnchorPositions(),void 0,u,void 0,!0));var l=r.store.getContainerIdToInfoMap()[u].floatingContainerRef;t.shouldSetFocus&&l&&l.setFocus(),r.store.activeContainerId=u}break;case 3:t&&t.contentAnchorPositions&&r.processContentAnchorPositionsInView(t.contentAnchorPositions);break;case 4:t&&t.viewportInfo&&(r.store.viewportInfo=t.viewportInfo,r.featureSettings.SynchronousContainerPositioningEnabled||r.positionFloatingContainers());break;case 5:if(t&&t.infoToReplaceContent){var p=t.infoToReplaceContent.currentContentId,h=t.infoToReplaceContent.newContentId;if(!p||!h)return void r.store.ULS.sendTraceTag(595855174,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[ReplaceContainerContent]"+(p?"NewContentId":"CurrentContentId")+" is null.");var C,g=$({contentId:p,contentType:f(t.infoToReplaceContent.containerContentType),renderMode:m.d.Integrated});if(!(C=r.store.getContainerIdToInfoMap()[g]))return void r.store.ULS.sendTraceTag(595855175,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[ReplaceContainerContent]ContainerInfo for id "+g+" does not exist");if(!C.floatingContainerRef)return void r.store.ULS.sendTraceTag(595855176,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[ReplaceContainerContent]FloatingContainerRef with id "+g+" does not exist");C.floatingContainerRef.changeRenderedContentIdentifier({contentId:h,contentType:f(t.infoToReplaceContent.containerContentType)}),r.replacementContentId=h;var v=$({contentId:h,contentType:f(t.infoToReplaceContent.containerContentType),renderMode:m.d.Integrated}),y=r.store.getContentCardIndex(g);if(-1===y)return void r.store.ULS.sendTraceTag(595855178,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[ReplaceContainerContent]Positional index for content id "+p+" should not be negative");r.store.activeContainerId=r.store.activeContainerId===g?v:r.store.activeContainerId,r.store.getContainerIdToInfoMap()[v]=C,delete r.store.getContainerIdToInfoMap()[g],r.store.getContentAnchorPositions()[y].contentId=h}break;case 6:r.positionFloatingContainers()}},this.getAreContainersEnabled=function(){return!r.store.isCommentPaneOpen&&r.store.areCommentExtensionProvidersDefinedOnce},this.getContentAnchorPosition=function(e){if(!e)return null;var t=$({contentId:e,contentType:m.b.CommentThread,renderMode:m.d.Integrated}),n=r.store.getContentCardIndex(t);return-1!==n?r.store.getContentAnchorPositions()[n]:null},this.containerShouldBeCreatedEventHandler=function(e){var t=r.store.getContentCardIndex(e.containerId);r.store.initializeAndRenderFloatingContainer(r.store.getContentAnchorPositions()[t],e.containerId,r.onContainerResize)},this.updateCommentPaneState=function(){r.store.isCommentPaneOpen=!0,r.store.extensionProviderCollection&&(r.store.isCommentPaneOpen=0===r.store.extensionProviderCollection.providers.filter((function(e){return e.scope.contentType===m.b.CommentThread&&e.scope.renderMode===m.d.Integrated})).length),r.onCommentPaneStateChange()},this.onContainerResize=function(e){if(!r.store.isCommentPaneOpen&&e.stateChangeType===p.Resize&&0!==e.contentRect.height){var t=e.contentIdentifier,n=$({contentId:t.contentId,contentType:t.contentType,renderMode:m.d.Integrated}),i=r.store.getContainerIdToInfoMap()[n];if(i){var o=i.position.height!==e.contentRect.height;if(r.isInitialActiveIdSet&&r.store.activeContainerId===n&&i.floatingContainerRef&&(r.isInitialActiveIdSet=!1,i.floatingContainerRef.setFocus()),o){if(i.position.height=e.contentRect.height,i.position.width=e.contentRect.width,r.firstContainerBeingRendered){var a=window.performance&&window.performance.now?window.performance.now():Date.now();r.store.ULS.sendTraceTag(595718473,X.a.msoulscat_Wac_Telemetry,X.b.Info,a.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),r.firstContainerBeingRendered=!1}var s=void 0!==r.timeoutsToCreateContainer[n];r.featureSettings.InteractivePerfImprovementEnabled?(r.featureSettings.DeselectionEnabled?r.positionContainersOnResize(n,i,s):r.positionFloatingContainers(r.store.getContentAnchorPositions(),void 0,r.store.activeContainerId,s),i.floatingContainerRef&&i.floatingContainerRef.showFloatingContainer(s),e.contentIdentifier.contentId===r.replacementContentId&&(r.replacementContentId=void 0)):r.positionContainersOnResize(n,i,s),s&&(delete r.timeoutsToCreateContainer[n],r.stallDetectorUsed||(window.clearTimeout(r.stallDetectorTimeoutId),r.processContainerQueue()))}else if(!r.featureSettings.InteractivePerfImprovementEnabled){var c=i.position;i.floatingContainerRef&&i.floatingContainerRef.updateContainerPosition({anchorPoint:c})}}else r.store.ULS.sendTraceTag(595646153,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[ContainerResize] ContainerInfo does not exist, id: "+n+", size: "+e.contentRect.height)}},this.store=n,this.floatingContainerPositioner=e,this.floatingContainerVirtualizer=t,this.paneClosedCallback=i,this.paneOpenedCallback=o,this.featureSettings=a,a.ShouldInitialize&&this.initialize()}return e.prototype.initialize=function(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)},e.prototype.enterFixedPositionMode=function(){this.inFixedMode=!0},e.prototype.exitFixedPositionMode=function(){this.inFixedMode=!1},e.prototype.setContainerCreationPauseState=function(e){this.pauseContainerCreation=e,e&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)},e.prototype.clearSelection=function(e){if(void 0===e&&(e=!1),this.store.activeContainerId){var t=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!t)return;if(t.position.x=0,e)return;this.featureSettings.InteractivePerfImprovementEnabled?this.positionFloatingContainers():t.floatingContainerRef&&t.floatingContainerRef.updateContainerPosition({anchorPoint:{x:0,y:t.floatingContainerRef.anchorPoint().y}})}},e.prototype.setInitialActiveContainerId=function(e){this.isInitialActiveIdSet=!0,this.clearSelection(),e&&e.contentId&&(this.store.activeContainerId=$({contentId:e.contentId,contentType:f(e.containerContentType),renderMode:m.d.Integrated}))},e.prototype.insertContentAnchorPosition=function(e,t,n){var i=n&&Math.abs(e.anchorTop-t)<=4?this.store.getContentCardIndex(n)+1:-1;this.store.addContentAnchorPosition(e,0,i)},e.prototype.processContentAnchorPositionsInView=function(e){var t=this,n=!1,i=void 0,o=void 0,a=0;if(e.forEach((function(e){if(e){var r=e.contentId;if(!r)return void t.store.ULS.sendTraceTag(595903808,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[processContentAnchorPosition]ContentId is null.");var s=$({contentId:r,contentType:f(e.containerContentType),renderMode:m.d.Integrated}),c=t.store.getContainerIdToInfoMap()[s];if(!c){var d=t.store.initializeAndRenderFloatingContainer(e,s,t.onContainerResize,!t.featureSettings.InteractivePerfImprovementEnabled);return d&&t.featureSettings.InteractivePerfImprovementEnabled&&(t.containerCreationQueue.push(s),t.containerCreationEnqueueTimes[s]=Date.now()),void(d&&(t.insertContentAnchorPosition(e,a,i),i=s,a=e.anchorTop))}var u=t.store.getContentCardIndex(s,e.anchorTop);if(-1===u)return void t.store.ULS.sendTraceTag(595883392,X.a.msoulscat_Wac_Telemetry,X.b.Error,"[processContentAnchorPosition]Container was supposed to be found.");var l=t.store.getContentAnchorPositions()[u],p=void 0!==o&&c.position.y>=o.position.y&&c.position.y<=o.position.y+o.position.height,h=Math.abs(l.anchorTop-e.anchorTop)>4;if(n=n||h||p,h){var C=$({contentId:r,contentType:f(e.containerContentType),renderMode:m.d.Integrated});t.store.removeContentAnchorPosition(C),t.insertContentAnchorPosition(e,a,i)}i=s,a=e.anchorTop,c.anchorTop=e.anchorTop,o=c}})),this.isContainerQueueInProgress||this.processContainerQueue(),n||this.inFixedMode){var r=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),r,this.store.activeContainerId)}},e.prototype.processContainerQueue=function(){var e=this;if(this.featureSettings.InteractivePerfImprovementEnabled&&0!==this.containerCreationQueue.length&&!this.pauseContainerCreation){this.isContainerQueueInProgress=!0;var t=this.containerCreationQueue.shift(),n=this.store.getContentAnchorPosition(t);n&&(this.store.isContainerInViewPort(n)?this.timeoutsToCreateContainer[t]=window.setTimeout((function(){e.createContainer(n,t),e.setupStallDetector(t)}),this.containerDelayTimeMs):(this.deleteContainer(t),this.processContainerQueue()))}else this.isContainerQueueInProgress=!1},e.prototype.setupStallDetector=function(e){var t=this;this.stallDetectorUsed=!1,this.stallDetectorTimeoutId=window.setTimeout((function(){t.stallDetectorUsed=!0,t.processContainerQueue(),t.store.ULS.sendTraceTag(593281990,X.a.msoulscat_Wac_Telemetry,X.b.Warning,"[CommentCreationQueueStallDetector]: Container "+e+" creation resize call not received or took too long")}),this.queueStallDetectionTimeMs)},e.prototype.createContainer=function(e,t){if(this.store.initializeAndRenderFloatingContainer(e,t,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[t]){var n=Date.now();this.store.ULS.sendTraceTag(593891910,X.a.msoulscat_Wac_Telemetry,X.b.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:"+(n-this.containerCreationEnqueueTimes[t])),delete this.containerCreationEnqueueTimes[t]}}else this.deleteContainer(t),this.processContainerQueue()},e.prototype.onCommentPaneStateChange=function(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()},e.prototype.deleteContainer=function(e,t){void 0===t&&(t=!1);var n=this.store.removeContentAnchorPosition(e);if(-1===n)return-1;var i=this.store.getContainerIdToInfoMap()[e].floatingContainerRef;if(i){i.destroyFloatingContainer(t),clearTimeout(this.timeoutsToCreateContainer[e]),delete this.timeoutsToCreateContainer[e];var o=this.containerCreationQueue.indexOf(e);o>-1&&this.containerCreationQueue.splice(o,1)}return delete this.store.getContainerIdToInfoMap()[e],delete this.containerCreationEnqueueTimes[e],n},e.prototype.destroyAllContainers=function(){var e=this;Object.keys(this.store.getContainerIdToInfoMap()).forEach((function(t){e.deleteContainer(t)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.timeoutsToCreateContainer={},this.containerCreationQueue=[]},e.prototype.positionFloatingContainers=function(e,t,n,i,o){if(void 0===i&&(i=!1),void 0===o&&(o=!1),e&&e.length>0){var a=n?{containerId:n,containerPositionIndex:this.store.getContentCardIndex(n)}:void 0;this.floatingContainerPositioner.calculateNewPositions(e,this.store.getContainerIdToInfoMap(),{activeContainerInfo:a,disableRepositioningAnimation:i||this.inFixedMode,topOfFirstContainer:t,shouldUpdatePositions:!this.featureSettings.InteractivePerfImprovementEnabled})}this.featureSettings.InteractivePerfImprovementEnabled&&this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,i||this.inFixedMode||void 0!==this.replacementContentId,this.store.activeContainerId,o)},e.prototype.positionContainersOnResize=function(e,t,n){var i=this.store.getContentCardIndex(e),o=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==o&&o>=i?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,n):(i-=!(te(t)&&t.hasBeenRendered)&&i>0?1:0,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(i)));te(t)&&(t.hasBeenRendered=!0)},e}();!function(e){e[e.DeselectionEnabled=0]="DeselectionEnabled",e[e.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",e[e.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",e[e.InteractivePerfImprovementEnabled=3]="InteractivePerfImprovementEnabled",e[e.ShouldInitialize=4]="ShouldInitialize",e[e.ScrollingPerfImprovementEnabled=5]="ScrollingPerfImprovementEnabled",e[e.SynchronousContainerPositioningEnabled=6]="SynchronousContainerPositioningEnabled"}(ne||(ne={}));var ae=new(function(){function e(){}return e.prototype.getFCManagerInstance=function(e){if(void 0===this.floatingContainerManagerInstance){if(!e)throw new Error("Floating Container Manager creation arguments are missing!");e.ulsLogger&&X.c.setLogger(e.ulsLogger);var t=function(e){var t=!!e.scrollingPerfImprovementEnabled;return{DeselectionEnabled:!!e.deselectionEnabled,FloatingContainerVirtualizationEnabled:!!e.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!e.improveJumpingFixEnabled,InteractivePerfImprovementEnabled:!!e.interactivePerfImprovementEnabled||t,ShouldInitialize:!1!==e.shouldInitialize,ScrollingPerfImprovementEnabled:t,SynchronousContainerPositioningEnabled:!!e.synchronousContainerPositioningEnabled}}(e),n=e.isRtl?1:-1,i=e.canvasAndFcHostOffset?n*(e.canvasAndFcHostOffset-1):0,o=new h($,X.c,i),a={containerVirtualizationEnabled:t.FloatingContainerVirtualizationEnabled},r=new y(a),s=new ie(m.e,e.containerPanel,Z,X.c,e.viewportInfo,t);this.floatingContainerManagerInstance=new oe(o,r,s,e.paneClosedCallback,e.paneOpenedCallback,t)}return this.floatingContainerManagerInstance},e}());function re(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c.renderCommentPaneWithAppInfo.apply(void 0,Object(s.__spreadArrays)(e,[u.a]))}function se(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c.instantiateSharedComments.apply(void 0,Object(s.__spreadArrays)(e,[u.a]))}n.d(t,"renderCommentPane",(function(){return re})),n.d(t,"instantiate",(function(){return se})),n.d(t,"initializeRuntime",(function(){return c.initializeRuntime})),n.d(t,"setWebpackPublicPath",(function(){return d.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return l.a})),n.d(t,"FactoryGlobal",(function(){return ae}))}],[[1208,2,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map