var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Word=function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(i){return t[i]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=20)}({20:function(t,i,e){"use strict";e.r(i);var n,o,r,s=function(){function t(){}return t.prototype.h=function(){},t.prototype.shipAssertTag=function(){},t.prototype.debugAssertTag=function(){},t}();(o=n||(n={}))[o.Error=10]="Error",o[o.Warning=15]="Warning",o[o.Info=50]="Info",o[o.Verbose=100]="Verbose",o[o.Spam=200]="Spam",function(t){t[t.u=0]="msoulscat_ES_EWAJS",t[t.v=1]="msoulscat_ES_EWAJSGrid",t[t.g=6]="msoulscat_ES_EWAJSChart",t[t._=202]="msoulscat_MSOSP_FileMenuCommands",t[t.O=301]="msoulscat_Wac_WordViewer",t[t.P=306]="msoulscat_Wac_BrowserGeneral",t[t.U=320]="msoulscat_Wac_TaskPane",t[t.F=339]="msoulscat_Wac_OneNoteGeneral",t[t.A=340]="msoulscat_Wac_Ribbon",t[t.W=379]="msoulscat_Wac_WopiPendingApplication",t[t.R=383]="msoulscat_Wac_Telemetry",t[t.N=391]="msoulscat_Wac_WacCatchUpActivities",t[t.k=394]="msoulscat_Wac_Dictation",t[t.B=395]="msoulscat_Wac_OneNoteSync",t[t.H=700]="msoulscat_Wac_VisioApp",t[t.j=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.J=800]="msoulscat_Wac_PptAnimation",t[t.q=833]="msoulscat_Wac_PptLive",t[t.Z=834]="msoulscat_Wac_PptMWeb",t[t.$=815]="msoulscat_Wac_PptShape",t[t.X=817]="msoulscat_Wac_PptSession",t[t.K=830]="msoulscat_Wac_PptSlideshow",t[t.Y=2300]="msoulscat_Wac_VersionHistory",t[t.tt=302]="msoulscat_Wac_WordPresence",t[t.it=3005]="msoulscat_Wac_WordVersionHistory",t[t.et=3006]="msoulscat_Wac_LivePersonaCard",t[t.nt=3012]="msoulscat_Wac_CatchUpFlyout"}(r||(r={}));var a;(function(){function t(){}t.tagIntToString=function(i){return i<=t.maxNumericTag?i.toString():i>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i):t.map.charAt(i>>24&63)+t.map.charAt(i>>18&63)+t.map.charAt(i>>12&63)+t.map.charAt(i>>6&63)+t.map.charAt(63&i)},t.getLogMessage=function(i,e,n){return"tag_"+t.tagIntToString(i)+" ["+r[e]+"] "+n},t.prototype.h=function(i,e,o,r){var s=console.log;switch(o){case n.Error:s=console.error;break;case n.Warning:s=console.warn;break;case n.Info:s=console.info;break;case n.Verbose:s=console.debug;break;case n.Spam:default:s=console.log}try{s(t.getLogMessage(i,e,r))}catch(t){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw t}},t.prototype.shipAssertTag=function(i,e,n,o){console.assert(n,t.getLogMessage(i,e,o))},t.prototype.debugAssertTag=function(t,i,e,n){this.shipAssertTag(t,i,e,n)},t.maxNumericTag=65535,t.minOldSchemeHighByteValue=36,t.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function t(){this.externalLogger=new s}return t.prototype.setLogger=function(t){this.externalLogger=t},t.prototype.h=function(t,i,e,n){this.externalLogger.h(t,i,e,n)},t.prototype.debugAssertTag=function(t,i,e,n){this.externalLogger.debugAssertTag(t,i,e,n)},t.prototype.shipAssertTag=function(t,i,e,n){this.externalLogger.shipAssertTag(t,i,e,n)},t}());function c(t,i,e){if(""!==i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",i,e),n.send(t))}}function h(t,i,e,n){var o=t.map((function(t){return function(t,i){var e={};e.G=t.tag,e.T=t.timestamp-i,e.M=t.message,e.C=t.category;var n=1e3*t.type+t.level;return e.D=n,e}(t,n)})),r=function(t,i,e,n){var o={};return o.T=t,o.L=i,o.S=e,o.I=n,o.V=1,o}(n,o,i,e);return JSON.stringify(r)}!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(a||(a={}));!function(){function t(i,e){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(i,e){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,c(h(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,e),n.logCache=[],n.timestampBase=Date.now());i&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,t.uploadCadenceInMsSec))},this.userSessionId=i,this.remoteUrlEndpoint=e+"?usid="+i,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}t.prototype.handleTrace=function(i){i.message.length>t.messageMaxChars&&(i.message=i.message.substr(0,t.messageMaxChars-t.trimmedMessage.length)+t.trimmedMessage),this.logCache.push(i),(this.logCache.length>t.uploadTriggerSize||i.level===n.Error)&&this.triggerUploadAsync()},t.messageMaxChars=3072,t.uploadCadenceInMsSec=3e4,t.uploadTriggerSize=30,t.trimmedMessage="... [Trimmed]"}();n.Info;var u=function(t,i){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};function f(t,i){function e(){this.constructor=t}u(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}var d=function(){return(d=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};var l;!function(t){function i(){return null!==t&&t.apply(this,arguments)||this}f(i,t)}(s);function p(){if(null!=navigator&&null!=navigator.userAgent){var t=navigator.userAgent;if(t.indexOf("Firefox")>-1)return l.Firefox;if(t.indexOf("Opera")>-1)return l.Opera;if(t.indexOf("Trident")>-1)return l.IE;if(t.indexOf("Edge")>-1)return l.Edge;if(t.indexOf("Chrome")>-1)return l.Chrome;if(t.indexOf("Safari")>-1)return l.Safari}return l.Unknown}!function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.Unknown=6]="Unknown"}(l||(l={}));var v=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function w(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function m(){try{return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&b()&&!(navigator.userAgent.indexOf("iPhone")>=0)||navigator.userAgent.indexOf("Android")>=0||b()}catch(t){return!1}}function g(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}function I(){return p()===l.IE&&!function(){if(p()!==l.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function S(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}function b(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function y(t){return 8===t.toLowerCase().indexOf("ffc")}function _(t){return 8===t.toLowerCase().indexOf("ppc")}function C(t){var i=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function T(t,i){var e=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!e)throw new Error("Invalid URL");var n=e[2];if(void 0===i)return n;if(i<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(i+1)).join(".")}function E(t,i){var e=t.indexOf("&"+i+"=");if(-1===e&&(e=t.indexOf("?"+i+"=")),-1===e)return"";var n=e+(i.length+2),o=t.indexOf("&",n);return t.substring(n,-1===o?void 0:o)}function O(t,i,e,n){if(void 0===n&&(n=!1),!e)return t;var o=t,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=i.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,r);if("?"!==s&&c>=0){if(n){var h=o.indexOf("&",c);o=o.substring(0,c)+a+e+(-1===h?"":o.substring(h))}return o}return o.concat(s,a,e)}function P(t){var i={},e=t.indexOf("?");return-1===e||e===t.length-1||t.substring(e+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var e=t.indexOf("=");-1!==e&&e!==t.length-1&&(i[t.substring(0,e).toLowerCase()]=t.substring(e+1))}})),i}function U(t){if(!t)return"";var i=-1===t.indexOf("#")?t.length:t.indexOf("#"),e=t.lastIndexOf("/",i);if(-1!==e&&e+1===t.indexOf("://")+"://".length)return"";e+=1;var n=t.indexOf("?");if(-1!==(n=n>=i?-1:n)&&e>n)return"";var o=-1===n?i:n;return e>=o?"":t.substring(e,o)}function F(t,i){return{shouldPreload:function(i){return t(i)},preload:function(t,e,o,s){i(t,e,s).forEach((function(t){!function(t,i,e){var o=document.createElement("link");if(o.setAttribute("crossorigin","anonymous"),o.rel=W,o.href=t,i){var s=e||U(t);i.ULS.h(592315601,r.W,n.Info,"Preloading resource: "+s);o.addEventListener("error",(function(){i.ULS.h(592479445,r.W,n.Error,"Resource failed to load: "+s)}))}o.setAttribute("as","script"),document.head.appendChild(o)}(t,o)}))}}}var A,W=(A=p())===l.Firefox||A===l.IE?"prefetch":"preload";var R,x,D,N,M,k;function B(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}function H(t,i){try{if(void 0===window.performance)return void i.ULS.h(595948609,r.W,n.Info,"Performance not supported");var e=window.performance.getEntriesByType("resource");if(void 0===e||e.length<=0)return void i.ULS.h(595948610,r.W,n.Info,"No resources under performance");for(var o=new RegExp(t+"[-.]boot(.min)?.js","i"),s=e.length-1;s>=0;s-=1){var a=e[s],c=a.name.match(o);if(c){var h=JSON.stringify(a);return h=h.replace(new RegExp(a.name,"g"),c[0]),void i.ULS.h(595948616,r.W,n.Info,h)}}i.ULS.h(595948484,r.W,n.Info,"Could not find JSAPI resource timing entry")}catch(t){i.ULS.h(595948617,r.W,n.Info,"Could not trace the resource timing: "+B(t))}}function j(){var t={perfNowSupported:v};try{var i=window.navigator,e=i.connection||i.mozConnection||i.webkitConnection;e&&(t.netDownlink=e.downlink,t.netDownlinkMax=e.downlinkMax,t.netEffectiveType=e.effectiveType,t.netRtt=e.rtt,t.netSaveData=e.saveData,t.netType=e.type),t.deviceMemory=i.deviceMemory,t.logicalProcessors=i.hardwareConcurrency}catch(t){}return t.browser=l[p()],t.touchMode=m(),t.highContrast=g(),t.windows10x=S(),t}function L(t,i,e){t.ULS.h(595957843,r.W,n.Info,"Page lifecycle: "+i+" fired"+(e?", flushing logger":"")),e&&t.ULS.flush()}function J(){return v?window.performance.now():Date.now()}!function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.BootCompleted="BootCompleted",t.BrowserEvent="BrowserEvent",t.Close="Close",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.Disposed="Disposed",t.Download="Download",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileRenameFailed="FileRenameFailed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.ModeSwitched="ModeSwitched",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SaveStatus="SaveStatus",t.SessionCreated="SessionCreated",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged"}(R||(R={})),function(t){t.Unknown="UNKNOWN",t.Initialized="INITIALIZED",t.Prebooted="PREBOOTED",t.Booting="BOOTING",t.Booted="BOOTED",t.Failed="FAILED",t.Disposing="DISPOSING",t.Disposed="DISPOSED"}(x||(x={})),function(t){t.ot="ExcelInstantShellEnabled",t.rt="BootstrapperMaxUlsHeartbeatTime",t.st="BootstrapperNoCompleteWarning1Time",t.at="BootstrapperNoCompleteWarning2Time",t.ct="RemoteUlsETag",t.ht="RemoteUlsSuppressions",t.ut="SandboxWacFrameDisabled",t.ft="BootstrapperSettingsFetchPeriod",t.dt="timestamp",t.lt="BootstrapperUlsHeartbeatIntervalMs",t.pt="BootstrapperUlsHeartBeatIsEnabled",t.vt="BootstrapperUlsUploadCadenceMs"}(D||(D={}));var z,V;function q(){V&&(window.clearInterval(V),V=void 0)}var G,Z=function(){function t(t){var i=this;this.wt=3e4,this.gt=30,this.It=0,this.St=[],this.bt=Date.now(),this.yt="",this._t=0,this.flushOnClose=function(){i.Ct(!1,!1)},this.flush=function(){i.Tt()},this.Tt=function(){window.setTimeout((function(){return i.Ct(!0,!0)}),0)},this.Ct=function(t,e){var n=J();if(window.clearTimeout(i.Et),i.Ot){if(i.St.length>0)i.It+=1,c(h(i.St.splice(0,t?i.gt:i.St.length),i.yt,i.It,i.bt),i.Ot,e),i.bt=Date.now();t&&(i.Et=window.setTimeout(i.Tt,i.St.length>i.gt?1e3:i.wt)),i._t+=J()-n}},t&&this.configure(t)}return t.prototype.getTimeSpentLogging=function(){return this._t},t.prototype.addLoggingTime=function(t){this._t+=t},t.prototype.configure=function(t){var i=this,e=J();if(t.uploadCadenceInMs&&(this.wt=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.gt=t.uploadTriggerSize),t.sessionId&&(this.yt=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Ot)throw new Error("Remote ULS endpoint is already set");this.Ot=t.remoteUlsEndpoint+"?usid="+this.yt,this.bt=Date.now(),window.setTimeout((function(){return i.Ct(!0,!0)}),0)}this._t+=J()-e},t.prototype.handleTrace=function(t){var i=J();t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.St.push(t),(this.St.length>this.gt||t.level===n.Error)&&this.Tt(),this._t+=J()-i},t}(),$=[];function X(t){var i=new Z(t);function e(t,e,n,o){var r=J();if(!function(t){return 1===$[t]}(t)){var s={timestamp:Date.now(),category:e,tag:t,level:n,type:a.Trace,message:o};i.addLoggingTime(J()-r),i.handleTrace(s)}}return{ULS:{h:function(t,i,n,o){e(t,i,n,o)},shipAssertTag:function(t,i,o,r){o&&e(t,i,n.Error,r)},debugAssertTag:function(t,i,e,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:i.flush,flushOnClose:i.flushOnClose},configure:function(t){i.configure(t)},settingsChangeHandler:function(t){var e,n;e=t.settingsManager.getValue(D.ht,""),n=t.settingsManager.getValue(D.ct,""),G&&n===G||($=[],G=n,e&&e.split(",").forEach((function(t){var i=parseInt(t,10);i&&($[i]=1)}))),i.configure({uploadCadenceInMs:t.settingsManager.getValue(D.vt,6e4)})},getTimeSpentLogging:function(){return i.getTimeSpentLogging()}}}function K(t,i){return{isFeatureEnabled:function(e){return function(t,i,e){if(!i)return;try{return i(t)}catch(t){e&&e.ULS.h(594883024,r.W,n.Error,"IsFeatureEnabled callback error: "+B(t))}return}(e,t,i)}}}var Q= "16.0.13117.41003";function Y(){return Q}var tt,it,et,nt,ot,rt=function(){function t(){this.Pt=[]}return t.prototype.add=function(t){t&&this.Pt.push(t)},t.prototype.remove=function(t){if(t){var i=this.Pt.indexOf(t);i>-1&&this.Pt.splice(i,1)}},t.prototype.removeAll=function(){this.Pt=[]},t.prototype.dispatch=function(t,i){this.Pt.forEach((function(e){try{e(t)}catch(t){i&&i(t)}}))},t}(),st=function(){function t(t,i){var e=this;this.Ut=0,this.Ft=function(){if(e.At){var t=new XMLHttpRequest;t.open("GET",e.At),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(e.setSettingsOnIdle(t.response),e.Ut=0):(e.Wt.ULS.h(592836771,r.W,n.Error,"Fetch settings error. Status: "+t.status+", curErrors: "+e.Ut),e.Ut+=1),!(e.Ut>7)){var i=e.getValue(D.ft,3e5);e.Ut>3&&(i+=(e.Ut-3+1)*(i/2)),e.Rt=window.setTimeout(e.Ft,i)}}}},this.xt=t,this.Dt="Prod"+t+"Settings",this.Wt=i,this.Nt=new rt,this.getCurrentSettings()}return t.prototype.initializePeriodicFetch=function(t,i){y(t)&&(this.Dt="FF"+this.xt+"Settings",this.getCurrentSettings()),this.At=t+"AppSettingsHandler.ashx?app="+this.xt+"&usid="+i+"&build="+Y(),this.Rt||(this.Rt=window.setTimeout(this.Ft,3e4))},t.prototype.getValue=function(t,i){if(this.Mt||this.getCurrentSettings(),!this.Mt||!this.Mt.hasOwnProperty(t))return i;var e=this.Mt[t],n=typeof i;if(typeof e===n)return e;if("string"==typeof e){if("number"===n)return parseInt(e,10);if("boolean"===n)return"true"===e}return i},t.prototype.addSettingsChangeListener=function(t){this.Nt.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.Nt.remove(t)},t.prototype.dispose=function(){this.Rt&&window.clearTimeout(this.Rt),this.kt&&self.cancelIdleCallback(this.kt),this.Rt=void 0,this.kt=void 0,this.Mt=void 0,this.Nt.removeAll()},t.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(this.Dt);if(!t)return;var i=JSON.parse(t);this.updateCurrentSettings(i)}catch(t){this.Wt.ULS.h(592836768,r.W,n.Warning,"Failed to get settings from localStorage: "+B(t))}},t.prototype.updateCurrentSettings=function(t){var i=this;return!!this.isValidSettings(t)&&(this.Mt=t,this.Nt.dispatch({settingsManager:this},(function(t){i.Wt.ULS.h(592836769,r.W,n.Error,"Settings listener error: "+B(t))})),!0)},t.prototype.isValidSettings=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(D.dt)&&!isNaN(t.timestamp))return!0;this.Wt.ULS.h(592836770,r.W,n.Error,"Received invalid settings")}return!1},t.prototype.setSettingsOnIdle=function(t){var i=this;"requestIdleCallback"in window?(this.kt&&self.cancelIdleCallback(this.kt),this.kt=window.requestIdleCallback((function(){return i.setSettings(t)}),{timeout:1e4})):window.setTimeout((function(){return i.setSettings(t)}),0)},t.prototype.setSettings=function(t){if(this.updateCurrentSettings(t)&&window&&window.localStorage){var i=JSON.stringify(t);try{window.localStorage.setItem(this.Dt,i)}catch(t){this.Wt.ULS.h(592836800,r.W,n.Warning,"Failed to set localStorage: "+B(t))}}},t}();!function(t){t.appReboot="appReboot",t.boot="boot",t.dispose="dispose",t.frameTrust="frameTrust",t.handleBootState="handleBootState",t.postMessage="postMessage",t.rename="rename",t.switchMode="switchMode",t.wopiInfoFromUrl="wopiInfoFromUrl"}(tt||(tt={})),function(t){t.blurFocus="blurFocus",t.boot="boot",t.continueAccessibilityLoop="continueAccessibilityLoop",t.dispose="dispose",t.grabFocus="grabFocus",t.rename="rename",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.switchMode="switchMode"}(it||(it={})),function(t){t.Bt="App_AccessibilityLoopComplete",t.Ht="Wac_AppFailed",t.jt="Wac_AppBootState",t.Lt="Wac_AppCompleted",t.Jt="BrowserEvent",t.zt="UI_Close",t.Vt="UI_Conversation",t.qt="UI_CopyAndEdit",t.Gt="UI_Download",t.Zt="Error",t.$t="UI_FileEmbed",t.Xt="UI_FileProperties",t.Kt="File_Rename",t.Qt="File_RenameFailed",t.Yt="UI_FileVersions",t.ti="StateChanged",t.ii="App_WopiInfoFromUrl",t.ei="WacInitialize_FrameLoaded",t.ni="WacInitialize_Ready",t.oi="App_LoadingStatus",t.ri="App_SwitchMode",t.si="UI_OpenInBrowser",t.ai="UI_OpenInClient",t.ci="PageChanged",t.hi="App_PushState",t.fi="App_DocReboot",t.di="UI_RedeemForCommenting",t.li="App_RefreshSessionInfo",t.pi="UI_ReplyWithChanges",t.vi="UI_ReportAbuse",t.wi="UI_SaveStatus",t.mi="WopiSession_Complete_Ack",t.gi="UI_Sharing",t.Ii="UI_ShareForm",t.Si="UI_SignIn",t.bi="App_IsFrameTrusted",t.yi="App_Unloaded",t._i="PageCount",t.Ci="UI_CheckUserAccessAndGrantPermissions",t.Ti="User_Activity",t.Ei="Edit_Notification",t.Oi="UI_Workflow",t.Pi="ZoomChanged"}(et||(et={})),function(t){t.Ui="Ack",t.Fi="Blur_Focus",t.Ai="Wac_AppFailed_Ack",t.Wi="Wac_AppCompleted_Ack",t.Ri="Host_AccessibilityLoopComplete",t.xi="WopiPendingSession_Fail",t.Di="Grab_Focus",t.Ni="HostCacheDiagnostic",t.Mi="WacInitialize_Ready_Ack",t.ki="JsApiDiagnostics",t.Bi="PageChanged_Ack",t.Hi="WopiPendingApplicationComplete_Received",t.ji="WopiPendingSession_Complete",t.Li="App_PopState",t.Ji="Host_PostmessageReady",t.zi="File_Rename",t.Vi="CanEmbed",t.qi="Host_RefreshSessionInfo",t.Gi="CheckUserAccessAndGrantPermissions_Result",t.Zi="Host_WopiInfoFromUrl",t.$i="SetCurrentPage",t.Xi="SetZoomLevel",t.Ki="WopiStartSession_Complete",t.Qi="Host_SwitchMode",t.bi="Host_IsFrameTrusted",t.Yi="Host_Unload",t.te="PageCount_Ack",t.ie="ZoomChanged_Ack"}(nt||(nt={}));var at=((ot={})[it.boot]={ee:tt.boot},ot[it.dispose]={ee:tt.dispose},ot[it.rename]={ee:tt.rename},ot[it.switchMode]={ee:tt.switchMode},ot[et.jt]={ee:tt.handleBootState},ot[et.bi]={ee:tt.frameTrust},ot[et.$t]={ne:R.FileEmbed},ot[et.ii]={ee:tt.wopiInfoFromUrl},ot[et.fi]={ee:tt.appReboot},ot[et.li]={ne:R.RefreshSessionInfo},ot[et.Ci]={ne:R.UserAccessAndPermissions},ot[it.blurFocus]={oe:nt.Fi},ot[it.continueAccessibilityLoop]={oe:nt.Ri},ot[it.grabFocus]={oe:nt.Di},ot[it.sendEmbeddedViewUrl]={oe:nt.Vi},ot[it.sendSessionInfo]={oe:nt.qi},ot[it.sendUserAccessAndPermissions]={oe:nt.Gi},ot[it.sendWopiInfo]={oe:nt.Zi},ot[et.Bt]={ne:R.AccessibilityLoopCompleted},ot[et.Jt]={ne:R.BrowserEvent},ot[et.zt]={ne:R.Close},ot[et.Vt]={ne:R.Conversation},ot[et.qt]={ne:R.CopyAndEdit},ot[et.Gt]={ne:R.Download},ot[et.Zt]={ne:R.Error},ot[et.Xt]={ne:R.FileProperties},ot[et.Kt]={ne:R.FileRenamed},ot[et.Qt]={ne:R.FileRenameFailed},ot[et.Yt]={ne:R.FileVersions},ot[et.ti]={ne:R.FrameStateChanged},ot[et.ri]={ne:R.ModeSwitched},ot[et.si]={ne:R.OpenInBrowser},ot[et.ai]={ne:R.OpenInClient},ot[et.ci]={ne:R.PageChanged},ot[et.di]={ne:R.RedeemForCommenting},ot[et.pi]={ne:R.ReplyWithChanges},ot[et.vi]={ne:R.ReportAbuse},ot[et.wi]={ne:R.SaveStatus},ot[et.gi]={ne:R.Share},ot[et.Ii]={ne:R.ShareForm},ot[et.Si]={ne:R.SignIn},ot[et.Ti]={ne:R.UserActivity},ot[et.Ei]={ne:R.UserEditActivity},ot[et.Oi]={ne:R.Workflow},ot[et.Pi]={ne:R.ZoomChanged},ot);function ct(){var t=new Uint8Array(31),i=function(t){var i={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){i.crypto=!0;try{return e.getRandomValues(t),i}catch(t){i.exceptions.push("crypto: "+B(t))}}i.perfNow=v;for(var n=0;n<t.length;n+=1){try{if(v){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(t){i.exceptions.push("Math.random: "+B(t))}t[n]=Math.floor(16*Math.random())}return i}(t),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var n=15&t[e];return e+=1,("x"===i?n:3&n|8).toString(16)})),i]}var ht=function(){function t(t,i,e,o,s,a){var c,h=this;this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.re={},this.onMessage=function(t){var i=t.MessageId,e=t.Values||{},o=h.re[i];if(o&&o.length>0)h.dispatchAction(i,e);else{var s=at[i];if(s){var a=s.ee,c=s.ne;a?h.se[a](i,e,h,h.ae[a]).catch((function(t){h.logger.ULS.h(593364502,r.W,n.Error,a+" flow error: "+B(t))})):c&&h.raiseEvent(c,e)}}},this.state=x.Unknown;var u=ct(),f=u[0],d=u[1];this.logger=X(),this.logger.ULS.h(593506837,r.W,n.Info,JSON.stringify(d)),this.sessionId=f,this.hostSessionId=e.hostSessionId,this.host=t.host,this.user=t.user,this.bootstrapperUrl=t.bootstrapperUrl,this.ui=t.ui,this.viewMode=t.viewMode,this.application=o,this.appInfo=i,this.featureManager=K(t.host.capabilities&&t.host.capabilities.isFeatureEnabledCallback,this.logger),this.settingsManager=new st(i.name,this.logger),this.preloader=i.preloader,c=s(),this.se=c[0],this.ae=c[1],this.ce=a,this.settingsManager.addSettingsChangeListener(this.logger.settingsChangeHandler)}return Object.defineProperty(t.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!0,configurable:!0}),t.prototype.raiseEvent=function(t,i){try{this.ce(t,i)}catch(t){this.logger.ULS.h(593506838,r.W,n.Error,"Event handler error: "+B(t))}},t.prototype.addActionHandler=function(t,i){this.re[t]||(this.re[t]=[]),this.re[t].push(i)},t.prototype.removeActionHandler=function(t,i){var e=this.re[t];if(e&&e.length>0){var n=e.indexOf(i);n>-1&&e.splice(n,1)}},t.prototype.run=function(t,i,e){var o=this,s=[],a=this.re[t];if(a&&a.length>0)s.push(this.dispatchAction(t,i));else{var c=at[t];if(c){var h=c.ee,u=c.oe;if(h){var f=(0,this.se[h])(t,i,this,this.ae[h],e).catch((function(t){return o.logger.ULS.h(593364501,r.W,n.Error,h+" flow error: "+B(t)),{completion:"failure",error:t}}));s.push(f)}else u&&(this.se[tt.postMessage](t,i,this,void 0),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.h(593500189,r.W,n.Warning,"Unhandled command: "+t)}return Promise.race(s)},t.prototype.dispatchAction=function(t,i){var e=this;return this.re[t].map((function(o){try{o(t,i)}catch(i){e.logger.ULS.h(593773709,r.W,n.Error,t+" action handler error: "+B(i))}})),Promise.resolve({completion:"success"})},t}();var ut,ft=function(){function t(t,i,e,n,o,r){var s=this;!function(t){if(void 0===t)throw new TypeError("SessionInitParams");if(void 0===t.hostSessionId)throw new TypeError("HostSessionId")}(e);this.he=new ht(t,i,e,n,r,(function(t,i){return o({type:t,data:i,session:s})})),this.he.raiseEvent(R.SessionCreated,void 0),this.he.state=x.Initialized}return Object.defineProperty(t.prototype,"sessionId",{get:function(){return this.he.sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diagnostics",{get:function(){return this.he.diagnostics},enumerable:!0,configurable:!0}),t.prototype.run=function(t,i,e){return this.he.run(t,i,e)},t.prototype.boot=function(t,i){return this.he.run(it.boot,t,i)},t.prototype.dispose=function(t){return this.he.run(it.dispose,void 0,t)},t}(),dt=function(){function t(t,i,e){var o=this;this.ue="",this.fe="",this.de=!1,this.le=!1,this.pe=!1,this.ve=function(t){var i=!1,e=!0,s="",a=!1;if(o.we&&(i=!0,e=t.source===o.we),t.origin&&(a=(s=T(t.origin,2).toLowerCase())===o.fe),!o.de&&(!o.le||a&&e)||o.Wt.ULS.h(593232850,r.W,n.Info,"Window: available["+i+"] valid["+e+"]; Origin: valid["+a+"] expected["+o.fe+"] actual["+s+"]"),a&&(!o.pe||e)){var c;try{c=JSON.parse(t.data)}catch(t){return void o.Wt.ULS.h(593232851,r.W,n.Info,"Failed to parse event data: "+B(t))}var h=c.MessageId;if(h)if(o.Wt.ULS.h(593232854,r.W,n.Info,"Received message: "+h+", correlation: "+c.CorrelationId),h!==et.Lt&&h!==et.oi||o.setTargetOrigin(t.origin),c.Values&&c.Values.ackExpected&&(o.Wt.ULS.h(593232855,r.W,n.Info,"Sending Ack back"),o.postMessage(nt.Ui,void 0,c.CorrelationId)),o.me){o.Wt.ULS.h(593232856,r.W,n.Info,"Processing message: "+h);try{o.me(c)}catch(t){o.Wt.ULS.h(594556386,r.W,n.Error,"Message handler error: "+B(t))}}else o.Wt.ULS.h(591933923,r.W,n.Error,"No message handler");else(o.de||o.le)&&o.Wt.ULS.h(593232853,r.W,n.Info,"Missing message id")}},this.Wt=i,this.setTargetOrigin(t),e&&this.setMessageHandler(e),window.addEventListener("message",this.ve,!1)}return t.prototype.setTargetOrigin=function(t){var i=C(t).toLowerCase();this.ue&&this.ue!==i&&this.Wt.ULS.h(593232847,r.W,n.Warning,"Updating origin: ["+this.ue+"]->["+i+"]"),this.ue=i,this.fe=T(i,2),this.de=y(i),this.le=_(i)},t.prototype.setTargetWindow=function(t,i){void 0===i&&(i=!1),this.we=t,this.pe=i},t.prototype.setMessageHandler=function(t){this.me=t},t.prototype.removeMessageHandler=function(){this.me=void 0},t.prototype.postMessage=function(t,i,e){if(this.we){this.Wt.ULS.h(593232849,r.W,n.Info,"Sending message: "+t);var o={MessageId:t,SendTime:Date.now(),CorrelationId:e,Values:i};this.we.postMessage(JSON.stringify(o),this.ue)}else this.Wt.ULS.h(593232848,r.W,n.Info,"Missing target to send message")},t.prototype.dispose=function(){window.removeEventListener("message",this.ve,!1),this.me=void 0},t}();!function(t){t.ge="access_token",t.Ie="access_token_ttl",t.Se="bundleSrc",t.be="bundleStaleness",t.ye="DocID",t._e="ETag",t.Ce="feature_status",t.Te="fileExtension",t.Ee="fileGetUrl",t.Oe="fileName",t.Pe="fileSize",t.Ue="forceSLR",t.Fe="frameHeightPx",t.Ae="frameWidthtPx",t.We="highContrast",t.Re="highDpi",t.xe="host_diagnostics",t.De="hostName",t.Ne="huictrls",t.Me="owner_id",t.ke="sc",t.Be="softBlockedBrowser",t.He="templateUrl",t.je="touchMode",t.Le="user_id"}(ut||(ut={}));function lt(t,i){i[ut.Fe]=String(t.offsetHeight),i[ut.Ae]=String(t.offsetWidth),i[ut.je]=String(m()),i[ut.We]=String(g()),i[ut.Ue]=String(S())}function pt(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(i){return t&&t.ULS.h(591525084,r.W,n.Info,"Trust check error: "+B(i)),!1}}var vt,wt,mt=function(){function t(t,i){var e=this;this.Je=function(t){var i=t.target.contentWindow;i?e.ze.setTargetWindow(i):e.Wt.ULS.h(592524689,r.W,n.Error,"content window not available")},function(t){if(void 0===t||void 0===t.appendChild)throw TypeError("Container")}(t),this.Ve=t,this.qe=i,this.Ge=i+"_Form",this.Ze=pt()}return Object.defineProperty(t.prototype,"frameId",{get:function(){return this.qe},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formId",{get:function(){return this.Ge},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTopFrameTrusted",{get:function(){return this.Ze},enumerable:!0,configurable:!0}),t.prototype.boot=function(t,i,e){var n,o,r,s,a,c;this.Wt=e,this.ze=new dt(t,e,this.$e),this.Xe=(n=this.Ve,o=this.qe,r=t,s=!1,a=this.Je,(c=n.ownerDocument.createElement("iframe")).id=o,c.name=o,c.src="",c.title="Office on the web Frame",c.width="100%",c.height="100%",c.marginWidth="0",c.marginHeight="0",c.style.left="0",c.style.top="0",c.style.right="0",c.style.bottom="0",c.style.display="block",c.style.position="absolute",c.style.backgroundColor="transparent",c.style.border="none",c.frameBorder="0",c.setAttribute("allowfullscreen","true"),c.setAttribute("allowTransparency","true"),s&&c.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox"),c.setAttribute("allow","microphone "+r+"; camera "+r+";"),a&&c.addEventListener("load",a,{once:!0}),n.appendChild(c),c),lt(this.Xe,i),this.Ke=function(t,i,e,n,o){var r=t.ownerDocument,s=r.createElement("form");for(var a in s.id=e,s.name=e,s.action=n,s.target=i,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return t.appendChild(s),s}(this.Ve,this.qe,this.Ge,t,i),this.Ke.submit()},t.prototype.setMessageHandler=function(t){this.$e=t,this.ze&&this.ze.setMessageHandler(t)},t.prototype.removeMessageHandler=function(){this.$e=void 0,this.ze&&this.ze.removeMessageHandler()},t.prototype.postMessage=function(t,i){this.ze&&this.ze.postMessage(t,i)},t.prototype.dispose=function(){var t=this;this.Xe&&(this.Xe.src="about:blank",window.setTimeout((function(){t.Ve.removeChild(t.Xe),t.Xe=void 0,t.Ke&&(t.Ve.removeChild(t.Ke),t.Ke=void 0)}),0)),this.ze&&(this.ze.dispose(),this.ze=void 0),this.Wt=void 0},t}(),gt=function(){function t(t,i,e){var n=this;this.sessions=[],this.containers=[],this.Qe=function(t){if(t.type===R.Disposed){var i=n.sessions.indexOf(t.session);i>-1&&n.sessions.splice(i,1)}},this.Ye=function(t){n.tn.dispatch(t)},function(t){if(void 0===t)throw new TypeError("ApplicationInitParams");var i=t.host;if(void 0===i||void 0===i.storageHostName)throw new TypeError("HostInfo");var e=t.user;if(void 0===e||void 0===e.id)throw new TypeError("UserInfo")}(t),this.in=t,this.en=i,this.nn=e,this.tn=new rt,this.tn.add(this.Qe),w()}return t.prototype.getApplicationName=function(){return this.en.name},t.prototype.getVersion=function(){return Y()},t.prototype.prefetch=function(){throw new Error("Not implemented")},t.prototype.addEventListener=function(t){this.tn.add(t)},t.prototype.removeEventListener=function(t){this.tn.remove(t)},t.prototype.addEventHandler=function(t){this.addEventListener(t)},t.prototype.removeEventHandler=function(t){this.addEventListener(t)},t.prototype.createContainer=function(t){var i="WacFrame_"+this.en.name+"_"+this.containers.length,e=new mt(t,i);return this.containers.push(e),e},t.prototype.createSession=function(t){var i=new ft(this.in,this.en,t,this,this.Ye,this.nn);return this.sessions.push(i),i},t.prototype.dispose=function(t){var i=this,e=this.sessions.map((function(i){return i.dispose(t).catch((function(t){}))}));return Promise.all(e).then((function(t){return i.tn.removeAll(),i.sessions=[],i.containers=[],{completion:"success"}}))},t}();function It(t){return t.toLowerCase().indexOf("uiembed=1")>=0}function St(t){var i=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function bt(t,i){i&&i.Diagnostics&&Object.keys(i.Diagnostics).forEach((function(e){return t[e]=i.Diagnostics[e]}))}function yt(t,i,e){i.ULS.h(596459999,r.W,e,"SessionTraces: "+JSON.stringify(t))}function _t(t,i){i.Stop();var e=i.GetVisibilityChangeEvents();null!=e&&e.length>0&&(t.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,t.SessionTraces.tabSwitchDiagnostics=JSON.stringify(e)),i.Dispose()}function Ct(t,i,e){try{var o=function(t,i){var e=d({},i);delete e.UserId,delete e.OwnerId,delete e.WdParams;var n=e,o=i.WdParams?JSON.parse(JSON.stringify(i.WdParams).toLowerCase()):{};return n.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf","wdsandboxwacframe"].forEach((function(t){o[t]&&(n.WdParams[t]=o[t])})),n.UiEmbedMode=It(t),n.UiHostName=E(t,"uih")||"N/A",n.HostDomain=location?location.hostname:"",n}(i.applicationUrl,i.sessionInformation);o.Build=Y(),o.Region=(c=i.applicationUrl,(h=c.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i))&&h[1]?h[1]:"public"),o.RebootOverrideData=i.rebootOverrideData,i.diagnostics.HostInitDiagnostics&&(t.ULS.h(596444238,r.W,n.Info,"HostInitDiagnostics: "+JSON.stringify(i.diagnostics.HostInitDiagnostics)),o.SessionOrigin=i.diagnostics.HostInitDiagnostics.entryPoint),e&&t.ULS.h(595937313,r.W,n.Info,JSON.stringify(e));var s=i.wopiInfo;s&&s.AccessToken&&s.AccessTokenExpiry||t.ULS.h(595894553,r.W,n.Warning,"There are some missing parameters"),s&&(s.AccessToken&&(o.AccessTokenLength=s.AccessToken.length),o.AccessTokenExpiry=s.AccessTokenExpiry);var a=vt.on;o.JsApiVersion=i.featureManager.isFeatureEnabled(a)?"v1Wrapper":"v1",t.ULS.h(596444237,r.W,n.Info,JSON.stringify({session:o,client:j()}))}catch(i){t.ULS.h(590915460,r.W,n.Error,"Failed to log initialization info: "+B(i))}var c,h}!function(t){t.rn="EnterpriseTemplates",t.sn="ExcelAdaptiveLayoutDownload",t.an="ExcelHashedUrl",t.cn="ExcelJsApiV2",t.hn="ExcelLandingPageOfflineTelemetry",t.un="ExcelLandingPageObserverRetry",t.fn="H2StaticContent",t.dn="HashedUrl",t.ln="InstantShell",t.pn="ODCShareLinkPreload",t.vn="OfficeComUiHost",t.on="WordJsApiV2",t.wn="WordScriptsPreload"}(vt||(vt={})),function(t){t.Unknown="Unknown",t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.CannotLoadScript="CannotLoadScript",t.PageChangeError="PageChangeError",t.ZoomChangeError="ZoomChangeError",t.CannotLoadBundleItem="CannotLoadBundleItem",t.InvalidPageIndex="InvalidPageIndex",t.UnsupportedBundleVersion="UnsupportedBundleVersion",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(wt||(wt={}));var Tt;function Et(t){return t.toLowerCase().indexOf("wordeditorframe.aspx")>0}function Ot(t){return t.toLowerCase().indexOf("wordviewerframe.aspx")>0}function Pt(t,i){void 0===i&&(i=!1);var e=t;return e=(e=e.replace(new RegExp("word-edit","i"),"word-view")).replace(new RegExp("/we/wordeditorframe.aspx","i"),"/wv/wordviewerframe.aspx"),i&&(e=O(e,"WordEditorFailedToLoad","1")),e}function Ut(t,i){var e=Et(t.applicationUrl),o=Ot(t.applicationUrl),s=It(t.applicationUrl);return i.ULS.h(595640900,r.W,n.Info,"gotUiEmbedUrl:"+s+", gotEditUrl:"+e+", gotViewUrl:"+o),!e&&t.wopiPrecheckInfo.IrmEnabled?{isSingleStepBoot:!0,bootFlowType:s?Tt.wordUiEmbedIrmEnabledEarlyRedirect:Tt.unifiedIrmEnabled,ignoreWacFramePostMessages:!1}:e?t.wopiPrecheckInfo.ReadOnly&&s?{isSingleStepBoot:!0,bootFlowType:Tt.wordUiEmbedReadOnlyEarlyRedirect,ignoreWacFramePostMessages:!1}:t.wopiInfo||p()===l.IE?{isSingleStepBoot:!0,bootFlowType:Tt.unifiedSingleFlush,ignoreWacFramePostMessages:t.isCreateNew||!1}:{isSingleStepBoot:!1,bootFlowType:Tt.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1}:{isSingleStepBoot:!0,bootFlowType:o?Tt.unifiedViewActionUrl:Tt.unifiedNotEditOrViewActionUrl,ignoreWacFramePostMessages:!o}}function Ft(t,i,e){void 0===e&&(e=!1);var n=t.applicationUrl;var o={jsApi:"1"};if(e&&(o.NewSession="1"),o.corrid=t.sessionId,o.usid=t.sessionId,o.sftc="1",t.applicationCustomSettings&&t.applicationCustomSettings.IsCore&&(o.core="1"),t.sessionInformation.HideViewerToolbar&&(o.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),t.sessionInformation.SupportsDocReboot){var r=t.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),t.sessionInformation.SupportsAuthToken&&(o.sat="1"),t.sessionInformation.HideHeader&&(o.hhdr="1"),t.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),t.sessionInformation.HideTitleInViewer&&(o.htv="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),t.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),t.sessionInformation.UIEmbed&&(o.uiEmbed="1"),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),i.isSingleStepBoot?(i.bootFlowType===Tt.unifiedSingleFlush&&(t.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=i.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(t.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(C(window.location.href)),t.isCreateNew&&(o.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),function(t){0;return!1}()&&(o.instantshell="1"),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(o=d(d({},t.applicationCustomSettings.additionalApplicationParameters),o)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(o=d(d({},o),t.rebootOverrideData.queryOverrides)),function(t,i,e,n,o){var r=P(t);"teams"!==r.uih&&"owa"!==r.uih||(r.hhdr="1");var s=t.indexOf("?"),a=-1===s?t.concat("?"):t.substring(0,s+1);i.UiLocale&&(r.ui=encodeURIComponent(i.UiLocale));i.DataLocale&&(r.rs=encodeURIComponent(i.DataLocale));i.HostSessionId&&(r.hid=encodeURIComponent(i.HostSessionId));i.DisableChat&&(r.dchat="1");i.SessionContext&&(r.sc=encodeURIComponent(i.SessionContext));e&&e.WopiSrc&&(r.wopisrc=encodeURIComponent(e.WopiSrc));i.CookieCompliant&&(r.mscc="1");n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString()));r=d(d(d({},r),i.WdParams),o);var c={};for(var h in r)c[h.toLowerCase()]=r[h];var u=[];for(var h in c)c[h]&&u.push(h.concat("=",c[h]));return a.concat(u.join("&"))}(n,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitDiagnostics,o)}function At(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect"}(Tt||(Tt={}));function Wt(t,i,e,n,o,r,s,a){return function(t,i,e,n){lt(t,n);var o=i.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=e,r.target=t.name,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return i.appendChild(r),r.submit(),t}(function(t,i,e,n,o){var r=t.ownerDocument.createElement("iframe");r.name=n||"WebApplicationFrame",r.id="WebApplicationFrame",r.src="",r.title="Office Online Frame",r.width="100%",r.height="100%",r.marginWidth="0",r.marginHeight="0",r.style.left="0",r.style.top="0",r.style.right="0",r.style.bottom="0",r.style.display="block",r.style.position="absolute",r.style.backgroundColor="transparent",r.style.border="none",r.frameBorder="0",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),e&&r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox");var s=C(i);return r.setAttribute("allow","microphone "+s+"; camera "+s+";"),o&&(r.onload=o),t.appendChild(r),r}(t,i,n,r),t,i,e)}function Rt(t,i){var e={};if(t.wopiInfo&&(e[ut.ge]=t.wopiInfo.AccessToken,e[ut.Ie]=At(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(e[ut.Se]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var o=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();i.ULS.h(593503580,r.W,n.Info,"Content bundle staleness - "+o),e[ut.be]=o}else i.ULS.h(593503581,r.W,n.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(e[ut.Ee]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.FileName){var s=t.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==s){var a=t.wopiPrecheckInfo.FileName.substring(s+1);a&&(e[ut.Te]=a)}e[ut.Oe]=t.wopiPrecheckInfo.FileName}return t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?e[ut.Pe]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(e[ut.Pe]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(e[ut.Le]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(e[ut.Me]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(e[ut.ke]=t.sessionInformation.SessionContext),t.diagnostics.HostInitDiagnostics&&(e[ut.xe]=JSON.stringify({HostInitializeDiagnostics:t.diagnostics.HostInitDiagnostics})),e[ut.Ce]=function(t,i){var e={};if(Object.keys(vt).forEach((function(i){var n=t.isFeatureEnabled(vt[i]);void 0!==n&&(e[vt[i]]=n?"1":"0")})),i&&i.wdFlights)for(var n=i.wdFlights.toLowerCase(),o=0,r=n.split(",");o<r.length;o++){var s=r[o];"et-treatment"!==s&&"et-control"!==s||(e[vt.rn]="et-treatment"===s?"1":"0")}return JSON.stringify(e)}(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(e[ut.Ne]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),e[ut.Re]=String(window.devicePixelRatio>1.24),e[ut.Be]=String(I()),e[ut.De]=t.sessionInformation.HostName,t.newFileTemplateSource&&(e[ut.He]=t.newFileTemplateSource.FileGetUrl),t.newFileTemplateSource&&t.newFileTemplateSource.DocUniqueId?e[ut.ye]=t.newFileTemplateSource.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(e[ut.ye]=t.wopiPrecheckInfo.DocUniqueId),t.newFileTemplateSource&&t.newFileTemplateSource.ETag?e[ut._e]=t.newFileTemplateSource.ETag:t.wopiPrecheckInfo.ETag&&(e[ut._e]=t.wopiPrecheckInfo.ETag),e}var xt=function(){function t(t,i,e,o,s,a){var c=this;if(this.mn=!1,this.gn=[],this.logWarningOnNoAppComplete=function(t){c.mn||(c.Wt.ULS.h(594901218,r.W,n.Warning,"Boot_NotComplete_"+(t||"Final")),c.Wt.ULS.flush())},void 0===i)throw new TypeError("bootFlowInfo");if(i.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.In=t,this.Sn=i,this.Wt=e,this.bn=o,this.yn=s,this._n=a,this.Cn=t.diagnostics.AppInitDiagnostics,this.Tn=t.diagnostics.SessionTraces,this.Tn.wopiInitializeTime=Date.now()}return t.prototype.Boot=function(){var t=this;this.Wt.ULS.h(596444241,r.W,n.Info,"Initializing WAC frame");var i=Ft(this.In,this.Sn,!0),e=Rt(this.In,this.Wt);if(function(t,i,e,o){if(i.getValue(D.pt,!1)){z=J();var s=t?3e3:5e3;V=window.setInterval((function(){e.ULS.h(595724178,r.W,n.Info,"Boot_HeartBeat"),J()-z>i.getValue(D.rt,3e5)&&(q(),o&&o())}),i.getValue(D.lt,s))}}(y(i),this.In.settingsManager,this.Wt,this.logWarningOnNoAppComplete),this.bn.registerMessagePayloadHandler(et.jt,(function(i){t.handleWacAppBootState(i)})),this.bn.registerMessagePayloadHandler(et.bi,(function(i){t.handleTrustFrameRequest(i)})),this.Sn.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(i,e),this.Sn.ignoreWacFramePostMessages){var o=this.getApplicationState();this.yn(o)}return this.Wt.ULS.h(595661019,r.W,n.Info,"Created Wac Frame"),this.En},t.prototype.bootWacFrame=function(t,i){this.Cn.officeFrameCreateTime=Date.now(),this.Tn.frameCreateStartTime=this.Cn.officeFrameCreateTime;var e=!this.In.settingsManager.getValue(D.ut,!1)&&!(!this.In.sessionInformation.WdParams||!this.In.sessionInformation.WdParams.wdSandboxWacFrame),n=this.In.applicationCustomSettings&&this.In.applicationCustomSettings.appFrameName;this.En=Wt(this.In.container,t,i,e,this.In.featureManager,n,this.Wt,this.In.sessionId),this.bn.activate(this.En)},t.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var t=this;this.bn.registerMessagePayloadHandler(et.Lt,(function(i){t.handleWacCompleteMessage(i)})),this.bn.registerMessagePayloadHandler(et.Ht,(function(i){t.handleWacFailureMessage(i)})),this.gn.push(window.setTimeout((function(){return t.timeoutWacAppCompleteOrFail()}),15e3)),this.gn.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(1)}),this.In.settingsManager.getValue(D.st,6e4))),this.gn.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(2)}),this.In.settingsManager.getValue(D.at,18e4)))},t.prototype.handleWacAppBootState=function(t){var i=t&&t.state?t.state:"unknown";this.Wt.ULS.h(595714271,r.W,n.Info,"WAC Boot App state:["+i+"]")},t.prototype.handleTrustFrameRequest=function(t){var i=pt(this.Wt);this.Wt.ULS.h(595653903,r.W,n.Info,"Top frame is trusted: "+i),this.bn.sendPostMessage(this.En.contentWindow,nt.bi,{isTopFrameTrusted:i})},t.prototype.handleWacCompleteMessage=function(t){if(this.Wt.ULS.h(595986314,r.W,n.Info,"Received wac complete message"),this.Wt.ULS.flush(),q(),this.clearLogTimers(),this.mn)this.Wt.ULS.h(596444234,r.W,n.Info,"Received multiple wac complete or failure messages");else{this.mn=!0,this.sendWacPostMessage(nt.Wi,{}),bt(this.Cn,t);var i=this.getApplicationState();this.yn(i),this.sendJsApiDiagnosticsToWacFrame(this.In.diagnostics)}},t.prototype.getApplicationState=function(){return{innerApplicationFrame:this.En}},t.prototype.handleWacFailureMessage=function(t){if(this.Wt.ULS.h(595986315,r.W,n.Error,"Received wac failed message"),this.Wt.ULS.flush(),q(),this.clearLogTimers(),this.mn)this.Wt.ULS.h(596444235,r.W,n.Info,"Received multiple wac complete or failure messages");else{this.mn=!0,this.sendWacPostMessage(nt.Ai,{});var i={errorType:wt.WacFailed,errorObject:{}};t&&(i.errorObject=t.Error,this.Tn.error=i),this._n(i)}},t.prototype.timeoutWacAppCompleteOrFail=function(){this.mn||this.Wt.ULS.h(596444236,r.W,n.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.Tn))},t.prototype.clearLogTimers=function(){for(var t=0;t<this.gn.length;t+=1)this.gn[t]&&window.clearTimeout(this.gn[t]);this.gn=[]},t.prototype.sendJsApiDiagnosticsToWacFrame=function(t){this.sendWacPostMessage(nt.ki,{HostInitializeDiagnostics:t.HostInitDiagnostics})},t.prototype.sendWacPostMessage=function(t,i){this.En&&this.En.contentWindow?this.bn.sendPostMessage(this.En.contentWindow,t,i):this.Wt.ULS.h(595955718,r.W,n.Info,"Attempted to send postmessage: "+t)},t}(),Dt=!1,Nt=!1;function Mt(){Dt=!1}function kt(t,i,e,o,s,a){if(i.ULS.h(595714433,r.W,n.Info,"Starting disposing the application. unloadApp:"+t+"; disposed:"+Dt+"; unloading:"+Nt),Dt||Nt&&t)i.ULS.h(595714908,r.W,n.Info,"Application is already disposed or unloading");else{var c,h={logger:i,postMessenger:e,innerApplicationFrame:o,onDisposed:s,unloadTimeoutInMs:a||1e3,forceAppUnload:!1,disposeStartTime:Date.now(),appUnloadTimedOut:!1};if(t&&o)return Nt=!0,h.forceAppUnload=!0,(c=h).forceAppUnloadStartTime=Date.now(),c.logger.ULS.h(595855490,r.W,n.Info,"Sending postmessage to unload app"),c.logger.ULS.flush(),c.postMessenger.registerMessagePayloadHandler(et.yi,(function(t){return function(t,i){t.forceAppUnloadEndTime=Date.now(),t.appUnloadedMessageValues=i,t.logger.ULS.h(595855491,r.W,n.Info,"AppUnloaded received from app"),Bt(t)}(c,t)})),c.postMessenger.sendPostMessage(c.innerApplicationFrame.contentWindow,nt.Yi,{}),void window.setTimeout((function(){return function(t){!Nt&&Dt||(t.appUnloadTimedOut=!0,t.logger.ULS.h(595855492,r.W,n.Info,"ApplicationUnload timed out, forcing dispose"),Bt(t))}(c)}),c.unloadTimeoutInMs);Bt(h)}}function Bt(t){if(!Dt)try{Dt=!0,Nt=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame)}),0)}(t),function(t){var i={disposeStartTime:t.disposeStartTime,disposeEndTime:Date.now(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(i.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(i.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var e=t.appUnloadedMessageValues;void 0!==e.sendBeaconFlight&&(i.sendBeaconFlight=e.sendBeaconFlight),void 0!==e.sendBeaconSupported&&(i.sendBeaconSupported=e.sendBeaconSupported);var o=Number(e.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(o)&&(i.hostToAppPostMessageLatency=o-t.forceAppUnloadStartTime);var s=Number(e.appMessageSent);!isNaN(s)&&t.forceAppUnloadEndTime&&(i.appToHostPostMessageLatency=t.forceAppUnloadEndTime-s);var a=Number(e.appUnloadStart),c=Number(e.appUnloadEnd);if(isNaN(a)||isNaN(c)||(i.appUnloadLatency=c-a),e.serverTimings){var h=e.serverTimings;for(var u in h)i["st-"+u.toString()]=h[u]}}t.logger.ULS.h(595855436,r.W,n.Info,"App disposed "+JSON.stringify(i)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(i){t.logger.ULS.h(595714434,r.W,n.Error,"Error disposing: "+B(i))}}var Ht,jt=function(){function t(t,i,e,n,o,r,s){var a=this;this.On=!1,this.Pn=!1,this.Un=!1,this.Fn=null,this.An=!0,this.Wn=!1,this.Rn=!1,this.In=t,this.Sn=i,this.Cn=t.diagnostics.AppInitDiagnostics,this.Wt=e,this.bn=n,this.yn=r,this._n=s,this.Tn=t.diagnostics.SessionTraces,this.Tn.wopiPendingInitializeTime=Date.now(),this.xn=o,Mt(),window.setTimeout((function(){return a.timeoutCompleteOrFail()}),5e3)}return t.prototype.Complete=function(t,i){if(this.Un)this.Wt.ULS.h(596444184,r.W,n.Warning,"Complete called after Complete/Fail already called");else{this.Wt.ULS.h(596444185,r.W,n.Info,"Complete called."),this.Un=!0,this.Dn=t,this.Tn.wopiPendingCompleteTime=Date.now();try{this.Sn.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.On&&this.sendWacPostMessage(nt.Hi,{}),this.updateBrowserHistoryForCreateNew(i)}catch(t){this.Wt.ULS.h(596444186,r.W,n.Error,"Unexpected script error: "+B(t))}finally{this.Wt.ULS.flush()}}},t.prototype.Fail=function(t){this.Un?this.Wt.ULS.h(596444187,r.W,n.Warning,"Fail called after Complete/Fail already called"):(this.Wt.ULS.h(596444188,r.W,n.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.Un=!0,this.Sn.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(t),this.Wt.ULS.flush())},t.prototype.Dispose=function(t,i,e){var n=this;kt(t||!1,this.Wt,this.bn,this.En,(function(){delete n.En,i&&i(),n.xn(),n.bn.dispose()}),e)},t.prototype.Boot=function(){this.Sn.isSingleStepBoot||this.bootTwoStepFlow(),this.Wt.ULS.flush()},t.prototype.bootTwoStepFlow=function(){var t=this;this.Wt.ULS.h(596444231,r.W,n.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return t.timeoutWacReadyMessage()}),5e3),this.populateWacFrameEventHandlersForTwoStepFlow();var i=new xt(this.In,this.Sn,this.Wt,this.bn,this.yn,this._n);this.En=i.Boot()},t.prototype.populateWacFrameEventHandlersForTwoStepFlow=function(){var t=this;this.bn.registerMessagePayloadHandler(et.ni,(function(i){t.handleWacReadyMessage(i)})),this.bn.registerMessagePayloadHandler(et.ei,(function(i){t.handleWacFrameLoadedMessage(i)})),this.bn.registerMessagePayloadHandler(et.mi,(function(i){t.handleWacFrameSessionCompleteAckMessage(i)}))},t.prototype.completeTwoStepFlow=function(){var t={ParallelizeStartSession:this.An,WacFrameIsLoaded:this.On,WacAcceptsStartSessionComplete:this.Wn};this.Wt.ULS.h(596444232,r.W,n.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.An||this.On&&!this.Wn?this.On&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},t.prototype.completeSingleStepFlow=function(){this.Wt.ULS.h(596444233,r.W,n.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.In.wopiInfo=this.Dn;var t=new xt(this.In,this.Sn,this.Wt,this.bn,this.yn,this._n);this.En=t.Boot()},t.prototype.failTwoStepFlow=function(t){this.On?(this.Wt.ULS.h(595968481,r.W,n.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(t)):(this.Wt.ULS.h(595968482,r.W,n.Warning,"Fail was called on the session prior to WacReady."),this.Fn=t)},t.prototype.sendFailurePostMessageToWacFrame=function(t){this.Wt.ULS.h(596444189,r.W,n.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(nt.xi,t)},t.prototype.failSingleStepFlow=function(){this.Wt.ULS.h(596444190,r.W,n.Warning,"Fail called during single step boot, calling host failure callback..."),this._n({errorType:wt.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},t.prototype.timeoutWacReadyMessage=function(){this.On||(this.Wt.ULS.h(596444191,r.W,n.Warning,"Timeout Wac Ready"),this._n({errorType:wt.TimeoutWacReady,errorObject:void 0}))},t.prototype.timeoutCompleteOrFail=function(){this.Un||(this.Tn.timeoutCompleteOrFail=Date.now(),this.Wt.ULS.h(596444192,r.W,n.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.Tn)))},t.prototype.timeoutWacSessionCompletionMessageAck=function(t,i,e){this.Rn||(this.Wt.ULS.h(596444193,r.W,n.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(t,i,e+1))},t.prototype.handleWacReadyMessage=function(t){if(this.Tn.readyMessageReceiveTime=Date.now(),this.sendWacPostMessage(nt.Mi,{}),this.On)this.Wt.ULS.h(596444194,r.W,n.Info,"Received multiple ready messages - frame is already loaded.");else{this.On=!0,this.Wn=t&&t.CanAcceptStartSessionComplete;var i={AcceptStartSessionComplete:this.Wn,ParallelizeStartSession:this.An,StartSessionResponse:null!=this.Nn,WopiInfo:null!=this.Dn};this.Wt.ULS.h(596444195,r.W,n.Info,"HandleWacReadyMessage - "+JSON.stringify(i)),this.Un&&(this.Fn?this.sendFailurePostMessageToWacFrame(this.Fn):this.sendWacPostMessage(nt.Hi,{})),this.An&&this.Wn?this.Nn&&this.startSessionCompleted():this.Dn&&this.sendWopiInfoToWacFrame(),bt(this.Cn,t)}},t.prototype.handleWacFrameLoadedMessage=function(t){bt(this.Cn,t)},t.prototype.handleWacFrameSessionCompleteAckMessage=function(t){this.Rn=!0,this.Tn.sessionCompleteAckReceivedTime=Date.now()},t.prototype.sendWacPostMessage=function(t,i){this.En&&this.bn.sendPostMessage(this.En.contentWindow,t,i)},t.prototype.sendSessionCompletionMessageWithRetry=function(t,i){this.sendSessionCompletionMessageWithRetryHelper(t,i,1)},t.prototype.sendSessionCompletionMessageWithRetryHelper=function(t,i,e){var o=this;if(e>3)this.Wt.ULS.h(596444224,r.W,n.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Date.now());else{this.Wt.ULS.h(596444225,r.W,n.Info,"Sending completion message to frame. Attempt number: "+e+", Time: "+Date.now());var s=Date.now();1===e&&(this.Nn&&this.Nn.Diagnostics&&(this.Nn.Diagnostics.completeMessageCreateTime=s),this.Tn.completeMessageCreateTime=s),i.Diagnostics.completeMessageSendTime=s,this.Tn.completeMessageSendTime=s,this.sendWacPostMessage(t,i),window.setTimeout((function(){return o.timeoutWacSessionCompletionMessageAck(t,i,e)}),1e3)}},t.prototype.makeStartSessionRequest=function(){var t=this;this.Wt.ULS.h(596444226,r.W,n.Info,"Making parallelized startSession request.");var i=this.buildStartSessionUrl(this.Dn),e={"Content-Type":"application/x-www-form-urlencoded"},o="access_token="+encodeURIComponent(this.Dn.AccessToken)+"&access_token_ttl="+encodeURIComponent(At(this.Dn));this.Tn.startSessionStartTime=Date.now(),function(t,i,e,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),e)o.setRequestHeader(r,e[r]);o.send(i)}(i,o,e,(function(i){return t.onStartSessionRequestCompleted(i)}))},t.prototype.onStartSessionRequestCompleted=function(t){if(this.Tn.startSessionCompleteTime=Date.now(),this.Tn.startSessionResponseStatus=t.status,this.Nn={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.Tn.wopiPendingInitializeTime,wopiPendingCompleteTime:this.Tn.wopiPendingCompleteTime,startSessionStartTime:this.Tn.startSessionStartTime,startSessionCompleteTime:this.Tn.startSessionCompleteTime,readyMessageReceiveTime:this.Tn.readyMessageReceiveTime}},this.Wt.ULS.h(596444227,r.W,n.Info,"StartSession request completed with status code: "+this.Nn.StartSessionResponse.RequestStatus+", Time: "+Date.now()),this.On&&this.Wn)this.startSessionCompleted();else{var i={WacFrameIsLoaded:this.On,InitializeCompleted:this.Pn};this.Wt.ULS.h(596444228,r.W,n.Info,"StartSessionCompleted not called - "+JSON.stringify(i))}},t.prototype.sendWopiInfoToWacFrame=function(){if(!this.Pn){this.Pn=!0,this.Wt.ULS.h(596444229,r.W,n.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:this.Dn.WopiSrc,AccessToken:this.Dn.AccessToken,AccessTokenTtl:At(this.Dn)},Diagnostics:{wopiPendingInitializeTime:this.Tn.wopiPendingInitializeTime,wopiPendingCompleteTime:this.Tn.wopiPendingCompleteTime,readyMessageReceiveTime:this.Tn.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(nt.ji,t)}},t.prototype.startSessionCompleted=function(){200===this.Nn.StartSessionResponse.RequestStatus?this.Pn||(this.Pn=!0,this.sendSessionCompletionMessageWithRetry(nt.Ki,this.Nn)):this.sendWopiInfoToWacFrame()},t.prototype.buildStartSessionUrl=function(t){var i=this.In.applicationBasePath+"wordeditorstartsession.ashx",e=Ft(this.In,this.Sn,!1);return i=O(i+="?"+e.substring(e.indexOf("?")+1),"WOPISrc",encodeURIComponent(t.WopiSrc)),i=O(i,"build",encodeURIComponent(Y())),i=O(i,"WacUserType",encodeURIComponent("WOPI")),this.In.wopiPrecheckInfo.FileGetUrl&&(i=O(i,"fileGetUrlPresent","1")),i},t.prototype.updateBrowserHistoryForCreateNew=function(t){if(this.In.isCreateNew){if(!t||!t.NewFilePath)return void this.Wt.ULS.h(596444230,r.W,n.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},t}();!function(t){t.AckExpected="ackExpected",t.ErrorObject="errorObject",t.ErrorType="errorType",t.IsDisabled="isDisabled",t.NewPageNumber="newPage",t.NewZoomLevel="newLevel",t.PageCount="pageCount"}(Ht||(Ht={}));var Lt=function(){function t(t,i,e,n,o,r,s){this.Mn=!1,this.kn=!1,this.Bn=!1,this.Hn=6e4,this.In=t,this.Cn=t.diagnostics.AppInitDiagnostics,this.Wt=e,this.bn=n,this.Tn=t.diagnostics.SessionTraces,this.xn=o;var a=window.navigator.userAgent;a.indexOf("Mobi")>=0&&a.indexOf("iPad")<0&&(this.Bn=!0),this.yn=r,this._n=s,this.jn=this.Bn?r:this.getSuccessCallbackProxy(),this.Ln=this.Bn?s:this.getFailureCallbackProxy(),this.Jn=!(!this.In.applicationCustomSettings||!this.In.applicationCustomSettings.IsCore),this.In.sessionInformation&&this.In.sessionInformation.WdParams&&(this.In.applicationCustomSettings&&this.In.applicationCustomSettings.ForceAccessibilityMode?this.In.sessionInformation.WdParams.wdAccPdf="1":this.Jn&&(this.In.sessionInformation.WdParams.wdAccPdf="0")),this.zn=new jt(this.In,i,e,n,o,this.jn,this.Ln)}return t.prototype.Complete=function(t){this.In.diagnostics.HostInitDiagnostics&&(this.In.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Date.now()),this.zn.Complete(t)},t.prototype.Fail=function(t){this.zn.Fail(t)},t.prototype.Dispose=function(t,i,e){var n=this;kt(t||!1,this.Wt,this.bn,this.En,(function(){delete n.En,i&&i(),n.xn(),n.bn.dispose()}),e)},t.prototype.Boot=function(){var t=this;if(this.Bn)this.Wt.ULS.h(595932544,r.O,n.Info,"Mobile Endpoint detected, skipping first page viewer optimization");else{this.Wt.ULS.h(595989253,r.O,n.Info,"Boot WordViewer"),this.bn.registerMessagePayloadHandler(et._i,(function(i){t.handleWacPageCountInit(i)})),this.bn.registerMessagePayloadHandler(et.ci,(function(i){t.handleWacCurrentPageInit(i)})),this.bn.registerMessagePayloadHandler(et.Pi,(function(i){t.handleWacZoomLevelInit(i)}));var i=this.In.rebootOverrideData;i&&i.reason&&"translate"===i.reason.toLowerCase()?this.Wt.ULS.h(591209105,r.O,n.Info,"Skip first page optimization"):this.In.wopiPrecheckInfo.BundleInfo?this.kickOffFirstPageOptimization(this.In.wopiPrecheckInfo.BundleInfo,this.In.container,(function(){t.Vn=Date.now(),t.Wt.ULS.h(595998873,r.O,n.Info,"FirstPageFromHostLoadTime: "+t.Vn),t.Cn.documentLoadedTime=t.Cn.documentLoadedTime||t.Vn,t.En&&t.En.contentWindow&&t.postFastBootOptimizationTime(t.En.contentWindow,t.Vn)}),(function(i){t.removeFirstPageContainer(),t.Wt.ULS.h(595994571,r.O,n.Warning,"Cannot load first page from cache"),t.Cn.errorObject=i})):this.Wt.ULS.h(596121033,r.O,n.Warning,"Missing Bundle Info"),window.setTimeout((function(){return t.timeoutAppInitialize()}),this.Hn)}},t.prototype.postFastBootOptimizationTime=function(t,i){this.bn.sendPostMessage(t,nt.Ni,{HostCacheLoadTime:i})},t.prototype.kickOffFirstPageOptimization=function(t,i,e,o){var s=this;if(this.Wt.ULS.h(595989254,r.O,n.Info,"Kick off OptimizationView"),!this.In.applicationCustomSettings||!this.In.applicationCustomSettings.ForceAccessibilityMode)if(t.Url){var a=i.ownerDocument;this.qn=a.createElement("div"),this.qn.id="FirstPageContainer",this.qn.style.left="0",this.qn.style.textAlign="center",this.qn.style.width="1px",this.qn.style.bottom="0",this.qn.style.zIndex="900",this.qn.style.height="1px",this.qn.style.position="absolute",this.qn.style.padding="0 29px",this.qn.style.right="0",this.qn.style.overflow="auto",this.qn.style.marginLeft="auto",this.qn.style.marginRight="auto",this.qn.style.maxWidth="100%",this.Jn?this.qn.style.top="0":this.qn.style.top="90px",i.appendChild(this.qn);var c=a.createElement("img");c.id="FirstPageImage",c.style.marginTop="11px",c.style.marginBottom="11px",c.style.maxWidth="100%",c.style.border="solid 1px #d2d5d8",c.draggable=!1,c.onload=function(){s.Wt.ULS.h(595989255,r.O,n.Info,"OptimizationView Loaded"),s.qn.style.width="",s.qn.style.height="",e()},c.onerror=function(t){o({errorType:wt.CannotLoadFirstPage,errorObject:t.returnValue})},c.src=t.Url.replace("{0}","p1.img"),this.qn.appendChild(c)}else this.Wt.ULS.h(595722645,r.O,n.Info,"Missing Url in provided Bundle Info, from host: "+this.In.sessionInformation.HostName)},t.prototype.tryInitializeApplication=function(){if(!this.kn&&this.Mn&&(!this.Jn||this.Gn&&this.Zn&&this.$n)){this.bn.removeMessageHandler(et._i),this.bn.removeMessageHandler(et.ci),this.bn.removeMessageHandler(et.Pi);var t={isCore:this.Jn,pageCount:this.Zn,currentPage:this.Gn,zoomLevel:this.$n,innerApplicationFrame:this.En};this.yn(t),this.Wt.ULS.h(595989256,r.O,n.Info,"Word Viewer Initialize Complete"),this.kn=!0,this.Wt.ULS.flush()}},t.prototype.getSuccessCallbackProxy=function(){var t=this;return function(i){t.Wt.ULS.h(595986312,r.O,n.Info,"SuccessCallbackProxy called"),t.En=i.innerApplicationFrame,t.En&&t.En.contentWindow&&t.Vn&&t.postFastBootOptimizationTime(t.En.contentWindow,t.Vn),t.removeFirstPageContainer();var e=t.Cn.documentLoadedTime;e&&t.Vn&&t.Vn<e?(t.Cn.documentLoadedTime=t.Vn,t.Cn.documentLoadedFromWopiPrecheckInfo=!0,t.Wt.ULS.h(595994572,r.O,n.Info,"First page load from cache was faster")):t.Cn.documentLoadedFromWopiPrecheckInfo=!1,t.sendAckMessages(),t.Mn=!0,t.Wt.ULS.h(595986313,r.O,n.Info,"WordViewerInitializer received wac complete message"),t.tryInitializeApplication(),t.Wt.ULS.flush()}},t.prototype.getFailureCallbackProxy=function(){var t=this;return function(i){t.Wt.ULS.h(595972122,r.O,n.Error,"FailureCallbackProxy called"),t.kn=!0,t._n(i)}},t.prototype.removeFirstPageContainer=function(){this.qn&&this.qn.parentElement&&this.qn.parentElement.removeChild(this.qn)},t.prototype.timeoutAppInitialize=function(){if(!this.kn){this.Tn.timeoutAppInitialize=Date.now();var t="Didn't receive app initialize post messages. {'appComplete': "+this.Mn+", 'currentPage': "+(void 0!==this.Gn)+", 'zoomLevel': "+(void 0!==this.$n)+", 'pageCount': "+(void 0!==this.Zn)+"}";this.Wt.ULS.h(596120771,r.O,n.Warning,t)}},t.prototype.handleWacPageCountInit=function(t){if(!t||"number"!=typeof t[Ht.PageCount])throw new TypeError("values: PageCount not found");this.Zn=t[Ht.PageCount],this.sendWacPostMessage(nt.te,{}),this.tryInitializeApplication()},t.prototype.handleWacCurrentPageInit=function(t){if(!t||"number"!=typeof t[Ht.NewPageNumber])throw new TypeError("values: CurrentPage not found");this.Gn=t[Ht.NewPageNumber],this.sendWacPostMessage(nt.Bi,{}),this.tryInitializeApplication()},t.prototype.handleWacZoomLevelInit=function(t){if(!t||"number"!=typeof t[Ht.NewZoomLevel])throw new TypeError("values: ZoomLevel not found");this.$n=t[Ht.NewZoomLevel],this.sendWacPostMessage(nt.ie,{}),this.tryInitializeApplication()},t.prototype.sendAckMessages=function(){this.Gn&&this.sendWacPostMessage(nt.Bi,{}),this.Zn&&this.sendWacPostMessage(nt.te,{}),this.$n&&this.sendWacPostMessage(nt.ie,{})},t.prototype.sendWacPostMessage=function(t,i){this.En&&this.En.contentWindow?this.bn.sendPostMessage(this.En.contentWindow,t,i):this.Wt.ULS.h(595955717,r.O,n.Info,"Attempted to send WordViewer postmessage: "+t)},t}(),Jt=function(){function t(t,i){var e=this;if(this.Xn=!1,this.Kn=function(t){return e.handleWacFramePostMessage(t)},this.pe=!1,this.de=!1,this.le=!1,this.Qn={},!t)throw new Error("Missing origin for PostMessageHandler");this.de=y(t),this.le=_(t),this.Wt=i,this.setOrigin(t)}return t.prototype.registerMessagePayloadHandler=function(t,i){if(this.Qn[t])throw new Error("Duplicate registration!");this.Qn[t]=i},t.prototype.removeMessageHandler=function(t){delete this.Qn[t]},t.prototype.sendPostMessage=function(t,i,e){if(t){this.Wt.ULS.h(596464334,r.W,n.Info,"Sending message: "+i);var o={MessageId:i,SendTime:Date.now(),Values:e};this.sendPostMessageInternal(t,JSON.stringify(o),this.ue)}else this.Wt.ULS.h(595948308,r.W,n.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,i){void 0===i&&(i=!1),this.En=t,this.pe=i,this.Xn||(window.addEventListener("message",this.Kn,!1),this.Xn=!0)},t.prototype.postMessageForCommand=function(t,i,e){var o;(o=i===it.rename?nt.zi:i===it.switchMode?nt.Qi:at[i]?at[i].oe:void 0)?(this.Wt.ULS.h(595702598,r.W,n.Info,"Sending message "+o+" for command "+i),this.sendPostMessage(t,o,e)):this.Wt.ULS.h(595702599,r.W,n.Warning,"No mapping for command "+i)},t.prototype.dispose=function(){for(var t=0,i=Object.keys(this.Qn);t<i.length;t++){var e=i[t];delete this.Qn[e]}this.Xn&&(window.removeEventListener("message",this.Kn,!1),this.Xn=!1)},t.prototype.sendAckBack=function(t,i,e){if(t){var o={MessageId:nt.Ui,CorrelationId:e,SendTime:Date.now()};this.Wt.ULS.h(595732176,r.W,n.Info,"Sending Ack back"),t.postMessage(JSON.stringify(o),i)}else this.Wt.ULS.h(595736136,r.W,n.Info,"Missing target to send Ack back")},t.prototype.handleWacFramePostMessage=function(t){var i=!1,e=!0,o="",s=!1;if(this.En&&this.En.contentWindow&&(i=!0,e=t.source===this.En.contentWindow),t.origin&&(s=(o=T(t.origin,2).toLowerCase())===this.fe),!this.de&&(!this.le||s&&e)||this.Wt.ULS.h(595730526,r.W,n.Info,"Window is available: "+i+", window is valid: "+e+", origin is valid: "+s+", expected origin: "+this.fe+", actual origin: "+o),s&&(!this.pe||e)){var a;try{a=JSON.parse(t.data)}catch(t){return void this.Wt.ULS.h(596464282,r.W,n.Info,"Failed to parse event data: "+B(t)+".")}var c=a.MessageId;if(c){this.Wt.ULS.h(595714715,r.W,n.Info,"Received messageId: "+c+", correlation: "+a.CorrelationId),c!==et.Lt&&c!==et.oi||this.setOrigin(t.origin),a.Values&&a.Values[Ht.AckExpected]&&this.sendAckBack(t.source,t.origin,a.CorrelationId);var h=this.Qn[c];if(h){this.Wt.ULS.h(596464288,r.W,n.Info,"Processing message: "+c);try{h(a.Values||{})}catch(t){this.Wt.ULS.h(593773704,r.W,n.Error,"Handler error: "+B(t))}}else this.Wt.ULS.h(596464289,r.W,n.Info,"No handler found for message id: "+c)}else(this.de||this.le)&&this.Wt.ULS.h(595730520,r.W,n.Info,"Could not find message id")}},t.prototype.sendPostMessageInternal=function(t,i,e){t.postMessage(i,e)},t.prototype.setOrigin=function(t){var i=t.toLowerCase();this.ue&&this.ue!==i&&this.Wt.ULS.h(596128131,r.W,n.Warning,"Updating origin:"+this.ue+"->"+i),this.ue=i,this.fe=T(i,2),this.de=y(i),this.le=_(i)},t}(),zt=function(){function t(){var t=this;if(this.Yn=[],this.Qn=[],this.to=function(){return t.handleVisibilityChange()},"hidden"===document.visibilityState){var i={visibility:document.visibilityState,time:Date.now(),initialState:!0};this.Yn.push(i)}document.addEventListener("visibilitychange",this.to)}return t.prototype.RegisterEventHandler=function(t){this.Qn.push(t)},t.prototype.RemoveEventHandler=function(t){if(t){var i=this.Qn.indexOf(t);this.Qn.splice(i,1)}},t.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.to)},t.prototype.GetVisibilityChangeEvents=function(){return this.Yn},t.prototype.Dispose=function(){this.Stop(),this.Qn=[],this.Yn=[]},t.prototype.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:Date.now(),initialState:!1};this.Yn.push(t);for(var i=0,e=this.Qn;i<e.length;i++){var n=e[i];n&&n(t)}},t}();function Vt(t){var i,e,n=t.RebootOverrideData;n&&((e=n.mode)&&("view"===(e=e.toLowerCase())&&Et(t.ApplicationUrl)?t.ApplicationUrl=Pt(t.ApplicationUrl):"edit"===e&&Ot(t.ApplicationUrl)&&(t.ApplicationUrl=(i=t.ApplicationUrl,i.replace(new RegExp("word-view","i"),"word-edit").replace(new RegExp("/wv/wordviewerframe.aspx","i"),"/we/wordeditorframe.aspx")))))}function qt(t,i,e,n,o,r){void 0===r&&(r=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,i){t.SessionInformation.WdParams||(t.SessionInformation.WdParams={});if(t.SessionInformation.WdParams.wd)return;i.substring(1).split("&").filter((function(i){if(0===i.indexOf("wd")){var e=i.split("=");e[0].length>2&&(t.SessionInformation.WdParams[e[0]]=e[1])}})),t.RebootOverrideData&&t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId&&(t.SessionInformation.WdParams.wdprevioussession=t.RebootOverrideData.previousSessionId)}(t,window.location.search);var s=o||new st("Word",e);return{container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:t.Diagnostics,AppInitDiagnostics:{officeSessionId:i,officeBootstrapperVersion:Y(),hostName:t.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:i,applicationBasePath:St(t.ApplicationUrl),wopiInfo:t.WopiInfo,forceSingleStepBoot:r,isCreateNew:t.WopiPrecheckInfo.IsNewFile||"1"===E(t.ApplicationUrl,"new"),featureManager:n||K(t.FnIsFeatureEnabled,e),settingsManager:s,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData}}var Gt,Zt=function(){function t(t,i){this.io=t,this.eo=i}return t.prototype.GetVersion=function(){return Y()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var i=document.createElement("link");i.rel="prefetch";var e=t.BootstrapperUrl;".js"!==e.toString().slice(-3)&&(e+=".js"),i.href=e;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(i)}},t.prototype.InitializeWopiPending=function(t,i,e,o,s,a){var c,h,u,f,l,p=!1;try{var v,m=Date.now();!function(t){if(void 0===t)throw new TypeError("initParams");var i=t.Container;if(void 0===i||void 0===i.appendChild)throw new TypeError("Container");var e=t.SessionInformation;if(void 0===e||void 0===e.HostName||void 0===e.HostSessionId||void 0===e.UserId)throw new TypeError("SessionInformation");var n=t.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),Vt(t),e?u=e:t.RebootOverrideData&&!t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId?u=t.RebootOverrideData.previousSessionId:(u=(c=ct())[0],f=c[1]),h=i||X({remoteUlsEndpoint:St(t.ApplicationUrl)+"RemoteUls.ashx",sessionId:u}),l=qt(t,u,h,s,a,this.eo.forceSingleStepBoot),a||(l.settingsManager.addSettingsChangeListener(h.settingsChangeHandler),l.settingsManager.initializePeriodicFetch(l.applicationBasePath,u)),l.diagnostics.HostInitDiagnostics&&(l.diagnostics.HostInitDiagnostics.hostInitializeCallTime=m),Ct(h,l,f),p=!0,function(t,i){N=function(){return L(t,"OnBeforeUnload",i)},M=function(){return L(t,"OnPageHide",i)},k=function(){return L(t,"VisibilityChange_"+document.visibilityState,i)},window.addEventListener("beforeunload",N,{capture:!0,once:!0}),window.addEventListener("pagehide",M,{capture:!0}),window.addEventListener("visibilitychange",k,{capture:!0})}(h,!0);var g=t.BootstrapperUrl;g&&(v=this.periodicPrefetch(g,h));var I=function(){l.settingsManager.dispose(),window.removeEventListener("beforeunload",N,{capture:!0}),window.removeEventListener("pagehide",M,{capture:!0}),window.removeEventListener("visibilitychange",k,{capture:!0}),window.clearInterval(v)},S=C(t.ApplicationUrl),b=o||new Jt(S,h),y=new zt,_=function(t,i){var e={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?Tt.forceSingleStepBoot:Tt.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot||(e=Ut(t,i)),e.isSingleStepBoot){var o={singleStepBootIsRequired:!0,singleStepBootReason:e.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:e.ignoreWacFramePostMessages};i.ULS.h(596444182,r.W,o.irmEnabled?n.Warning:n.Info,JSON.stringify(o))}else i.ULS.h(596444183,r.W,n.Info,"Received input valid for two step flow");return e}(l,h),T=function(t,i,e,o,s,a,c,h){return function(u){_t(t,s),yt(t.SessionTraces,o,n.Info);var f=Xt(t);o.ULS.h(596448985,r.W,n.Info,JSON.stringify(f));var d=h(i,o,e,a,u);try{c(d,f)}catch(t){o.ULS.h(595719171,r.W,n.Error,"Exception thrown from host's success callback: "+B(t))}H("word",o),$t(o)}}(l.diagnostics,l.sessionId,b,h,y,I,t.FnOnInitializeSuccess,this.io),O=function(t,i,e,o){return function(s){_t(t,e),yt(t.SessionTraces,i,n.Warning);var a=Xt(t);i.ULS.h(596448986,r.W,n.Error,JSON.stringify({error:s,appInitDiagnostics:a}));try{o(s,a)}catch(t){i.ULS.h(595719172,r.W,n.Error,"Exception thrown from host's failure callback: "+B(t))}H("word",i),$t(i)}}(l.diagnostics,h,y,t.FnOnInitializeFailure);if(w(),t.FnOnAppModeSwitched&&b.registerMessagePayloadHandler(et.ri,t.FnOnAppModeSwitched),this.eo.useViewerInitializer||_.bootFlowType===Tt.unifiedViewActionUrl||_.bootFlowType===Tt.wordUiEmbedReadOnlyEarlyRedirect||_.bootFlowType===Tt.wordUiEmbedIrmEnabledEarlyRedirect){!this.eo.useViewerInitializer&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),_.bootFlowType===Tt.wordUiEmbedReadOnlyEarlyRedirect&&(l.applicationUrl=Pt(l.applicationUrl,!0)),l.sessionInformation.HideViewerToolbar&&(l.applicationCustomSettings=d(d({},l.applicationCustomSettings),{IsCore:!0}),delete l.sessionInformation.HideViewerToolbar);var P=new Lt(l,_,h,b,I,T,O);return P.Boot(),P}if(t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),g&&this.eo.preloader&&this.eo.preloader.shouldPreload(l.applicationUrl))try{var U=g;0,l.featureManager.isFeatureEnabled(vt.fn)&&(h.ULS.h(595645891,r.W,n.Info,"HTTP2 preload enabled"),U=function(t){var i=new RegExp("(c[1-5])h?(-)");return t.replace(i,"$1h$2")}(g));var F=l.sessionInformation.UiLocale;F||(F=decodeURIComponent(E(l.applicationUrl,"ui"))),this.eo.preloader.preload(U,F,h,l.featureManager)}catch(t){h.ULS.h(595943884,r.W,n.Error,B(t))}var A=new jt(l,_,h,b,I,T,O);return A.Boot(),A}catch(i){return h&&(h.ULS.h(596459925,r.W,n.Error,wt.AppInitError+": "+B(i)),p||Ct(h,l||qt(t,u,h,s,a,this.eo.forceSingleStepBoot),f),h.ULS.flushOnClose()),void t.FnOnInitializeFailure({errorType:wt.AppInitError,errorObject:i},void 0)}},t.prototype.periodicPrefetch=function(t,i){var e=this;return window.setInterval((function(){e.Prefetch({BootstrapperUrl:t}),i.ULS.h(595895774,r.W,n.Info,"Prefetching "+U(t))}),36e5)},t}();function $t(t){t.ULS.h(590914655,r.W,n.Info,"Time spent logging: "+t.getTimeSpentLogging())}function Xt(t){return d(d(d({},t.AppInitDiagnostics),t.HostInitDiagnostics),{SessionTraces:t.SessionTraces})}!function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.ModeSwitched="ModeSwitched",t.CreateNewDocument="App_CreateNewDocument"}(Gt||(Gt={}));var Kt=function(){function t(t,i,e,n,o){this.Qn={},this.no=!1,this.oo=!1,this.ro=t,this.Wt=i,this.En=o.innerApplicationFrame,this.bn=e,this.so=n,this.registerPostMessageHandlers(),Mt()}return t.prototype.GetApplicationType=function(){throw new Error("Not implemented")},t.prototype.GetVersion=function(){return Y()},t.prototype.GetSessionId=function(){return this.ro},t.prototype.RegisterEventHandler=function(t,i){if(this.oo)throw new Error("RegisterEventHandler is not supposed to be called");this.no=!0,this.registerEventHandlerInternal(t,i)},t.prototype.RemoveEventHandler=function(t,i){if(this.oo)throw new Error("RemoveEventHandler is not supposed to be called");switch(t){case Gt.Unloaded:case Gt.DocumentReboot:case Gt.WopiInfoFromUrl:if(this.Qn[t]!==i)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Qn[t];break;default:this.bn.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.RegisterAllEventsHandler=function(t){var i=this;if(this.no)throw new Error("RegisterAllEventsHandler is not supposed to be called");if(this.oo)throw new Error("RegisterAllEventsHandler is supposed to be called only once");this.oo=!0,Object.keys(at).forEach((function(e){at[e].ne&&i.registerEventHandlerInternal(e,(function(i){return t({MessageId:e,SendTime:void 0,CorrelationId:void 0,Values:i})}))})),this.registerEventHandlerInternal(Gt.WopiInfoFromUrl,(function(i){t({MessageId:et.ii,SendTime:void 0,CorrelationId:void 0,Values:i})}))},t.prototype.PostCommand=function(t,i){this.bn.postMessageForCommand(this.En.contentWindow,t,i)},t.prototype.Dispose=function(t,i){var e=this;kt(t||!1,this.Wt,this.bn,this.En,(function(){delete e.En,e.so(),e.bn.dispose(),e.raiseEvent(Gt.Unloaded,{});for(var t=0,i=Object.keys(e.Qn);t<i.length;t++){var n=i[t];delete e.Qn[n]}}),i)},t.prototype.registerEventHandlerInternal=function(t,i){switch(t){case Gt.Unloaded:case Gt.DocumentReboot:case Gt.WopiInfoFromUrl:if(this.Qn[t])throw new Error("Duplicate registration");this.Qn[t]=i;break;default:this.bn.registerMessagePayloadHandler(t,i)}},t.prototype.registerPostMessageHandlers=function(){this.bn.registerMessagePayloadHandler(et.fi,this.handleDocumentRebootMessage.bind(this)),this.bn.registerMessagePayloadHandler(et.ii,this.handleWopiInfoFromUrlRequest.bind(this))},t.prototype.raiseEvent=function(t,i){var e=this.Qn[t];if(e)try{e(i||{})}catch(t){this.Wt.ULS.h(593773706,r.W,n.Error,"Handler error: "+B(t))}},t.prototype.handleDocumentRebootMessage=function(t){t.previousSessionId=this.ro,this.raiseEvent(Gt.DocumentReboot,t)},t.prototype.handleWopiInfoFromUrlRequest=function(t){this.raiseEvent(Gt.WopiInfoFromUrl,t)},t}();var Qt=function(t){function i(i,e,n,o,r){var s=t.call(this,i,e,n,o,r)||this;return s.ao=5e3,s.En=r.innerApplicationFrame,s.bn=n,s.Wt=e,s.Qn={},s.Jn=r.isCore,s.co=r.currentPage,s.$n=r.zoomLevel,s.Zn=r.pageCount,s.ho=!s.Jn,s.bn.registerMessagePayloadHandler(et.Pi,s.handleZoomChange.bind(s)),s.bn.registerMessagePayloadHandler(et.ci,s.handlePageChange.bind(s)),s.bn.registerMessagePayloadHandler(et.ti,s.handleIsDisabled.bind(s)),s.bn.registerMessagePayloadHandler(et.Zt,s.raiseError.bind(s)),s}return f(i,t),i.prototype.SetCurrentPage=function(t){var i=this;this.ho?this.raiseError({errorType:wt.ApiDisabledError,errorObject:{isCoreMode:this.Jn}}):(this.uo=t,this.En&&this.bn.sendPostMessage(this.En.contentWindow,nt.$i,{newPage:this.uo}),window.setTimeout((function(){i.uo!==i.co&&i.Wt.ULS.h(596444179,r.O,n.Info,'Did not receive the page change update. {"RequestedPage": '+i.uo+', "CurrentPage": '+i.co+"}")}),this.ao))},i.prototype.GetPageCount=function(){return this.ho&&this.raiseError({errorType:wt.ApiDisabledError,errorObject:{isCoreMode:this.Jn}}),this.Zn},i.prototype.GetCurrentPage=function(){return this.ho&&this.raiseError({errorType:wt.ApiDisabledError,errorObject:{isCoreMode:this.Jn}}),this.co},i.prototype.SetZoomLevel=function(t){var i=this;this.ho?this.raiseError({errorType:wt.ApiDisabledError,errorObject:{isCoreMode:this.Jn}}):(this.fo=Number(t.toFixed(2)),this.En&&this.bn.sendPostMessage(this.En.contentWindow,nt.Xi,{newLevel:this.fo}),window.setTimeout((function(){i.fo!==i.$n&&i.Wt.ULS.h(596444180,r.O,n.Info,'Did not receive the zoom change update. {"RequestedZoom": '+i.fo+', "CurrentZoom": '+i.$n+"}")}),this.ao))},i.prototype.GetZoomLevel=function(){return this.ho&&this.raiseError({errorType:wt.ApiDisabledError,errorObject:{isCoreMode:this.Jn}}),this.$n},i.prototype.GetIsDisabled=function(){return this.ho},i.prototype.GetApplicationType=function(){return"Word Viewer"},i.prototype.RegisterEventHandler=function(t,i){switch(t){case Gt.ZoomChanged:case Gt.PageChanged:case Gt.IsDisabled:if(this.Qn[t])throw new Error("Duplicate registration");this.Qn[t]=i;break;default:this.bn.registerMessagePayloadHandler(t,i)}},i.prototype.RemoveEventHandler=function(t,i){switch(t){case Gt.ZoomChanged:case Gt.PageChanged:case Gt.IsDisabled:if(this.Qn[t]!==i)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Qn[t];break;default:this.bn.removeMessageHandler(t)}},i.prototype.RegisterErrorHandler=function(t){this.do=t},i.prototype.RemoveErrorHandler=function(t){if(this.do!==t)throw new Error("The handler requested to be removed does not exist");delete this.do},i.prototype.raiseError=function(t){var i={errorType:"",errorObject:{}};if(i.errorType=t[Ht.ErrorType],i.errorObject=t[Ht.ErrorObject],!i.errorType||!i.errorObject)throw new TypeError("Error object is missing errorType or errorObject");this.do&&this.do(i)},i.prototype.handleZoomChange=function(t){this.$n=t[Ht.NewZoomLevel],this.raiseEvent(Gt.ZoomChanged,t)},i.prototype.handlePageChange=function(t){this.co=t[Ht.NewPageNumber],this.raiseEvent(Gt.PageChanged,t)},i.prototype.handleIsDisabled=function(t){this.ho=t[Ht.IsDisabled],this.raiseEvent(Gt.IsDisabled,t)},i}(Kt);function Yt(t,i,e){if(!e||!e.isFeatureEnabled(vt.wn))return[];var n=C(t).replace("word-view","word-edit")+"/we/s/"+function(){var t=Y();if(!t)throw new Error("Build number not available");var i=t.split(".");if(4!==i.length)throw new Error("Build number has incorrect format");return i[0]+i[2]+i[3]}()+"_";return["App_Scripts/WordEditor.js"].map((function(t){return n+t}))}function ti(t,i,e,n,o,r){return t!==it.boot?Promise.reject("Wrong flow"):new Promise((function(t){!function(t){if(void 0===t)throw new TypeError("SessionBootParams");var i=t.appUrl,e=t.appBaseUrl;if(void 0===i&&void 0===e)throw new TypeError("Either appUrl or appBaseUrl should exist");if(void 0!==i&&"string"!=typeof i)throw new TypeError("AppUrl");if(void 0!==e&&"string"!=typeof e)throw new TypeError("AppBaseUrl");var n=t.file;if(void 0===n||void 0===n.name)throw new TypeError("FileInfo");var o=t.container;if(void 0===o||!(o instanceof mt)&&void 0===o.appendChild)throw new TypeError("Container");var r=t.wopi;if(void 0===r||void 0===r.source||void 0===r.accessToken||void 0===r.expiry)throw new TypeError("WopiInfo")}(n),i.state=x.Booting,i.appBaseUrl=n.appBaseUrl?n.appBaseUrl:C(n.appUrl),i.appUrl=n.appUrl||"",i.appBasePath=i.appBaseUrl+i.appInfo.path,i.intent=n.intent,i.file=n.file,i.wopi=n.wopi,i.contentBundle=n.contentBundle;var s,a=n.bootParams;i.bootParams=a,a&&a.ownerId?i.ownerId=a.ownerId:i.ownerId=n.ownerId,i.sessionContext=n.sessionContext,i.actNavId=n.actNavId,i.wdParams=n.wdParams,i.preseededSession=n.preseededSession,i.throttling=n.throttling,i.rebootOverride=n.rebootOverride,i.hostInitDiagnostics=n.diagnostics,i.appInitDiagnostics={},i.logger.configure({remoteUlsEndpoint:(s=i.appBasePath,s+"RemoteUls.ashx"),sessionId:i.sessionId}),i.settingsManager.initializePeriodicFetch(i.appBasePath,i.sessionId),n.rebootOverride&&i.settingsManager.addSettingsChangeListener(i.logger.settingsChangeHandler);var c=function(n,o){e.error=n,e.appInitDiagnostics=o,i.appInitDiagnostics=o;var r={completion:"failure",error:n};i.raiseEvent(R.BootCompleted,r),i.state=x.Failed,t(r)};o&&o.subscribe((function(){c({errorType:"Cancelled",errorObject:void 0})}));var h=function(t,i,e,n){var o=t.appBasePath+"wordeditorframe.aspx?";if(t.appUrl){var r=P(t.appUrl);Object.keys(r).forEach((function(t){o+=t+"="+r[t]+"&"}))}var s=t.ui;s&&s.uiEmbed&&(o=O(o,"uiembed","1"));var a=t.host;a.uiHostName&&(o=O(o,"uih",a.uiHostName));var c=t.user;c.isLicensed&&(o=O(o,"islicenseduser","1"));i.actNavId&&(o=O(o,"actnavid",i.actNavId));var h=i.container,u=h instanceof mt?h.Ve:h,f=i.bootParams,d=t.viewMode,l=a.capabilities,p=i.file,v=i.contentBundle,w=i.preseededSession,m=i.throttling,g=i.wopi,I=i.newFileTemplate;return{BootstrapperUrl:t.bootstrapperUrl,Container:u,SessionInformation:{HostName:a.storageHostName,HostSessionId:t.hostSessionId,UserId:c.id,OwnerId:t.ownerId,UiLocale:s&&s.language,DataLocale:f&&f.dataLanguage,DisableChat:f&&f.disableChat,CookieCompliant:f&&f.cookieCompliant,WdParams:i.wdParams,SessionContext:i.sessionContext,DisableFocusOnBoot:d&&d.disableFocusOnBoot,HighContrastMode:s&&s.highContrast,HideViewerToolbar:d&&d.hideToolbar,SupportsAccessibilityLoop:l&&l.accessibilityLoop,SupportsDocReboot:l&&l.rebootDoc,SupportsCreateNewDocument:l&&l.createNewDoc,SupportsAuthToken:l&&l.authToken,HideHeader:s&&s.hideHeader,HideBreadCrumbInViewer:d&&d.hideBreadCrumb,HideTitleInViewer:d&&d.hideTitle},ApplicationUrl:o,WopiPrecheckInfo:{FileName:p.name,FileGetUrl:p.getUrl,FileSize:p.size,BundleInfo:v?{MajorVersion:v.majorVersion,Url:v.url,BundleStaleness:v.staleness}:void 0,IsNewFile:f&&f.isNewFile,IsNewFileFromHostTemplate:f&&f.isFromHostTemplate,ReadOnly:f&&f.readOnly,IrmEnabled:f&&f.irmEnabled,ViewOnly:f&&f.viewOnly,ETag:p.eTag,PreseededSessionKey:w&&w.key,PreseededWacSessionId:w&&w.id,DocUniqueId:p.uniqueId,ClientThrottlingProtection:m&&m.protection,RequestedCallThrottling:m&&m.request},ApplicationCustomSettings:{HostUIControls:s&&s.controls},Diagnostics:i.diagnostics,WopiInfo:{WopiSrc:g.source,AccessToken:g.accessToken,AccessTokenExpiry:new Date(g.expiry)},FnOnInitializeSuccess:e,FnOnInitializeFailure:n,NewFileTemplateSource:I?{FileGetUrl:I.getUrl,FileSize:I.size,ETag:I.eTag,DocUniqueId:I.uniqueId}:void 0,RebootOverrideData:i.rebootOverride}}(i,n,(function(n,r){if(!o||!o.isCancelled){e.application=n,e.appInitDiagnostics=r,i.appInitDiagnostics=r,n.RegisterAllEventsHandler((function(t){i.onMessage(t)}));var s={completion:"success"};i.raiseEvent(R.BootCompleted,s),i.state=x.Booted,t(s)}}),c);r&&r.afterInitParams&&r.afterInitParams(i,e,h),!e.isViewModeSwitchEventRaised&&n.bootParams&&n.bootParams.readOnly&&(i.raiseEvent(R.ModeSwitched,{NewMode:"view"}),e.isViewModeSwitchEventRaised=!0);var u=e.bootstrapper.InitializeWopiPending(h,i.logger,i.sessionId,void 0,i.featureManager,i.settingsManager);u&&u.Complete(h.WopiInfo),e.pendingApplication=u}))}var ii=function(){function t(t){var i=this;this.lo=!1,this.po=[],this.cancel=function(){i.lo||(i.lo=!0,i.po.map((function(t){return t()})),i.po=[])},window.setTimeout(this.cancel,t)}return Object.defineProperty(t.prototype,"isCancelled",{get:function(){return this.lo},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.lo?t():this.po.push(t)},t}();function ei(t){return new ii(t)}var ni,oi={afterInitParams:function(t,i,e){if(!i.isViewModeSwitchEventRaised){var n=Et(e.ApplicationUrl);(!n||t.ui&&t.ui.uiEmbed&&(n&&t.bootParams&&t.bootParams.readOnly||!n&&t.bootParams&&t.bootParams.irmEnabled))&&(t.raiseEvent(R.ModeSwitched,{NewMode:"view"}),i.isViewModeSwitchEventRaised=!0)}}},ri=function(){var t,i,e={bootstrapper:si};return[(t={},t[tt.appReboot]=function(){return Promise.resolve({completion:"success"})},t[tt.boot]=function(t,i,n,o,r){return ti(t,n,e,i,r,oi)},t[tt.dispose]=function(t,i,n,o,r){return function(t,i,e,n){return t!==it.dispose?Promise.reject("Wrong flow"):new Promise((function(t){i.state=x.Disposing;var o=!!i.host.requireExplicitUnload,r=function(){var e={completion:"success"};i.raiseEvent(R.Disposed,e),i.state=x.Disposed,t(e)};if(n&&n.subscribe((function(){t({completion:"cancelled"})})),e.application){var s=e.application;o&&s.registerEventHandlerInternal(Gt.Unloaded,r),s.Dispose(o),o||r()}else e.pendingApplication?e.pendingApplication.Dispose(o,r):r()}))}(t,n,e,r)},t[tt.frameTrust]=function(){return Promise.resolve({completion:"success"})},t[tt.handleBootState]=function(){return Promise.resolve({completion:"success"})},t[tt.postMessage]=function(t,i,n,o,r){return function(t,i,e,n,o){return e.application.PostCommand(t,n),Promise.resolve({completion:"success"})}(t,0,e,i)},t[tt.rename]=function(t,i,n,o,r){return function(t,i,e,n,o){return new Promise((function(r){var s=function(t,i){var e={completion:i.NewName===n.NewName?"success":"failure"};c(e)},a=function(t,i){c({completion:"failure"})},c=function(t){i.removeActionHandler(et.Kt,s),i.removeActionHandler(et.Qt,a),r(t)};i.addActionHandler(et.Kt,s),i.addActionHandler(et.Qt,a),(o||new ii(5e3)).subscribe((function(){c({completion:"cancelled"})})),e.application&&e.application.PostCommand(t,n)}))}(t,n,e,i,r)},t[tt.switchMode]=function(t,i,n,o,r){return function(t,i,e,n,o){return new Promise((function(r){var s=function(t,i){a({completion:"success"})},a=function(t){i.removeActionHandler(et.ri,s),r(t)};i.addActionHandler(et.ri,s),(o||new ii(5e3)).subscribe((function(){a({completion:"cancelled"})})),e.application&&e.application.PostCommand(t,n)}))}(t,n,e,i,r)},t[tt.wopiInfoFromUrl]=function(t,i,n,o,r){return function(t,i,e,n,o){return new Promise((function(t){var r=function(t,i){e.application&&e.application.PostCommand(it.sendWopiInfo,i),s({completion:"success"})},s=function(e){i.removeActionHandler(it.sendWopiInfo,r),t(e)};i.addActionHandler(it.sendWopiInfo,r),(o||new ii(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.raiseEvent(R.GetWopiInfoFromUrl,n)}))}(0,n,e,i,r)},t),(i={},i[tt.boot]={buildAppUrl:function(){return""},buildPostData:function(){return{}}},i)]};!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(ni||(ni={})),e.d(i,"Application",(function(){return si})),e.d(i,"Viewer",(function(){return ai})),e.d(i,"createApplication",(function(){return ci})),e.d(i,"ApplicationEvents",(function(){return Gt})),e.d(i,"DocRebootSupportMode",(function(){return ni})),e.d(i,"CommandIds",(function(){return it})),e.d(i,"EventIds",(function(){return R})),e.d(i,"createCancellationToken",(function(){return ei}));var si=new Zt((function(t,i,e,n,o){return new Kt(t,i,e,n,o)}),{forceSingleStepBoot:!1,preloader:F(Et,Yt)}),ai=new Zt((function(t,i,e,n,o){return new Qt(t,i,e,n,o)}),{forceSingleStepBoot:!0,useViewerInitializer:!0}),ci=function(t){var i={name:"Word",path:"/we/",preloader:F(Et,Yt)};return new gt(t,i,ri)}}});

